[
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "OVERALL RISK CHANGE",
        "visulization_type": "KPI",
        "placeholder_name": "overall_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'OVERALL RISK CHANGE' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Overall Risks' and entity=:entity and month_ending = :month_ending; ",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "MEASURED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "outcomes_measured_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast (cnt as decimal(10, 0) ) as 'MEASURED MEMBERS'  from sc_kpi.kpi_metrics_final where metric_id=2054 and entity=:entity and month_ending = :month_ending; ",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "PREVENTIVE RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "preventive_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Preventive risk' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Preventive Risks' and entity=:entity and month_ending = :month_ending;",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "LIFESTYLE RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "lifestyle_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Lifestyle risk' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Lifestyle Risks' and entity=:entity and month_ending = :month_ending;",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "BIOMETRIC RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "biometric_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Biometric risk' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Biometric Risks' and entity=:entity and month_ending = :month_ending;",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "REGISTRATION (% OF ELIGIBLE)",
        "visulization_type": "KPI",
        "placeholder_name": "regn_percent",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast (  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity=:entity and month_ending = :month_ending )  )*100,1) as decimal(6,1) ) || '%' as 'REGISTRATION (% OF ELIGIBLE)';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "RealAge Test Completion (% of Eligible)",
        "visulization_type": "KPI",
        "placeholder_name": "reslage_test_completion_percent",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2017 and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'REGISTRATION (% OF ELIGIBLE)';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "INCENTIVE PARTICIPATION",
        "visulization_type": "KPI",
        "placeholder_name": "incentive_participation",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2092 and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2091 and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'INCENTIVE PARTICIPATION';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "MONTHLY ACTIVE USERS",
        "visulization_type": "KPI",
        "placeholder_name": "monthly_user",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(cnt*100,1) || '%' as 'MONTHLY ACTIVE USERS' from sc_kpi.kpi_metrics_final where metric_id=105 and entity=:entity and month_ending = :month_ending",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "90-day engagement",
        "visulization_type": "KPI",
        "placeholder_name": "90day_engagement",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(cnt*100,1) || '%' as '90-day engagement' from sc_kpi.kpi_metrics_final where metric_id=103 and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Challenge participation (% of registered)",
        "visulization_type": "KPI",
        "placeholder_name": "challenge_ptpn",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast(round(((select cnt from sc_kpi.kpi_metrics_final where metric_id=2105 and entity=:entity and month_ending=:month_ending) / (select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity=:entity and month_ending=:month_ending))*100,1) as decimal(6,1) ) || '%';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Content visits per Content Visitor",
        "visulization_type": "KPI",
        "placeholder_name": "content_clicks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2028 and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2078 and entity=:entity and month_ending = :month_ending )  ),1) as 'Content visits per Content Visitor';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Lifestyle management enrollment rate",
        "visulization_type": "KPI",
        "placeholder_name": "lifestyle_mgmt_enrollment",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=3001 and dim_field = 'Enrolled' and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=3001 and dim_field = 'Targeted' and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'Lifestyle management enrollment rate';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "MEMBERS WITH 1+ CONDITION RISK",
        "visulization_type": "KPI",
        "placeholder_name": "1+condition_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2996 and entity=:entity and month_ending = :month_ending )  / ( select sum(cnt) from sc_kpi.kpi_metrics_final where metric_id=2047 and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'MEMBERS WITH 1+ CONDITION RISK';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Members with 1+ Lifestyle Risk",
        "visulization_type": "KPI",
        "placeholder_name": "1+lifestyle_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2995 and entity=:entity and month_ending = :month_ending )  / ( select sum(cnt) from sc_kpi.kpi_metrics_final where metric_id=2047 and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'Members with 1+ Lifestyle Risk';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "NET RISK CHANGE",
        "visulization_type": "KPI",
        "placeholder_name": "net_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'NET RISK CHANGE' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Overall Risks' and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Preventive risk change",
        "visulization_type": "KPI",
        "placeholder_name": "preventive_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Preventive risk change' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Preventive Risks' and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Biometric/Clinical risk change",
        "visulization_type": "KPI",
        "placeholder_name": "biometric_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Biometric risk change' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Biometric Risks' and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Lifestyle risk change",
        "visulization_type": "KPI",
        "placeholder_name": "lifestyle_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Lifestyle risk change' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Lifestyle Risks' and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "REGISTRATION (% OF ELIGIBLE)",
        "visulization_type": "KPI",
        "placeholder_name": "regn_percent",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast (  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity=:entity and month_ending = :month_ending )  )*100,1) as decimal(6,1) ) || '%' as 'REGISTRATION (% OF ELIGIBLE)';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "RealAge Test Completion (% of Eligible)",
        "visulization_type": "KPI",
        "placeholder_name": "reslage_test_completion_percent",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2017 and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'REGISTRATION (% OF ELIGIBLE)';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "INCENTIVE PARTICIPATION",
        "visulization_type": "KPI",
        "placeholder_name": "incentive_participation",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2092 and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2091 and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'INCENTIVE PARTICIPATION';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "MONTHLY ACTIVE USERS",
        "visulization_type": "KPI",
        "placeholder_name": "monthly_user",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(cnt*100,1) || '%' as 'MONTHLY ACTIVE USERS' from sc_kpi.kpi_metrics_final where metric_id=105 and entity=:entity and month_ending = :month_ending",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "90-day engagement",
        "visulization_type": "KPI",
        "placeholder_name": "90day_engagement",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(cnt*100,1) || '%' as '90-day engagement' from sc_kpi.kpi_metrics_final where metric_id=103 and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Challenge participation (% of registered)",
        "visulization_type": "KPI",
        "placeholder_name": "challenge_ptpn",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast(round(((select cnt from sc_kpi.kpi_metrics_final where metric_id=2105 and entity=:entity and month_ending=:month_ending) / (select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity=:entity and month_ending=:month_ending))*100,1) as decimal(6,1) ) || '%';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Content visits per Content Visitor",
        "visulization_type": "KPI",
        "placeholder_name": "content_clicks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2028 and entity=:entity and month_ending = :month_ending )  / ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2078 and entity=:entity and month_ending = :month_ending )  ),1) as 'Content visits per Content Visitor';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "MEMBERS WITH 1+ CONDITION RISK",
        "visulization_type": "KPI",
        "placeholder_name": "1+condition_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2996 and entity=:entity and month_ending = :month_ending )  / ( select sum(cnt) from sc_kpi.kpi_metrics_final where metric_id=2047 and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'MEMBERS WITH 1+ CONDITION RISK';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Members with 1+ Lifestyle Risk",
        "visulization_type": "KPI",
        "placeholder_name": "1+lifestyle_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select cnt from sc_kpi.kpi_metrics_final where metric_id=2995 and entity=:entity and month_ending = :month_ending )  / ( select sum(cnt) from sc_kpi.kpi_metrics_final where metric_id=2047 and entity=:entity and month_ending = :month_ending )  )*100,1) || '%' as 'Members with 1+ Lifestyle Risk';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "NET RISK CHANGE",
        "visulization_type": "KPI",
        "placeholder_name": "net_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'NET RISK CHANGE' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Overall Risks' and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Preventive risk change",
        "visulization_type": "KPI",
        "placeholder_name": "preventive_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Preventive risk change' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Preventive Risks' and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Biometric/Clinical risk change",
        "visulization_type": "KPI",
        "placeholder_name": "biometric_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Biometric risk change' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Biometric Risks' and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Lifestyle risk change",
        "visulization_type": "KPI",
        "placeholder_name": "lifestyle_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(cnt*100,1)) || '%' as 'Lifestyle risk change' from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Lifestyle Risks' and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Employer Groups",
        "visualization_name": "EMPLOYER GROUPS",
        "visulization_type": "KPI",
        "placeholder_name": "employers_grp_exec",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt  as 'EMPLOYER GROUPS' from sc_kpi.kpi_metrics_final where metric_id=3108 and entity=:entity and month_ending = :month_ending ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Employer Groups",
        "visualization_name": "EMPLOYER GROUPS - ELIGIBLE MEMBERS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "employers_grp_eligible_members",
        "style": "",
        "category": "chart",
        "data_query": "select * from (select distinct dim_field , cnt from sc_kpi.kpi_metrics_final where metric_id=3107 and entity=:entity and month_ending = :month_ending)dd order by case when dim_Field = '0 - 99' then 1 when dim_field = '100 - 999' then 2 else 3 end;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": " "
    },
    {
        "slide_title": "Employer Groups",
        "visualization_name": "Top 10 Employer Name",
        "visulization_type": "Table",
        "placeholder_name": "employers_grp_table",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT REPORTGROUPNAME, ELIGIBLE, REGISTERED, CAST (ROUND((REG_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS REG_RATE, CAST (ROUND((INCENT_PARTIC_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS INCENT_PARTIC_RATE, CAST (ROUND((CHAL_PARTIC_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS CHAL_PARTIC_RATE, CAST (ROUND((RAT_CY_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS RAT_CY_RATE, CAST (ROUND((RAT_LIFETIME_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS RAT_LIFETIME_RATE, CAST (ROUND((MAU_SITE)*100,1) AS DECIMAL(6, 1) ) || '%' AS MAU_SITE, CAST (ROUND((MAU_ALL)*100,1) AS DECIMAL(6, 1) ) || '%' AS MAU_ALL, CAST (ROUND((OVERALL_RISK)*100,1) * (-1 ) AS DECIMAL(6, 1) ) || '%' AS OVERALL_RISKS, EMAIL_SENDS FROM sc_kpi.ipr_top10employers A WHERE CUSTOMERID= :entity AND month_ending = :month_ending ORDER BY 3 DESC;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": " "
    },
    {
        "slide_title": "Eligibility Trends",
        "visualization_name": "Total eligible members",
        "visulization_type": "KPI",
        "placeholder_name": "eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity=:entity and month_ending=:month_ending;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Eligibility Trends",
        "visualization_name": "ELIGIBLE MEMBERS BY MONTH",
        "visulization_type": "Bar Chart",
        "placeholder_name": "eligible_members_by_month",
        "style": "",
        "category": "chart",
        "data_query": "select month_ending,cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity=:entity and month_ending between  to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Eligibility Trends",
        "visualization_name": "ADDITIONS AND REMOVALS BY MONTH",
        "visulization_type": "Stacked Bar Chart",
        "placeholder_name": "addition_removal_by_month",
        "style": "",
        "category": "chart",
        "data_query": "select id_1.month_ending,id_1.cnt as cnt_1,-1*(id_2.cnt) as cnt_2 from (select month_ending,cnt from sc_kpi.kpi_metrics_final where metric_id=1 and entity= :entity and month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1)id_1 inner join (select month_ending,cnt from sc_kpi.kpi_metrics_final where metric_id=2 and entity= :entity and month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1)id_2 on id_1.month_ending=id_2.month_ending order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Eligibility Trends",
        "visualization_name": "Current Quarter Vs Previous Quarter",
        "visulization_type": "KPI",
        "placeholder_name": "current_q_vs_prior_q",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((( (select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending=to_char(to_date(:month_ending,'yyyy-mm-dd'),'yyyy-mm'))  - (select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm'))) /(select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm')))*100,1) || '%' as 'CQ VS PQ';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "Average Age",
        "visulization_type": "KPI",
        "placeholder_name": "avg_age",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(cnt,1) avg_age from sc_kpi.kpi_metrics_final where metric_id=2013 and entity= :entity and month_ending = :month_ending;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "Missing Email",
        "visulization_type": "KPI",
        "placeholder_name": "missing_email",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((( select cnt from sc_kpi.kpi_metrics_final where metric_id=2015 and entity= :entity and month_ending = :month_ending) /( select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending = :month_ending))*100,1) || '%' as 'Missing Email';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "Missing Phone",
        "visulization_type": "KPI",
        "placeholder_name": "missing_phone",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((( select cnt from sc_kpi.kpi_metrics_final where metric_id=2016 and entity= :entity and month_ending = :month_ending) /( select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending = :month_ending))*100,1) || '%' as 'Missing Phone';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "Gender Breakdown",
        "visulization_type": "Pie Chart",
        "placeholder_name": "eligibe_member_by_gender",
        "style": "",
        "category": "chart",
        "data_query": "select dim_field,round((cnt/total_sum)*100,2) || '%'  as PCT from (select Dim_field,cnt,sum(cnt) over(partition by entity,month_ending order by month_ending)Total_Sum from sc_kpi.kpi_metrics_final where metric_id=2014  and entity= :entity and month_ending = :month_ending order by 1)x order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "ELIGIBLE MEMBERS BY AGE",
        "visulization_type": "Bar Chart",
        "placeholder_name": "eligibile_members_by_age",
        "style": "",
        "category": "chart",
        "data_query": "select dim_field,round((cnt/total_sum)*100,1) || '%'  as PCT from (select Dim_field,cnt,sum(cnt) over(partition by entity,month_ending order by month_ending)Total_Sum from sc_kpi.kpi_metrics_final where metric_id=2012 and entity= :entity and month_ending = :month_ending  order by 1)x order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "ELIGIBLE MEMBERS BY LOCATION",
        "visulization_type": "Map",
        "placeholder_name": "eligible_member_by_location",
        "style": "",
        "category": "map",
        "data_query": "select distinct MONTH_ENDING,REPORTGROUPNAME AS ENTITY,CITY,STATE,LATITUDE,LONGITUDE,MAP_CNT FROM SC_KPI.IPR_MAP_ELIGIBLES A WHERE STATE IN ('AL','AR','AZ','CA','CO','CT','DC','DE','FL','GA','IA','ID','IL','IN','KS','KY','LA','MA','MD','ME','MI','MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM','NV','NY','OH','OK','OR','PA','RI','SC','SD','TN','TX','UT','VA','VT','WA','WI','WV','WY') and REPORTGROUPNAME= :entity and month_ending= :month_ending;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Registration Rate",
        "visulization_type": "KPI",
        "placeholder_name": "regn_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast( round((( select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity= :entity and month_ending = :month_ending) /( select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending = :month_ending))*100,1)  as decimal(6,1) )|| '%' as 'Registration Rate (Since Launch)';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Current Calendar Year RealAge Test Completion Rate (of Registered)",
        "visulization_type": "KPI",
        "placeholder_name": "realage_regd_2",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast( round((( select cnt from sc_kpi.kpi_metrics_final where metric_id=2017 and entity= :entity and month_ending = :month_ending) /( select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity= :entity and month_ending = :month_ending))*100,1)  as decimal(6,1) ) || '%' as 'RealAge Test Completion Rate Current Cal Year (of Registered)';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Current Calendar Year RealAge Test Completion Rate (of Eligible)",
        "visulization_type": "KPI",
        "placeholder_name": "realage_eligible",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast( round((( select cnt from sc_kpi.kpi_metrics_final where metric_id=2017 and entity= :entity and month_ending = :month_ending) /( select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending = :month_ending))*100,1)  as decimal(6,1) ) || '%' as 'RealAge Test Completion Rate Current Cal Year (of Elig)';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "RealAge Test Completion Rate (of Registered)",
        "visulization_type": "KPI",
        "placeholder_name": "realage_regd",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast( round((( select cnt from sc_kpi.kpi_metrics_final where metric_id=20 and entity= :entity and month_ending = :month_ending) /( select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity= :entity and month_ending = :month_ending))  *100,1)  as decimal(6,1) ) || '%' as 'RealAge Test Completion Rate Since Launch (of Registered)';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Registered Members",
        "visulization_type": "KPI",
        "placeholder_name": "regd_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity= :entity and month_ending = :month_ending;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Distinct RealAge Test Completers",
        "visulization_type": "KPI",
        "placeholder_name": "distinct_test_completers",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt  from sc_kpi.kpi_metrics_final where metric_id=20 and entity= :entity and month_ending = :month_ending;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Distinct RealAge Test Completers(Current Year)",
        "visulization_type": "KPI",
        "placeholder_name": "distinct_test_completers_curr_year",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt  from sc_kpi.kpi_metrics_final where metric_id=2017 and entity= :entity and month_ending = :month_ending;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Registration CQ VS PQ",
        "visulization_type": "KPI",
        "placeholder_name": "current_q_vs_prior_q_regn",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((( ( (select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity= :entity and month_ending=to_char(to_date(:month_ending,'yyyy-mm-dd'),'yyyy-mm')) / (select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending=to_char(to_date(:month_ending,'yyyy-mm-dd'),'yyyy-mm'))) - ( (select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity= :entity and month_ending=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm')) / (select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm')))) /  ( (select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity= :entity and month_ending=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm')) / (select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm'))) )*100,1) ||'%' as 'Registration CQ VS PQ';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Eligible/REG/RealAge Completers by Month",
        "visulization_type": "Combo Chart",
        "placeholder_name": "eligibility_and_regn",
        "style": "",
        "category": "chart",
        "data_query": "select elig.month_ending,elig.cnt::int elig,cast( round((reg.cnt/elig.cnt)*100,1)  as decimal(6,1) ) || '%' reg_pct, cast( round((tc.cnt/reg.cnt)*100,1) as decimal(6,1) ) || '%' tc_pct from (select distinct month_ending,entity,cnt from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3 )elig left join ( select distinct month_ending,entity,cnt from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id=7 ) reg on (elig.month_ending = reg.month_ending and elig.entity = reg.entity) left join ( select distinct month_ending,entity,cnt from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id=17 ) tc on (elig.month_ending = tc.month_ending and elig.entity = tc.entity) order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Registration and RealAge Completion by Group",
        "visualization_name": "RELATIONSHIP",
        "visulization_type": "Combo Chart",
        "placeholder_name": "relationship",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.entity,elig.dim_field,elig_cnt,round((reg_cnt/elig_cnt)*100,2) ||'%' as reg_pct,round((rat_cnt/elig_cnt)*100,2) ||'%' rat_pct, (case when elig.dim_field = 'Employee' then 1 when elig.dim_field = 'Spouse' then 2 else 3 end) sort from (select distinct entity,dim_field,month_ending,cnt elig_cnt from sc_kpi.kpi_metrics_final where metric_id=2050 and entity=:entity and month_ending=:month_ending) elig left join (select distinct entity,dim_field,month_ending,cnt reg_cnt from sc_kpi.kpi_metrics_final where metric_id=2024 and entity=:entity and month_ending=:month_ending) reg on (elig.dim_field = reg.dim_field and elig.month_ending = reg.month_ending and elig.entity = reg.entity) left join (select distinct entity,dim_field,month_ending,cnt rat_cnt from sc_kpi.kpi_metrics_final where metric_id=2018 and entity=:entity and month_ending=:month_ending) rat on (elig.dim_field = rat.dim_field and elig.month_ending = rat.month_ending and elig.entity = rat.entity) order by 6;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "col_drop:entity, sort"
    },
    {
        "slide_title": "Registration and RealAge Completion by Group",
        "visualization_name": "GENDER",
        "visulization_type": "Combo Chart",
        "placeholder_name": "gender",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.entity,elig.dim_field,elig_cnt,round((reg_cnt/elig_cnt)*100,2) ||'%' as reg_pct,round((rat_cnt/elig_cnt)*100,2) ||'%' rat_pct, (case when elig.dim_field = 'Male' then 1 when elig.dim_field = 'Female' then 2 else 3 end) sort from (select distinct entity,dim_field,month_ending,cnt elig_cnt from sc_kpi.kpi_metrics_final where metric_id=2014 and entity=:entity and month_ending=:month_ending) elig left join (select distinct entity,dim_field,month_ending,cnt reg_cnt from sc_kpi.kpi_metrics_final where metric_id=2025 and entity=:entity and month_ending=:month_ending) reg on (elig.dim_field = reg.dim_field and elig.month_ending = reg.month_ending and elig.entity = reg.entity) left join (select distinct entity,dim_field,month_ending,cnt rat_cnt from sc_kpi.kpi_metrics_final where metric_id=2019 and entity=:entity and month_ending=:month_ending) rat on (elig.dim_field = rat.dim_field and elig.month_ending = rat.month_ending and elig.entity = rat.entity) order by 2",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "col_drop:entity, sort"
    },
    {
        "slide_title": "Registration and RealAge Completion by Group",
        "visualization_name": "AGE GROUPS",
        "visulization_type": "Combo Chart",
        "placeholder_name": "age_groups",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.entity,elig.dim_field,elig_cnt,round((reg_cnt/elig_cnt)*100,2) ||'%' as reg_pct,round((rat_cnt/elig_cnt)*100,2) ||'%' rat_pct from (select distinct entity,dim_field,month_ending,cnt elig_cnt from sc_kpi.kpi_metrics_final where metric_id=2012 and entity=:entity and month_ending=:month_ending) elig left join (select distinct entity,dim_field,month_ending,cnt reg_cnt from sc_kpi.kpi_metrics_final where metric_id=2026 and entity=:entity and month_ending=:month_ending) reg on (elig.dim_field = reg.dim_field and elig.month_ending = reg.month_ending and elig.entity = reg.entity) left join (select distinct entity,dim_field,month_ending,cnt rat_cnt from sc_kpi.kpi_metrics_final where metric_id=2020 and entity=:entity and month_ending=:month_ending) rat on (elig.dim_field = rat.dim_field and elig.month_ending = rat.month_ending and elig.entity = rat.entity) order by 2; ",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "col_drop:entity"
    },
    {
        "slide_title": "RealAge Results",
        "visualization_name": "AVERAGE REALAGE DELTA",
        "visulization_type": "KPI",
        "placeholder_name": "avg_realage_delta",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select distinct  round(cnt,1) as 'Average RealAge Delta' from sc_kpi.kpi_metrics_final where metric_id=2022 and entity=:entity and month_ending=:month_ending",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": " "
    },
    {
        "slide_title": "RealAge Results",
        "visualization_name": "MEMBERS WITH REALAGE DELTA>1.0",
        "visulization_type": "KPI",
        "placeholder_name": "members_with_realage_delta",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select distinct  round((sum(case when dim_field IN ('GT 5', '1.1 to 2.9', '3 to 5') then cnt else null end)/sum(cnt))*100,1)||'%' as 'RealAge Delta GT1' from sc_kpi.kpi_metrics_final where metric_id=2021 and entity=:entity and month_ending=:month_ending;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "RealAge Results",
        "visualization_name": "DISTINCT REALAGE TEST COMPLETERS",
        "visulization_type": "KPI",
        "placeholder_name": "distinct_realage_test_completers",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=20 and entity= :entity and month_ending = :month_ending;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Risk Analysis Summary1",
        "visualization_name": "OVERALL RISK SEGMENTATION",
        "visulization_type": "Table",
        "placeholder_name": "overall_risk_segmentation",
        "style": "",
        "category": "table",
        "data_query": "select distinct dim_field, cast ( round((SUM(case when entity= 'Enterprise Book of Business' and month_ending=:month_ending then CNT end) over(partition by dim_field) / SUM(case when entity= 'Enterprise Book of Business' and month_ending=:month_ending then CNT end) over())*100,1) as decimal(6, 1) ) || '%' as 'Book of Business', cast ( round((SUM(case when entity=:entity and month_ending=:month_ending then CNT end) over(partition by dim_field) / SUM(case when entity=:entity and month_ending=:month_ending then CNT end) over())*100,1) as decimal(6, 1) ) || '%' as 'Client' from sc_kpi.kpi_metrics_final where metric_id=2047 and month_ending=:month_ending order by 1;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Analysis Summary1",
        "visualization_name": "LIFESTYLE RISK SEGMENTATION",
        "visulization_type": "Table",
        "placeholder_name": "lifestyle_risk_table",
        "style": "",
        "category": "table",
        "data_query": "select distinct * from ( select distinct dim_field , cast (round( (SUM(case when entity= 'Enterprise Book of Business' and month_ending=:month_ending and metric_id = 2048 then CNT end) over(partition by dim_field) /SUM(case when entity= 'Enterprise Book of Business' and month_ending=:month_ending and metric_id = 20 then CNT end) over() )*100,1) as decimal(6, 1) ) || '%' as 'Book of Business', cast ( round( (SUM(case when entity=:entity and month_ending=:month_ending and metric_id = 2048 then CNT end) over(partition by dim_field) /SUM(case when entity=:entity and month_ending=:month_ending and metric_id = 20 then CNT end) over() )*100,1) as decimal(6, 1) ) || '%' as 'Client' from sc_kpi.kpi_metrics_final where metric_id in (2048,20) and month_ending=:month_ending )xx where nullif(dim_field,'') is not null order by 1;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Analysis Summary1",
        "visualization_name": "PRECONDITION RISK SEGMENTATION",
        "visulization_type": "Table",
        "placeholder_name": "precondition_risk",
        "style": "",
        "category": "table",
        "data_query": "select distinct * from ( select distinct dim_field , cast( round( (SUM(case when entity= 'Enterprise Book of Business' and month_ending=:month_ending and metric_id = 2049 then CNT end) over(partition by dim_field) /SUM(case when entity= 'Enterprise Book of Business' and month_ending=:month_ending and metric_id = 20 then CNT end) over() )*100,1) as decimal(6, 1) ) || '%' as 'Book of Business', cast ( round( (SUM(case when entity=:entity and month_ending=:month_ending and metric_id = 2049 then CNT end) over(partition by dim_field) /SUM(case when entity=:entity and month_ending=:month_ending and metric_id = 20 then CNT end) over() )*100,1) as decimal(6, 1) ) || '%' as 'Client' from sc_kpi.kpi_metrics_final where metric_id in (2049,20) and month_ending=:month_ending )xx where nullif(dim_field,'') is not null order by 1;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Analysis Summary1",
        "visualization_name": "CONDITION RISK SEGMENTATION",
        "visulization_type": "Table",
        "placeholder_name": "condition_risk",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT dim_field, Book_of_Business AS 'Book of Business', client , upper(dim_field) upper_dim_field FROM ( SELECT DISTINCT dim_field , CAST ( ROUND( (SUM( CASE WHEN entity= 'Enterprise Book of Business' AND month_ending=:month_ending AND metric_id = 2051 THEN CNT END) OVER( PARTITION BY dim_field) /SUM( CASE WHEN entity= 'Enterprise Book of Business' AND month_ending=:month_ending AND metric_id = 20 THEN CNT END) OVER() )*100,1) AS DECIMAL(6,1 ) ) || '%' AS Book_of_Business, CAST ( ROUND( (SUM( CASE WHEN entity=:entity AND month_ending=:month_ending AND metric_id = 2051 THEN CNT END) OVER( PARTITION BY dim_field) /SUM( CASE WHEN entity=:entity AND month_ending=:month_ending AND metric_id = 20 THEN CNT END) OVER() )*100,1) AS DECIMAL(6,1 ) ) || '%' AS 'Client' FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (2051,20) AND month_ending=:month_ending )xx WHERE nullif(dim_field,'') IS NOT NULL ORDER BY upper_dim_field ;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "col_drop:upper_dim_field"
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "eligible_members_biometric",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending = :month_ending",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "SCREENING PARTICIPANTS",
        "visulization_type": "KPI",
        "placeholder_name": "screening_participants",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=2071 and entity= :entity and month_ending = :month_ending",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "PARTICIPATION RATE",
        "visulization_type": "KPI",
        "placeholder_name": "participation_rate_biometric",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum((case when metric_id = 2071 then cnt else null end))/ sum((case when metric_id = 3 then cnt else null end)))*100,1)||'%' from sc_kpi.kpi_metrics_final where metric_id in (3,2071) and entity= :entity and month_ending = :month_ending",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "PARTICIPANTS BY GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "ptpn_by_gender_bio",
        "style": "",
        "category": "chart",
        "data_query": "select dim_field,round((cnt/sum(cnt) over(partition by entity))*100,1)||'%' gender_pct from sc_kpi.kpi_metrics_final where metric_id in (2072) and month_ending=:month_ending and entity=:entity order by 1;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "CUMULATIVE BIOMETRIC COMPLETIONS BY MONTH",
        "visulization_type": "Line Chart",
        "placeholder_name": "cumulative_biometric_completion_by_month",
        "style": "",
        "category": "chart",
        "data_query": "select month_ending,dim_field,cnt from ( SELECT DISTINCT to_char(to_date(month_ending,'yyyy-mm-dd'),'Month') month_ending, to_char(to_date(month_ending,'yyyy-mm-dd'),'yyyy-mm') month_ending2, CASE WHEN SUBSTRING(:month_ending,1,4)=SUBSTRING(month_ending,1,4) THEN 'CY' WHEN SUBSTRING(month_ending,1,4) < SUBSTRING(:month_ending,1,4) THEN 'PY' END dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (2073) AND entity=:entity AND CASE WHEN TO_CHAR(SYSDATE::Date,'mm') = 01 THEN month_ending BETWEEN TO_CHAR(TRUNC(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14 ),'yy'),'yyyy-mm') AND :month_ending WHEN TO_CHAR(SYSDATE::Date,'mm') <> 01 THEN month_ending BETWEEN TO_CHAR(TRUNC(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14 ),'yy'),'yyyy-mm') AND :month_ending END ) dd ORDER BY month_ending2;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "pivot:cum_biometric_by_month"
    },
    {
        "slide_title": "Biometric/Clinical Screening Results",
        "visualization_name": "MEMBERS WITH 1+ RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "members_with_1+_risks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(member_pct)||'%' as 'Member with 1+ Risks' from ( select dim_field,round((cnt/sum(cnt)over())*100,5) member_pct from sc_kpi.kpi_metrics_final where metric_id in (2077) and entity=:entity and month_ending = :month_ending order by 1) x where dim_field IN ('1','2','3', '4+');",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Biometric/Clinical Screening Results",
        "visualization_name": "MEMBERS WITH 3+ RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "members_3+_risks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(member_pct)||'%' as 'Member with 3+ Risks' from ( select dim_field,round((cnt/sum(cnt)over())*100,5) member_pct from sc_kpi.kpi_metrics_final where metric_id in (2077) and entity=:entity and month_ending = :month_ending order by 1) x where dim_field IN ('3', '4+');",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Biometric/Clinical Screening Results",
        "visualization_name": "RISKS PER MEMBER",
        "visulization_type": "Bar Chart",
        "placeholder_name": "risks_per_members",
        "style": "",
        "category": "chart",
        "data_query": "select dim_field,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%' as 'Member PCT' from sc_kpi.kpi_metrics_final where metric_id in (2077) and entity=:entity and month_ending = :month_ending order by 1",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Biometric/Clinical Screening Results",
        "visualization_name": "BIOMETRIC RISK FACTORS",
        "visulization_type": "Stacked Bar Chart",
        "placeholder_name": "biometric_risk_factors",
        "style": "",
        "category": "chart",
        "data_query": "SELECT * FROM ( SELECT DISTINCT split_part(dim_field,'||',1)test_name , split_part(dim_field,'||',2) risk_color , ROUND((cnt/SUM(cnt) OVER( PARTITION BY :entity, split_part(dim_field,'||',1)))*100,1) ||'%' member_risk FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (2074) AND entity=:entity AND month_ending = :month_ending ) x WHERE member_risk IS NOT NULL and test_name NOT IN ('Glucose (Non Fasting)') ORDER BY ( CASE WHEN test_name IN ('A1C') THEN 1 WHEN test_name IN ('Blood Pressure - Diastolic (Lower)') THEN 2 WHEN test_name IN ('Blood Pressure - Systolic (Upper)') THEN 3 WHEN test_name IN ('BMI (Body Mass Index)') THEN 4 WHEN test_name IN ('Cholesterol - HDL (Good)') THEN 5 WHEN test_name IN ('Cholesterol - LDL (Bad)') THEN 6 WHEN test_name IN ('Cholesterol - Total') THEN 7 WHEN test_name IN ('Glucose (Fasting)') THEN 8 WHEN test_name IN ('Glucose (Non Fasting)') THEN 9 WHEN test_name IN ('Total Cholesterol/HDL Ratio') THEN 10 WHEN test_name IN ('Triglycerides') THEN 11 WHEN test_name IN ('VLDL Cholesterol') THEN 12 ELSE 13 END), ( CASE WHEN risk_color = 'G' THEN 1 WHEN risk_color = 'Y' THEN 2 WHEN risk_color = 'R' THEN 3 ELSE 4 END );",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "pivot:get_bio_risk_pivot_df"
    },
    {
        "slide_title": "RealAge Results",
        "visualization_name": "REALAGE DELTA DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "realage_delta_dist",
        "style": "",
        "category": "chart",
        "data_query": "select distinct  dim_field,round((cnt/SUM(cnt) over ())*100,1)||'%' as 'RealAge Delta', case when dim_field IN ('LT -5') then 1 when dim_field IN ('-4.9 to -3') then 2 when dim_field IN ('-2.9 to -1') then 3 when dim_field IN ('-.9 to 1') then 4 when dim_field IN ('1.1 to 2.9') then 5 when dim_field IN ('3 to 5') then 6 when dim_field IN ('GT 5') then 7 end sort_order from sc_kpi.kpi_metrics_final where metric_id=2021 and entity=:entity and month_ending=:month_ending order by 3;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "col_drop:sort_order"
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc monthly users siteonly",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_monthly_users_siteonly",
        "data_query": "select round(cnt*100,1)::NUMERIC(5,1) || '%' as 'AVERAGE MONTHLY ACTIVE USER' from sc_kpi.kpi_metrics_final where metric_id=104 and entity=:entity and month_ending=:month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc monthly users siteemail",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_monthly_users_siteemail",
        "data_query": "select round(cnt*100,1)::NUMERIC(5,1) || '%' as 'AVERAGE MONTHLY ACTIVE USER' from sc_kpi.kpi_metrics_final where metric_id=105 and entity=:entity and month_ending=:month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc curr quat engagement",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_curr_quat_engagement",
        "data_query": "select round(cnt*100,1)::NUMERIC(5,1) || '%' as 'CURRENT QUARTER ENGAGEMENT' from sc_kpi.kpi_metrics_final where metric_id=103 and entity=:entity and month_ending=:month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc active users post regn",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_active_users_post_regn",
        "data_query": "select dim_field as 'Activity Groups', round(cnt*100,1) || '%' as '% Active Users - Rolling' from sc_kpi.kpi_metrics_final where metric_id=35 and entity=:entity and month_ending = :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc monthly active users",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_monthly_active_users",
        "data_query": "select month_ending,round(cnt*100,1) || '%' as 'Mau Calendar Month' from sc_kpi.kpi_metrics_final where metric_id=101 and entity=:entity and month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc device usage quarterly",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_device_usage_quarterly",
        "data_query": "select dim_field,(cnt/sum(cnt)over(partition by :entity)) as 'DEVICE TYPE' from sc_kpi.kpi_metrics_final where metric_id=29 and entity=:entity and month_ending=:month_ending order by case when dim_Field = 'Web' then 1 when dim_Field = 'iOS' then 2 when dim_Field = 'Android' then 3 else 4 end;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc device usage",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_device_usage",
        "data_query": "select dim_field,(cnt/sum(cnt)over(partition by :entity)) as 'DEVICE TYPE' from sc_kpi.kpi_metrics_final where metric_id=26 and entity=:entity and month_ending=:month_ending order by case when dim_Field = 'Web' then 1 when dim_Field = 'iOS' then 2 when dim_Field = 'Android' then 3 else 4 end;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Feature Utilization",
        "visualization_name": "ALL TIME DiGITAL ENGAGEMENT TABLE",
        "visulization_type": "Table",
        "placeholder_name": "digital_engagement_table",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT dim_field, Total_Visitor, Unique_Visitor, Page_View_per_Visit, Average_Time_Spent_Minutes FROM ( SELECT dim_field, Total_Visitor, Unique_Visitor, Page_View_per_Visit, Average_Time_Spent_Minutes, row_number() over(ORDER BY Unique_Visitor DESC) row_num FROM ( SELECT dim_field, SUM( CASE WHEN metric_id = 2081 THEN cnt ELSE NULL END) AS Total_Visitor , SUM( CASE WHEN metric_id = 3007 THEN cnt ELSE NULL END) AS Unique_Visitor , CAST ( ROUND(SUM( CASE WHEN metric_id = 2083 THEN cnt ELSE NULL END)/SUM( CASE WHEN metric_id = 2081 THEN cnt ELSE NULL END),1) AS DECIMAL(6,1 ) ) AS Page_View_per_Visit , CAST ( ROUND((SUM( CASE WHEN metric_id = 2082 THEN cnt ELSE NULL END)/SUM( CASE WHEN metric_id = 2081 THEN cnt ELSE NULL END))/60,1) AS DECIMAL(6,1 ) ) AS Average_Time_Spent_Minutes FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (3007,2081,2082,2083) AND entity=:entity AND month_ending = :month_ending GROUP BY 1 ORDER BY 2 DESC ) jj WHERE Unique_Visitor IS NOT NULL ) jj1 WHERE row_num <= 12 ORDER BY 3 DESC, dim_field ;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Feature Utilization",
        "visualization_name": "ALL TIME UNIQUE VISITORS BY PLATFORM FEATURE",
        "visulization_type": "Bar Chart",
        "placeholder_name": "unique_visitors",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT dim_field, cnt FROM ( SELECT DISTINCT dim_field, cnt, row_number() over(ORDER BY cnt DESC) row_num FROM ( SELECT CASE WHEN dim_field = 'Covid-19 Care Center' THEN 'Cov19 CC' WHEN dim_field = 'Health Profile' THEN 'HlthProf' WHEN dim_field = 'Incentive' THEN 'Incnt' WHEN dim_field = 'Inspirations' THEN 'Insp' WHEN dim_field = 'Medication Prices' THEN 'Med Pric' WHEN dim_field = 'Medications' THEN 'Medcatns' WHEN dim_field = 'Realage Tips' THEN 'RA Tips' WHEN dim_field = 'Relax 360' THEN 'Rlx-360' ELSE dim_field END dim_field , cnt AS 'Cnt' FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (3007) AND entity=:entity AND month_ending = :month_ending ORDER BY 2 DESC )jj WHERE cnt IS NOT NULL )jj2 WHERE row_num<= 12 ORDER BY 2 DESC, 1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Feature Utilization",
        "visualization_name": "CURRENT DiGITAL ENGAGEMENT TABLE",
        "visulization_type": "Table",
        "placeholder_name": "curr_qtr_digital_engagement_table",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT dim_field, Total_Visitor, Unique_Visitor, Page_View_per_Visit, Average_Time_Spent_Minutes FROM ( SELECT dim_field, Total_Visitor, Unique_Visitor, Page_View_per_Visit, Average_Time_Spent_Minutes, row_number() OVER(ORDER BY Unique_Visitor DESC) row_num FROM ( SELECT dim_field, SUM( CASE WHEN metric_id = 2210 THEN cnt ELSE NULL END) AS Total_Visitor , SUM( CASE WHEN metric_id = 2207 THEN cnt ELSE NULL END) AS Unique_Visitor , CAST ( ROUND(SUM( CASE WHEN metric_id = 2209 THEN cnt ELSE NULL END)/SUM( CASE WHEN metric_id = 2210 THEN cnt ELSE NULL END),1) AS DECIMAL(6,1 ) ) AS Page_View_per_Visit , CAST ( ROUND((SUM( CASE WHEN metric_id = 2208 THEN cnt ELSE NULL END)/SUM( CASE WHEN metric_id = 2210 THEN cnt ELSE NULL END))/60,1) AS DECIMAL(6,1 ) ) AS Average_Time_Spent_Minutes FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (2207,2208 , 2209 , 2210) AND entity=:entity AND month_ending = :month_ending AND UPPER(dim_field) <> 'FAD' GROUP BY 1 ORDER BY 2 DESC ) jj WHERE Unique_Visitor IS NOT NULL ) jj1 WHERE row_num <= 12 ORDER BY 3 DESC ,1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": ""
    },
    {
        "slide_title": "Feature Utilization",
        "visualization_name": "CURRENT UNIQUE VISITORS BY PLATFORM FEATURE",
        "visulization_type": "Bar Chart",
        "placeholder_name": "current_qtr_unique_visitors",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT dim_Field, cnt FROM ( SELECT DISTINCT dim_field, cnt, row_number() over(ORDER BY cnt DESC)row_num FROM ( SELECT CASE WHEN dim_field = 'Covid-19 Care Center' THEN 'Cov19 CC' WHEN dim_field = 'Health Profile' THEN 'HlthProf' WHEN dim_field = 'Incentive' THEN 'Incnt' WHEN dim_field = 'Inspirations' THEN 'Insp' WHEN dim_field = 'Medication Prices' THEN 'Med Pric' WHEN dim_field = 'Medications' THEN 'Medcatns' WHEN dim_field = 'Realage Tips' THEN 'RA Tips' WHEN dim_field = 'Relax 360' THEN 'Rlx-360' ELSE dim_field END dim_field , cnt AS 'Cnt' FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (2207) AND entity=:entity AND month_ending = :month_ending AND UPPER(dim_field) <> 'FAD' ORDER BY 1 )jj WHERE cnt IS NOT NULL ) jj1 WHERE row_num <= 12 ORDER BY 2 DESC,1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Content Consumption1",
        "visualization_name": "TOTAL CONTENT VISITS",
        "visulization_type": "KPI",
        "placeholder_name": "total_content_clicks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt as 'Total Content Clicks' from sc_kpi.kpi_metrics_final where metric_id=2028  and entity=:entity and month_ending = :month_ending order by 1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Content Consumption1",
        "visualization_name": "CONTENT VISITS PER CONTENT VISITORS",
        "visulization_type": "KPI",
        "placeholder_name": "content_clicks_per_user",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum((case when metric_id = 2028 then cnt else null end))/ sum((case when metric_id = 2078 then cnt else null end)),1) from sc_kpi.kpi_metrics_final where metric_id in (2028,2078) and entity= :entity and month_ending = :month_ending",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Content Consumption1",
        "visualization_name": "CONTENT DETAILS TABLE",
        "visulization_type": "Table",
        "placeholder_name": "content_details_table",
        "style": "",
        "category": "table",
        "data_query": "SELECT dim_field, cnt AS 'Content Visits', cast (ROUND((cnt/SUM(cnt) over(partition BY :entity))*100,1) as decimal(6,1) ) ||'%' AS 'Content Visits % of Total' FROM sc_kpi.kpi_metrics_final WHERE metric_id=2030 AND entity=:entity AND month_ending = :month_ending AND dim_field IN ( SELECT DISTINCT dim_field FROM ( SELECT dim_field, cnt, row_number() over(ORDER BY cnt DESC) row_number FROM sc_kpi.kpi_metrics_final WHERE metric_id=2030 AND entity=:entity AND month_ending = :month_ending) xx WHERE row_number <= 15) ORDER BY 2 DESC;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "GREEN DAYS EARNED",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "KPI",
        "placeholder_name": "sc_green_days_earned",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=2031 and entity=:entity and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green days learned current quarter",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "KPI",
        "placeholder_name": "sc_green_days_learned_current_quarter",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=2500 and entity=:entity and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green day QoQ change",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_green_day_QoQ_change",
        "data_query": "select case when (cnt_prev_quarter = 0 or (cnt_prev_quarter = 0 and cnt_current_quarter = 0 ) or (to_number(left(:month_ending,4))-to_number(left(min_month,4)))*12+to_number(right(:month_ending,2))-to_number(right(min_month,2))<5) then 'N/A' when cnt_prev_quarter != 0 then cast ( ( ( ( cnt_current_quarter - cnt_prev_quarter) / cnt_prev_quarter) * 100 )::CHAR(5) as decimal(6,1) ) || '%' end QOQ_change from ( ( select entity, nvl(cnt, 0) cnt_current_quarter from sc_kpi.kpi_metrics_final where metric_id=2500 and entity=:entity and month_ending = :month_ending ) A join ( select entity, nvl(cnt, 0) cnt_prev_quarter from sc_kpi.kpi_metrics_final where metric_id=2500 and entity=:entity and month_ending = (to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm') ) ) B on a.entity = b.entity join ( select entity, min(case when cnt > 0 then month_ending end) min_month from sc_kpi.kpi_metrics_final where metric_id=7 and entity=:entity group by 1 ) c on a.entity = c.entity ) x;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green day YoY change",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_green_day_YoY_change",
        "data_query": "select case when (cnt_prev_year = 0 or (cnt_prev_year = 0 and cnt_current_year = 0 ) or (to_number(left(:month_ending,4))-to_number(left(min_month,4)))*12+to_number(right(:month_ending,2))-to_number(right(min_month,2))<14) then 'N/A' when cnt_prev_year != 0 then cast ( ( ( ( cnt_current_year - cnt_prev_year) / cnt_prev_year) * 100 )::CHAR(5) as decimal(6,1) ) || '%' end YOY_change from ( ( select entity, nvl(cnt, 0) cnt_current_year from sc_kpi.kpi_metrics_final where metric_id=2500 and entity=:entity and month_ending = :month_ending ) A join ( select entity, nvl(cnt, 0) cnt_prev_year from sc_kpi.kpi_metrics_final where metric_id=2500 and entity=:entity and month_ending = (to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-12),'yyyy-mm') ) ) B on a.entity = b.entity join ( select entity, min(case when cnt > 0 then month_ending end) min_month from sc_kpi.kpi_metrics_final where metric_id=7 and entity=:entity group by 1 ) c on a.entity = c.entity ) x;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc member with 1 plus green days",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_member_with_1_plus_green_days",
        "data_query": "select case when (reg_members = 0 or (reg_members = 0 and members_with_1_greendays = 0 ) ) then 'N/A' when reg_members != 0 then cast (( ( members_with_1_greendays / reg_members) * 100 )::CHAR(5) as decimal(6,1) ) || '%' end members_with_1_greendays_percent from ( ( select entity, nvl(cnt, 0) members_with_1_greendays from sc_kpi.kpi_metrics_final where metric_id=2032 and entity=:entity and month_ending = :month_ending ) A join ( select entity, nvl(cnt, 0) reg_members from sc_kpi.kpi_metrics_final where metric_id=7 and entity=:entity and month_ending = :month_ending ) B on a.entity = b.entity ) x;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green days earned chart",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "CHART",
        "placeholder_name": "sc_green_days_earned_chart",
        "data_query": "select distinct cal.month_ending,GD.CNT GD,round(GD.CNT / GDP.CNT,0)as GD_per_user from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where metric_id=3 and entity=:entity and month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1) cal left join (select month_ending,entity,cnt from sc_kpi.kpi_metrics_final where metric_id=2033)GD on (cal.month_ending = GD.month_ending and cal.entity = GD.entity) left join (select month_ending,entity,cnt from sc_kpi.kpi_metrics_final where metric_id=2038)GDP on (cal.month_ending = GDP.month_ending and cal.entity = GDP.entity) order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green days automatic vs manual tracking by members",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "CHART",
        "placeholder_name": "sc_green_days_automatic_vs_manual_tracking_by_members",
        "data_query": "select dim_field,round((cnt/sum(cnt) over(partition by entity))*100,1)||'%' greenday_tracker_pct from sc_kpi.kpi_metrics_final where metric_id in (2504) and month_ending=:month_ending and entity=:entity order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green day auto tracking channel distribution",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "CHART",
        "placeholder_name": "sc_green_day_auto_tracking_channel_distribution",
        "data_query": "select dim_field, cast ((cnt/sum_cnt) as decimal(6,3) ) || '%' from ( select entity, month_ending, dim_field ,cnt from sc_kpi.kpi_metrics_final where metric_id in (2505) and month_ending=:month_ending and entity=:entity ) A join ( select entity, month_ending, sum(cnt) sum_cnt from sc_kpi.kpi_metrics_final where metric_id in (2505) and month_ending=:month_ending and entity=:entity group by 1,2 )B on A.entity = B.entity and a.month_ending = B.month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "INCENTIVE ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "incentive_eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=2091 and entity=:entity and month_ending = :month_ending; ",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "UNIQUE INCENTIVE EARNERS",
        "visulization_type": "KPI",
        "placeholder_name": "unique_incentive_earners",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=2092 and entity=:entity and month_ending = :month_ending; ",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "INCENTIVE PARTICIPATION RATE",
        "visulization_type": "KPI",
        "placeholder_name": "incentive_ptpn_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select distinct round((incentearn.cnt/incentelig.cnt)*100,1) || '%' incent_participation_rate from (select month_ending,dim_field,entity,cnt from sc_kpi.kpi_metrics_final where metric_id=2091 and entity=:entity and month_ending = :month_ending)incentelig left join (select month_ending,dim_field,entity,cnt from sc_kpi.kpi_metrics_final where metric_id=2092 and entity=:entity and month_ending = :month_ending) incentearn on (incentelig.month_ending = incentearn.month_ending and incentelig.entity = incentearn.entity)",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "INCENTIVE EARNERS PER MONTH",
        "visulization_type": "Bar Chart",
        "placeholder_name": "incentive_earners_per_month",
        "style": "",
        "category": "chart",
        "data_query": "select month_ending,cnt from sc_kpi.kpi_metrics_final where metric_id=2069 and entity=:entity and month_ending between to_char(trunc(to_date(:month_ending,'yyyy-mm-dd'),'yyyy'),'yyyy-mm') and :month_ending order by 1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "TOP 5 INCENTIVE GROUPS EARNERS (TOP 3 ACTIVITES IN EACH GROUPS)",
        "visulization_type": "Table",
        "placeholder_name": "top_5_incentive_groups",
        "style": "",
        "category": "table",
        "data_query": "select split_part(dim_field,'||',1)incentive_groups,split_part(dim_field,'||',2)incentive_desc,cnt from sc_kpi.kpi_metrics_final where metric_id=2070 and entity=:entity and month_ending = :month_ending order by 1,3 desc;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "TARGETED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "targeted_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=3001 and entity=:entity and lower(dim_field) IN ('targeted') and month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=3001 and entity=:entity and lower(dim_field) IN ('enrolled') and month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when lower(dim_field) IN ('enrolled') then cnt else null end)/sum(case when lower(dim_field) IN ('targeted') then cnt else null end))*100,1) || '%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id=3001 and entity=:entity and  month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "ENCOUTERS PER ENROLLED MEMBER",
        "visulization_type": "KPI",
        "placeholder_name": "encounters_per_enrolled_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(cnt,1) as encounter_per_enrolled_member from sc_kpi.kpi_metrics_final where metric_id=3002 and entity=:entity and month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "ENROLLEES PER MONTH",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrollees_per_month",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,lm.encounter_per_enrolled_member from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3 )elig left join (select month_ending,entity,cnt as encounter_per_enrolled_member from sc_kpi.kpi_metrics_final where metric_id=3003 and entity=:entity) lm on (elig.month_ending = lm.month_ending and elig.entity = lm.entity) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "PARTICIPATION FUNNEL",
        "visulization_type": "Funnel",
        "placeholder_name": "ptpn_funnel_high_touch",
        "style": "",
        "category": "funnel",
        "data_query": "select dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=3001 and entity=:entity and month_ending = :month_ending order by case when dim_field IN ('Targeted') then 1 when dim_field IN ('Callable') then 2 when dim_field IN ('Attempted') then 3 when dim_field IN ('Enrolled') then 4 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "funnel_1"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "sc enrolled members by age chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_enrolled_members_by_age_chart",
        "data_query": "select split_part(dim_field,'||',2), cnt as enrolled_member_by_age from sc_kpi.kpi_metrics_final where metric_id=3023 and entity=:entity and month_ending = :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "sc enrolled members by relationship chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_enrolled_members_by_relationship_chart",
        "data_query": "select dim_field, enrolled_member_by_relationship from ( Select split_part(dim_field,'||',2) dim_field , cnt as enrolled_member_by_relationship from sc_kpi.kpi_metrics_final where metric_id=3021 and entity=:entity and month_ending = :month_ending ) D order by case when dim_field = 'Employee' then 1 when dim_field = 'Spouse' then 2 when dim_field = 'Other' then 3 end;",
        "category": "chart",
        "style": "",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "sc enrolled members by gender chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Pie Chart",
        "placeholder_name": "sc_enrolled_members_by_gender_chart",
        "data_query": "Select split_part(dim_field,'||',2), round(cnt/sum(cnt) over (partition by entity),2) as enrolled_member_by_gender from sc_kpi.kpi_metrics_final where metric_id=3022 and cnt is not null and entity=:entity and month_ending = :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc total coaching interactions",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_total_coaching_interactions",
        "data_query": "Select cast( round(cnt, 1) as decimal(8,0)) as total_coaching_interations from sc_kpi.kpi_metrics_final where metric_id=3041 and entity= :entity and month_ending = :month_ending  order by 1;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc coaching calls",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_coaching_calls",
        "data_query": "Select cast( round(cnt, 1) as decimal(8,0))  as total_coaching_calls from sc_kpi.kpi_metrics_final where metric_id=3042 and entity= :entity and month_ending = :month_ending  order by 1;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc chat messaging interactions",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_chat_messaging_interactions",
        "data_query": "select cast( round(cnt, 1) as decimal(8,0)) as chat_messaging_interactions from sc_kpi.kpi_metrics_final where metric_id=3043 and entity= :entity  and month_ending = :month_ending order by 1;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc coaching calls per enrolled member",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_coaching_calls_per_enrolled_member",
        "data_query": "select round((select cast( round(cnt, 1) as float) from sc_kpi.kpi_metrics_final where metric_id=3042 and entity= :entity and month_ending=:month_ending)/(select cnt from sc_kpi.kpi_metrics_final where metric_id=3001 and dim_field='Enrolled' and entity= :entity and month_ending = :month_ending),1) as coaching_calls_per_enrolled_member;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc interactions by month and modality chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_interactions_by_month_and_modality_chart",
        "data_query": "select a.month_ending, sum(a.cnt) as monthly_coaching_calls, sum(b.cnt) as monthly_messaging_interactions from sc_kpi.kpi_metrics_final a join sc_kpi.kpi_metrics_final b on a.entity=b.entity and a.month_ending=b.month_ending and b.metric_id=3045 where a.metric_id=3044 and a.entity= :entity and A.month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending group by 1 order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc coaching calls per enrolled members chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_coaching_calls_per_enrolled_members_chart",
        "data_query": "select dim_field, cnt as coaching_calls_per_enrolled_member from sc_kpi.kpi_metrics_final where metric_id=3048 and  entity= :entity  and month_ending = :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc top telephonic individual goals completed table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_telephonic_individual_goals_completed_table",
        "data_query": "select a.dim_field, sum(a.cnt) as telephonic_goals_active, sum(b.cnt) as telephonic_goals_completed from sc_kpi.kpi_metrics_final a join sc_kpi.kpi_metrics_final b on a.entity=b.entity and a.month_ending=b.month_ending and b.metric_id=3047 and a.dim_field=b.dim_field where   a.metric_id=3046 and a.entity= :entity and a.month_ending = :month_ending group by 1 order by 2 desc, 1 limit 5;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "TARGETED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "targeted_members_disease",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=3004 and entity=:entity and lower(dim_field) IN ('targeted') and month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_disease",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=3004 and entity=:entity and lower(dim_field) IN ('enrolled') and month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_disease",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when lower(dim_field) IN ('enrolled') then cnt else null end)/sum(case when lower(dim_field) IN ('targeted') then cnt else null end))*100,1) || '%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id=3004 and entity=:entity and  month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "ENCOUTERS PER ENROLLED MEMBER",
        "visulization_type": "KPI",
        "placeholder_name": "encounters_per_enrolled_members_disease",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(cnt,1) as encounter_per_enrolled_member from sc_kpi.kpi_metrics_final where metric_id=3005 and entity=:entity and month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "ENROLLEES PER MONTH",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrollees_per_month_disease",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,dm.encounter_per_enrolled_member from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3 )elig left join (select month_ending,entity,cnt as encounter_per_enrolled_member from sc_kpi.kpi_metrics_final where metric_id=3006 and entity=:entity) dm on (elig.month_ending = dm.month_ending and elig.entity = dm.entity) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "PARTICIPATION FUNNEL",
        "visulization_type": "Funnel",
        "placeholder_name": "ptpn_funnel_disease",
        "style": "",
        "category": "funnel",
        "data_query": "select dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=3004 and entity=:entity and month_ending = :month_ending order by case when dim_field IN ('Targeted') then 1 when dim_field IN ('Callable') then 2 when dim_field IN ('Attempted') then 3 when dim_field IN ('Enrolled') then 4 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "funnel_2"
    },
    {
        "slide_title": "Marketplace",
        "visualization_name": "CURRENT ENROLLMENTS IN MARKETPLACE",
        "visulization_type": "KPI",
        "placeholder_name": "current_enrollment",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(cnt) total_enrollment from sc_kpi.kpi_metrics_final where metric_id=5003 and split_part(dim_field,'||',2) = 'Enrollments' and entity=:entity and month_ending = :month_ending and  (split_part(dim_Field,'||',1) IN ('Parenting Program', 'Unwinding Anxiety', 'Fertility Program', 'Type 2 Diabetes Management', 'Pregnancy Program', 'Financial Well-being', 'Scaleback', 'Tobacco Cessation', 'Muscle and Joint Health' , 'Diabetes Education' )) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Marketplace",
        "visualization_name": "MEMBERS ENROLLING IN 1+ PROGRAMS",
        "visulization_type": "KPI",
        "placeholder_name": "membes_1+_program",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(cnt) members_enrolling_1plus_prog from sc_kpi.kpi_metrics_final where metric_id=5042 and split_part(dim_field,'||',1) = 'Market Place' and entity=:entity and month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Marketplace",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Stacked Bar Chart",
        "placeholder_name": "program_engagement_marketplace",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,elig.entity,split_part(enroll.dim_field,'||',1)program_name,enroll.cnt enrolled_cnt from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where metric_id=3 and entity= :entity and month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and month_ending >= '2020-01' order by 1) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity) where (split_part(enroll.dim_Field,'||',1) IN ('Parenting Program', 'Unwinding Anxiety', 'Fertility Program', 'Type 2 Diabetes Management', 'Pregnancy Program', 'Financial Well-being', 'Scaleback', 'Tobacco Cessation', 'Muscle and Joint Health', 'Diabetes Education' )) order by 1,3;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "pivot:get_program_engagemnt_df"
    },
    {
        "slide_title": "Marketplace",
        "visualization_name": "PARTICIPANT ACTIVITY",
        "visulization_type": "Table",
        "placeholder_name": "participant_activity_marketplace",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT lu.dim_field program_name, ppelig.cnt ppelig_cnt, ppeligreg.cnt ppeligreg_cnt, CASE WHEN enroll.cnt > 1 THEN assess.cnt ELSE NULL END assessment_starts , CASE WHEN enroll.cnt > 1 THEN qual.cnt ELSE NULL END qualified_cnt , enroll.cnt enroll_cnt , CAST( ROUND((enroll.cnt/ppeligreg.cnt)*100,1) AS DECIMAL(6,1) )||'%' enroll_rate from ( select distinct month_ending,split_part(dim_field,'||',1)dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5001,5003) AND entity= :entity AND month_ending = :month_ending ) LU left join ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id in (5001) AND entity= :entity AND month_ending = :month_ending ) ppelig on (LU.month_ending = ppelig.month_ending and lu.entity = ppelig.entity and lu.dim_field = split_part(ppelig.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5002 AND entity= :entity) ppeligreg ON ( LU.month_ending = ppeligreg.month_ending AND LU.entity = ppeligreg.entity AND lu.dim_field = split_part(ppeligreg.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5003 AND entity= :entity) enroll ON ( LU.month_ending = enroll.month_ending AND LU.entity = enroll.entity AND lu.dim_field = split_part(enroll.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5008 AND entity= :entity) assess ON ( LU.month_ending = assess.month_ending AND LU.entity = assess.entity AND LU.dim_field = split_part(assess.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5010 AND entity= :entity) qual ON ( LU.month_ending = qual.month_ending AND LU.entity = qual.entity AND LU.dim_field = split_part(qual.dim_field,'||',1)) WHERE ( LU.dim_field IN ('Parenting Program', 'Unwinding Anxiety', 'Fertility Program', 'Type 2 Diabetes Management', 'Pregnancy Program', 'Financial Well-being', 'Scaleback', 'Tobacco Cessation', 'Muscle and Joint Health', 'Diabetes Education' )) and ( enroll.cnt is not null or ppelig.cnt is not null ) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_members_fert",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_regd_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_fertility",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_fert",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_enrollment_fertility",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,enroll.cnt enrolled_cnt,disenroll.cnt disenrolled_cnt from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5006,5007) and entity= :entity and split_part(dim_field,'||',1) = 'Fertility Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt::int from sc_kpi.kpi_metrics_final where metric_id=5006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt::int from sc_kpi.kpi_metrics_final where metric_id=5007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrolled_members_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "assessment_results",
        "style": "",
        "category": "table",
        "data_query": "SELECT CASE WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 'Total Disenrollments' WHEN split_part(dim_field,'||',2) = 'Enrolled via another Ovia program' THEN '          Enrolled via another Ovia program' WHEN split_part(dim_field,'||',2) = 'Enrolled via qualification assessment' THEN '          Enrolled via qualification assessment' WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN '     Net Enrollments' ELSE split_part(dim_field,'||',2) END dim_field, cnt FROM ( SELECT DISTINCT dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5003,5008,5009,5010,5011,5012,5013,5014,5015,5075,5076) AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Fertility Program' )x ORDER BY CASE WHEN split_part(dim_field,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dim_field,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dim_field,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dim_field,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dim_field,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN 7 WHEN split_part(dim_field,'||',2) = 'Enrolled via another Ovia program' THEN 8 WHEN split_part(dim_field,'||',2) = 'Enrolled via qualification assessment' THEN 9 END ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5020 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Fertility Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_res_fertility",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, ts.cnt total_session, avgs.cnt avg_Session, ROUND ( CAST ( ROUND((ts.cnt/avgs.cnt),1) AS DECIMAL(6,1) ), 1) AS avg_session_per_users FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dim_field FROM ( SELECT DISTINCT month_ending, entity FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14 ),'yyyy-mm') AND :month_ending AND entity= :entity AND metric_id = 3) a LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5021,5022) AND entity= :entity AND split_part(dim_field,'||',1) = 'Fertility Program') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5021 AND entity= :entity) ts ON ( ts.month_ending = elig.month_ending AND ts.entity = elig.entity AND split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5022 AND entity= :entity) avgs ON ( elig.month_ending = avgs.month_ending AND elig.entity = avgs.entity AND split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "obj_to_float:avg_session_per_users"
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "participant_activity_fertility",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5023 and entity= :entity and split_part(dim_field,'||',1) = 'Fertility Program' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt  from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_regd_members_preg",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt  from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_pregnancy",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_pregnancy",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_enrollments_pregnancy",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, enroll.cnt enrolled_cnt, disenroll.cnt disenrolled_cnt FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dim_field FROM ( SELECT DISTINCT month_ending, entity FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending AND month_ending >= '2020-01' AND entity= :entity AND metric_id = 3) a LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5006,5007) AND entity= :entity AND split_part(dim_field,'||',1) = 'Pregnancy Program') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5006 AND entity= :entity) enroll ON ( elig.month_ending = enroll.month_ending AND elig.entity = enroll.entity AND split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5007 AND entity= :entity) disenroll ON ( elig.month_ending = disenroll.month_ending AND elig.entity = disenroll.entity AND split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "pregnency_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,3)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "assessment_results_preg",
        "style": "",
        "category": "table",
        "data_query": "SELECT CASE WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 'Total Disenrollments' WHEN split_part(dim_field,'||',2) = 'Enrolled via another Ovia program' THEN '          Enrolled via another Ovia program' WHEN split_part(dim_field,'||',2) = 'Enrolled via qualification assessment' THEN '          Enrolled via qualification assessment' WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN '     Net Enrollments' ELSE split_part(dim_field,'||',2) END assessment, cnt FROM ( SELECT DISTINCT dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5003,5008,5009,5010,5011,5012,5013,5014,5015,5075,5076) AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Pregnancy Program' )x ORDER BY CASE WHEN split_part(dim_field,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dim_field,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dim_field,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dim_field,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dim_field,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN 7 WHEN split_part(dim_field,'||',2) = 'Enrolled via another Ovia program' THEN 8 WHEN split_part(dim_field,'||',2) = 'Enrolled via qualification assessment' THEN 9 END ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "GESTATIONAL AGE DISTRIBUTION(In Months)",
        "visulization_type": "Bar Chart",
        "placeholder_name": "gestational_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)grp,pct from ( select distinct dim_field,round((cnt/sum(cnt)over(partition by :entity))*100,3)||'%'pct from sc_kpi.kpi_metrics_final where metric_id in (5016) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Pregnancy Program' )x order by case when split_part(dim_field,'||',2) = '1-3' then 1 when split_part(dim_field,'||',2) = '4-6' then 2 when split_part(dim_field,'||',2) = '7-9' then 3 when split_part(dim_field,'||',2) = '10+' then 4 end",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_preg",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5020 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions_preg",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Pregnancy Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_res_pregnancy",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt::int total_session,avgs.cnt::int avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Pregnancy Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_pregnancy",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5023 and entity= :entity and split_part(dim_field,'||',1) = 'Pregnancy Program' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "CLINICAL PROGRAM (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "clinical_program_preg",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5026 and entity= :entity and split_part(dim_field,'||',1) = 'Pregnancy Program' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "HIGH RISK",
        "visulization_type": "KPI",
        "placeholder_name": "high_risk_preg",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5032 and split_part(dim_field,'||',1) = 'Pregnancy Program' and entity=:entity and month_ending = :month_ending;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "BIRTHS REPORTED",
        "visulization_type": "KPI",
        "placeholder_name": "births_reported",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5033 and split_part(dim_field,'||',1) = 'Pregnancy Program' and entity=:entity and month_ending = :month_ending;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "C-SECTION RATE",
        "visulization_type": "KPI",
        "placeholder_name": "c_section_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5034 and split_part(dim_field,'||',2) = 'C Section' then cnt else null end) / sum(case when metric_id = 5033 then cnt else null end))*100,1)||'%' c_section_rate from sc_kpi.kpi_metrics_final where metric_id in (5033,5034) and split_part(dim_field,'||',1) = 'Pregnancy Program' and entity=:entity and month_ending = :month_ending;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "PRETERM DELIVERY",
        "visulization_type": "KPI",
        "placeholder_name": "preterm_delivery_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast( round((a.cnt / b.cnt)*100,1) as decimal(6,1) ) ||'%' from ( select entity , month_ending , cnt from sc_kpi.kpi_metrics_final where metric_id in (5035) and split_part(dim_field,'||',1) = 'Pregnancy Program' and split_part(dim_field,'||',2) = 'PreTerm' and entity=:entity and month_ending = :month_ending ) A join ( select entity , month_ending , cnt from sc_kpi.kpi_metrics_final where metric_id=5033 and split_part(dim_field,'||',1) = 'Pregnancy Program' and entity=:entity and month_ending = :month_ending ) B on a.entity = b.entity and a.month_ending = b.month_ending",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "ACTIVITY TRENDS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "activity_trends_pregnancy",
        "style": "",
        "category": "chart",
        "data_query": "SELECT a.month_ending , SUM( CASE WHEN split_part(b.dim_field,'||',2) in ('digitalCoach','Digital Coach') AND b.cnt IS NOT NULL THEN b.cnt ELSE NULL END)digitalCoach , SUM( CASE WHEN split_part(b.dim_field,'||',2) in ('moduleEnrollment','Module Completion') AND b.cnt IS NOT NULL THEN b.cnt ELSE NULL END) moduleEnrollment FROM ( SELECT DISTINCT month_ending, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14), 'yyyy-mm') AND :month_ending AND entity= :entity and month_ending >= '2020-01' AND metric_id = 3 )a LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE entity= :entity AND metric_id=5037 AND split_part(dim_field,'||',1) = 'Pregnancy Program' ) b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) GROUP BY 1 ORDER BY 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "WEEKS AT DELIVERY",
        "visulization_type": "Pie Chart",
        "placeholder_name": "weeks_at_delivery",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)DeliveryTerm,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%' pct from sc_kpi.kpi_metrics_final where metric_id in (5035) and split_part(dim_field,'||',1) = 'Pregnancy Program' and entity=:entity and month_ending = :month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "pivot:pie_chart_null"
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "DELIVERY TYPE",
        "visulization_type": "Pie Chart",
        "placeholder_name": "delivery_type",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)DeliveryTerm,(cnt/sum(cnt)over(partition by :entity)) pct from sc_kpi.kpi_metrics_final where metric_id in (5036) and split_part(dim_field,'||',1) = 'Pregnancy Program' and entity=:entity and month_ending = :month_ending order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "pivot:pie_chart_null"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program _regd_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "prog_enrollment_parenting",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,enroll.cnt enrolled_cnt,disenroll.cnt disenrolled_cnt from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5006,5007) and entity= :entity and split_part(dim_field,'||',1) = 'Parenting Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "age_dist_parenting",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "assesment_parenting",
        "style": "",
        "category": "table",
        "data_query": "SELECT CASE WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 'Total Disenrollments' WHEN split_part(dim_field,'||',2) = 'Enrolled via another Ovia program' THEN '          Enrolled via another Ovia program' WHEN split_part(dim_field,'||',2) = 'Enrolled via qualification assessment' THEN '          Enrolled via qualification assessment' WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN '     Net Enrollments' ELSE split_part(dim_field,'||',2) END assessment, cnt  FROM ( SELECT DISTINCT dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5003,5008,5009,5010,5011,5012,5013,5014,5015,5075,5076) AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Parenting Program' )x ORDER BY CASE WHEN split_part(dim_field,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dim_field,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dim_field,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dim_field,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dim_field,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN 7 WHEN split_part(dim_field,'||',2) = 'Enrolled via another Ovia program' THEN 8 WHEN split_part(dim_field,'||',2) = 'Enrolled via qualification assessment' THEN 9 END;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5020 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Parenting Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_parenting",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt::int total_session,avgs.cnt::int avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Parenting Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_parenting",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5023 and entity= :entity and split_part(dim_field,'||',1) = 'Parenting Program' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "CLINICAL PROGRAM (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "clinical_program_parenting",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5026 and entity= :entity and split_part(dim_field,'||',1) = 'Parenting Program' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_regd_members_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_enrollments_financial",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dim_field,'||',1)program_name, enroll.cnt enrolled_cnt, disenroll.cnt disenrolled_cnt FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dim_field, b.cnt FROM ( SELECT DISTINCT month_ending, entity FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14 ),'yyyy-mm') AND :month_ending AND entity= :entity AND metric_id = 3) a LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id in (5006,5007) AND entity= :entity AND split_part(dim_field,'||',1) = 'Financial Well-being') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5006 AND entity= :entity) enroll ON ( elig.month_ending = enroll.month_ending AND elig.entity = enroll.entity AND split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5007 AND entity= :entity) disenroll ON ( elig.month_ending = disenroll.month_ending AND elig.entity = disenroll.entity AND split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrollment_by_age_financial",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLMENT BY GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "enrollment_by_gender_financial",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)gender, round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5004 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_enrolled_members_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5020 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Financial Well-being') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_financial",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dim_field,'||',1)program_name, ts.cnt::int total_session, avgs.cnt::int avg_Session, ROUND((ts.cnt/avgs.cnt),1) avg_session_per_users FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dim_field FROM ( SELECT DISTINCT month_ending, entity FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending and month_ending >= '2020-01' AND entity= :entity AND metric_id = 3) a LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5021,5022) AND entity= :entity AND split_part(dim_field,'||',1) = 'Financial Well-being') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5021 AND entity= :entity) ts ON ( ts.month_ending = elig.month_ending AND ts.entity = elig.entity AND split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5022 AND entity= :entity) avgs ON ( elig.month_ending = avgs.month_ending AND elig.entity = avgs.entity AND split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "participant_activity_financial",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5023 and entity= :entity and split_part(dim_field,'||',1) = 'Financial Well-being' and month_ending = :month_ending order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "CONTENT VIEW (TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "content_view_financial",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5025 and entity= :entity and split_part(dim_field,'||',1) = 'Financial Well-being' and month_ending = :month_ending order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "TOOL USE (TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "tool_use_financial",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5024 and entity= :entity and split_part(dim_field,'||',1) = 'Financial Well-being' and month_ending = :month_ending order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_members_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_regd_members_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_members_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_enrollment_craving",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name, enroll.cnt enrolled_cnt,disenroll.cnt disenrolled_cnt from ( select distinct a.month_ending,a.entity,b.dim_field,b.cnt from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity,cnt from sc_kpi.kpi_metrics_final where metric_id in (5006,5007) and entity= :entity and split_part(dim_field,'||',1) = 'Tobacco Cessation') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS BY TYPE",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_by_type_craving",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,smoke.cnt smoke_cnt,vape.cnt vape_cnt from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5017,5018) and entity= :entity and split_part(dim_field,'||',1) = 'Tobacco Cessation') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5017 and entity= :entity) smoke on (elig.month_ending = smoke.month_ending and elig.entity = smoke.entity and split_part(elig.dim_field,'||',1) = split_part(smoke.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5018 and entity= :entity) vape on (elig.month_ending = vape.month_ending and elig.entity = vape.entity and split_part(elig.dim_field,'||',1) = split_part(vape.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrolled_members_bar_craving",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "enrolled_members_pie_craving",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)gender, round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5004 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "assessment_results_craving",
        "style": "",
        "category": "table",
        "data_query": "select case when split_part(dim_field,'||',2) = 'Total Disenrollments' then 'Total Disenrollments' when split_part(dim_field,'||',2) = 'Enrollments' then '     Net Enrollments' else split_part(dim_field,'||',2) end assessment, cnt from ( select distinct dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id in (5008,5009,5010,5011,5012,5013,5075,5076,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' )x order by case when split_part(dim_field,'||',2) = 'Total Assessment Starts' then 1 when split_part(dim_field,'||',2) = 'Total Assessment Completions' then 2 when split_part(dim_field,'||',2) = 'Total Assessment Qualified' then 3 when split_part(dim_field,'||',2) = 'Total Assessment Disqualified' then 4 WHEN split_part(dim_field,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN 7 when split_part(dim_field,'||',2) = 'Smoking' then 8 when split_part(dim_field,'||',2) = 'Vaping' then 9 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_session_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5020 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Tobacco Cessation') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_craving_quit",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dim_field,'||',1)program_name, ts.cnt total_session, avgs.cnt avg_Session, ROUND((ts.cnt/avgs.cnt),1) avg_session_per_users FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dim_field FROM ( SELECT DISTINCT month_ending, entity FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending and month_ending >= '2020-01' AND entity= :entity AND metric_id = 3) a LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5021,5022) AND entity= :entity AND split_part(dim_field,'||',1) = 'Tobacco Cessation') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5021 AND entity= :entity) ts ON ( ts.month_ending = elig.month_ending AND ts.entity = elig.entity AND split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5022 AND entity= :entity) avgs ON ( elig.month_ending = avgs.month_ending AND elig.entity = avgs.entity AND split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_craving_quit",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5023 and entity= :entity and split_part(dim_field,'||',1) = 'Tobacco Cessation' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "TOOL USE (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "tool_use_craving",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5024 and entity= :entity and split_part(dim_field,'||',1) = 'Tobacco Cessation' and month_ending = :month_ending order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Craving to Quit  Results",
        "visualization_name": "PARTICIPANTS QUIT SMOKING",
        "visulization_type": "KPI",
        "placeholder_name": "quit_smoking_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5039 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Results",
        "visualization_name": "QUIT RATE (of Module Completers)",
        "visulization_type": "KPI",
        "placeholder_name": "quit_rate_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5039 then cnt else null end)/sum(case when metric_id = 5038 then cnt else null end))*100,1)||'%' pct from sc_kpi.kpi_metrics_final where metric_id in (5038,5039) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Craving to Quit  Results",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_craving",
        "style": "",
        "category": "chart",
        "data_query": "select month_ending,sum(case when lower( split_part(dim_field,'||',2) ) =  'community' then cnt else null end) community ,sum(case when split_part(dim_field,'||',2) = 'Tool Use' then cnt else null end) tooluse ,sum(case when split_part(dim_field,'||',2) = 'Digital Coaching' then cnt else null end) digital_coaching ,sum(case when split_part(dim_field,'||',2) = 'Tracker Entries' then cnt else null end) trackerentries from sc_kpi.kpi_metrics_final where metric_id in (5040) and entity= :entity and split_part(dim_field,'||',1) = 'Tobacco Cessation' and month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending group by 1 order by 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Craving to Quit  Results",
        "visualization_name": "MILESTONE COMPLETION",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_craving",
        "style": "",
        "category": "table",
        "data_query": "select * from ( select distinct split_part(dim_field,'||',2) milestone,cnt from sc_kpi.kpi_metrics_final where metric_id=5041 and entity= :entity and split_part(dim_field,'||',1) = 'Tobacco Cessation' and month_ending = :month_ending ) X ORDER BY case when milestone IN ('Enrollments') then 1 when milestone IN ('Completed All Modules') then 2 when milestone IN ('Program Completion') then 3 when milestone IN ('Module 4 Completion') then 4 else 5 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "prog_eligible_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(cnt as decimal(7, 0)) as cnt  from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "prog_regd_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(cnt as decimal(7, 0)) as cnt  from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_member_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast(cnt as decimal(7, 0)) as cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "prog_enroll_anx",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,enroll.cnt enrolled_cnt,disenroll.cnt disenrolled_cnt from ( select distinct a.month_ending,a.entity,b.dim_field,b.cnt from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity,cnt from sc_kpi.kpi_metrics_final where metric_id in (5006,5007) and entity= :entity and split_part(dim_field,'||',1) = 'Unwinding Anxiety') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "age_dist_anx",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "gender_anx",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)gender, round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5004 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(cnt as decimal(7, 0)) as cnt  from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_member_1+_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(cnt as decimal(7, 0)) as cnt  from sc_kpi.kpi_metrics_final where metric_id=5020 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_1+_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Unwinding Anxiety') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "prog_engagement_anx",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Unwinding Anxiety') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_anx",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5023 and entity= :entity and split_part(dim_field,'||',1) = 'Unwinding Anxiety' and month_ending = :month_ending order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "CONTENT VIEW (TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "conten_view_anx",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5025 and entity= :entity and split_part(dim_field,'||',1) = 'Unwinding Anxiety' and month_ending = :month_ending order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "TOOL USE (TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "tool_use_anx",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5024 and entity= :entity and split_part(dim_field,'||',1) = 'Unwinding Anxiety' and month_ending = :month_ending order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "TOTAL MODULE COMPLETION",
        "visulization_type": "KPI",
        "placeholder_name": "module_comp_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(cnt as decimal(7, 0)) as cnt  from sc_kpi.kpi_metrics_final where metric_id=5023 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Unwinding Anxiety' and lower( split_part(dim_field,'||',2) ) like 'module%completion' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "AVERAGE GAD - 7 SCORE",
        "visulization_type": "KPI",
        "placeholder_name": "avg_gad_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "SELECT CAST (  cnt as DECIMAL(6,1 ) ) FROM sc_kpi.kpi_metrics_final WHERE metric_id=5027 AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "ACTIVITY TRENDS ( Distinct Members Per Month)",
        "visulization_type": "Bar Chart",
        "placeholder_name": "activity_trends_anx",
        "style": "",
        "category": "chart",
        "data_query": "SELECT month_ending, SUM( CASE WHEN lower( split_part(dim_field,'||',2) ) like 'module%completion' THEN cnt ELSE NULL END) community , SUM( CASE WHEN lower(split_part(dim_field,'||',2) ) like 'tool%use' THEN cnt ELSE NULL END) tooluse, SUM( CASE WHEN lower(split_part(dim_field,'||',2)) in ('community') THEN cnt ELSE NULL END) community FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5028) AND entity= :entity AND split_part(dim_field,'||',1) = 'Unwinding Anxiety' AND month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending GROUP BY 1 ORDER BY 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "MEMBERS DECREASING GAD-7 SCORE BY 25%",
        "visulization_type": "KPI",
        "placeholder_name": "gad_score_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "SELECT sum(cnt) FROM sc_kpi.kpi_metrics_final WHERE metric_id=5031 AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Unwinding Anxiety' AND split_part(dim_field,'||',2) in( '26%-37%','38%-49%','50% or greater') ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "GAD-7 DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "gad_dist_anx",
        "style": "",
        "category": "chart",
        "data_query": "SELECT CASE WHEN x.GAD7 = '0-4 Minimal' THEN 1 WHEN x.GAD7 = '5-9 Mild' THEN 2 WHEN x.GAD7 = '10-14 Moderate' THEN 3 WHEN x.GAD7 = '15-21 Severe' THEN 4 END sort, x.GAD7, x.pct , y.pct FROM ( SELECT split_part(dim_field,'||',2) GAD7, ROUND((cnt/SUM(cnt)over(partition BY :entity))*100,1)||'%'pct FROM sc_kpi.kpi_metrics_final WHERE metric_id = 5029 AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Unwinding Anxiety' ORDER BY 1 ) x JOIN ( SELECT split_part(dim_field,'||',2) GAD7, ROUND((cnt/SUM(cnt)over(partition BY :entity))*100,1)||'%'pct FROM sc_kpi.kpi_metrics_final WHERE metric_id = 5030 AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Unwinding Anxiety' ORDER BY 1 ) y ON x.GAD7 = y.GAD7 order by 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:sort"
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "GAD-7 IMPROVEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "gad_imp_anx",
        "style": "",
        "category": "chart",
        "data_query": "SELECT CASE WHEN x.GAD7 = 'Worsening' THEN 1 WHEN x.GAD7 = 'None' THEN 2 WHEN x.GAD7 = '1%-12%' THEN 3 WHEN x.GAD7 = '12%-25%' THEN 4 WHEN x.GAD7 = '26%-37%' THEN 5 WHEN x.GAD7 = '38%-49%' THEN 6 WHEN x.GAD7 ='50% or greater' THEN 7 END sort, x.* FROM ( SELECT split_part(dim_field,'||',2) GAD7, ROUND((cnt/SUM(cnt)over(partition BY :entity))*100,1)||'%'pct FROM sc_kpi.kpi_metrics_final WHERE metric_id = 5031 AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Unwinding Anxiety') x ORDER BY 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:sort"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "eligible_members_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "regd_members_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_ennrollment_scale",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dim_field,'||',1)program_name, enroll.cnt enrolled_cnt, disenroll.cnt disenrolled_cnt FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dim_field, b.cnt FROM ( SELECT DISTINCT month_ending, entity FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending and month_ending >= '2020-01' AND entity= :entity AND metric_id = 3) a LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5006,5007) AND entity= :entity AND split_part(dim_field,'||',1) = 'Scaleback') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5006 AND entity= :entity) enroll ON ( elig.month_ending = enroll.month_ending AND elig.entity = enroll.entity AND split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5007 AND entity= :entity) disenroll ON ( elig.month_ending = disenroll.month_ending AND elig.entity = disenroll.entity AND split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrolled_members_age_distribution_scale",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "emrolled_member_gender_dist_scale",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)gender, round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5004 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5020 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_session_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Scaleback') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_scale",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dim_field,'||',1)program_name, ts.cnt total_session, avgs.cnt avg_Session, ROUND((ts.cnt/avgs.cnt),1) avg_session_per_users FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dim_field FROM ( SELECT DISTINCT month_ending, entity FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending and month_ending >= '2020-01' AND entity= :entity AND metric_id = 3) a LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5021,5022) AND entity= :entity AND split_part(dim_field,'||',1) = 'Scaleback') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5021 AND entity= :entity) ts ON ( ts.month_ending = elig.month_ending AND ts.entity = elig.entity AND split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5022 AND entity= :entity) avgs ON ( elig.month_ending = avgs.month_ending AND elig.entity = avgs.entity AND split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "participant_activity_scale",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5023 and entity= :entity and split_part(dim_field,'||',1) = 'Scaleback' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "TRACKERS (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "trackers_scale",
        "style": "",
        "category": "table",
        "data_query": "select * from (SELECT DISTINCT split_part(dim_field,'||',2) activity, cnt FROM ( SELECT DISTINCT dim_field, cnt, row_number() over(partition BY entity ORDER BY cnt DESC)row_num FROM sc_kpi.kpi_metrics_final WHERE metric_id=5043 AND entity= :entity AND split_part(dim_field,'||',1) = 'Scaleback' AND month_ending = :month_ending ORDER BY 1) x WHERE row_num <= 5)d ORDER BY case when activity IN ('Active_minutes','Active Minutes') then 1 when activity IN ('Meals_logged','Meals Logged') then 2 when activity IN ('Weight') then 3 else 4 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Results",
        "visualization_name": "PROGRAM COMPLETION",
        "visulization_type": "KPI",
        "placeholder_name": "program_completions_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "SELECT cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5105 AND entity=:entity AND month_ending = :month_ending;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Results",
        "visualization_name": "TOTAL POUNDS LOST",
        "visulization_type": "KPI",
        "placeholder_name": "total_pounds_lost_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "SELECT cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5100 AND entity=:entity AND month_ending = :month_ending;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Results",
        "visualization_name": "ACTIVITY TRENDS (Distinct Members per Month)",
        "visulization_type": "Bar Chart",
        "placeholder_name": "activity_trend_scale",
        "style": "",
        "category": "chart",
        "data_query": "SELECT month_ending, SUM( CASE WHEN split_part(dim_field,'||',2) = 'Digital Coaching' and split_part(dim_field,'||',3) = 'SC_DGTL_FS_DPP_WL' THEN cnt ELSE NULL END) dig_coach , SUM( CASE WHEN split_part(dim_field,'||',2) = 'Tracker' and split_part(dim_field,'||',3) = 'SC_DGTL_FS_DPP_WL' THEN cnt ELSE NULL END) monthly_tracker FROM sc_kpi.kpi_metrics_final WHERE metric_id = 5044 AND entity= :entity AND split_part(dim_field,'||',1) = 'Scaleback' AND month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending GROUP BY 1 ORDER BY 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Results",
        "visualization_name": "MILESTONES",
        "visulization_type": "Table",
        "placeholder_name": "scaleback_milestones",
        "style": "",
        "category": "table",
        "data_query": "SELECT CASE WHEN f.Milestone = 'Progress Goal 1' THEN 'Completed 2 class sessions and 2 weigh-ins' WHEN f.Milestone = 'Progress Goal 2' THEN 'Completed 6/7 class sessions and 6/7 weigh-ins' WHEN f.Milestone = 'Progress Goal 3' THEN 'Participant has lost >=5% of weight based upon initial non-rejected BodyTrace or fitbit weight' WHEN f.Milestone = 'Successful Program Completion' THEN 'Member indicates that they completed program and achieved Goal of 5% weight loss' ELSE f.Milestone END AS 'Milestone', f.Members, CASE WHEN f.milestone <> ('Enrollments') THEN CAST (100* (f.members/e.members) AS DECIMAL(6,1) ) || '%' ELSE NULL END AS 'Percent of Total' FROM ( SELECT split_part(dim_field,'||',2) Milestone, cnt AS Members, entity, month_ending FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5003) AND month_ending = :month_ending AND entity = :entity AND split_part(dim_field,'||',1) = 'Scaleback' UNION SELECT split_part(dim_field,'||',3) Milestone, cnt AS Members, entity, month_ending FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5081) AND month_ending =  :month_ending  AND entity = :entity AND split_part(dim_field,'||',1) = 'Scaleback' AND split_part(dim_field,'||',2) = 'Milestone' )f LEFT JOIN ( SELECT split_part(dim_field,'||',2) Milestone, cnt AS Members, entity, month_ending FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5003) AND month_ending =  :month_ending  AND entity = :entity AND split_part(dim_field,'||',1) = 'Scaleback' )e ON ( e.entity = f.entity AND e.month_ending = f.month_ending) ORDER BY ( CASE WHEN f.Milestone = 'Enrollments' THEN '01' ELSE f.milestone END) ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "msk_program_eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "msk_program_eligible_regd_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "msk_enrolled_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "msk_enrollment_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "msk_program_enrollment",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,enroll.cnt enrolled_cnt,disenroll.cnt disenrolled_cnt from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5006,5007) and entity= :entity and split_part(dim_field,'||',1) = 'Muscle and Joint Health') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt::int from sc_kpi.kpi_metrics_final where metric_id=5006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt::int from sc_kpi.kpi_metrics_final where metric_id=5007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "msk_enrolled_members_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "msk_assessment_results",
        "style": "",
        "category": "table",
        "data_query": "SELECT case when split_part(dim_field,'||',2) = 'Total Disenrollments' then 'Total Disenrollments' when split_part(dim_field,'||',2) = 'Enrollments' then '     Net Enrollments' else split_part(dim_field,'||',2) end assessment, cnt FROM ( SELECT DISTINCT dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5003,5008,5009,5010,5011,5012,5013,5015,5075,5076,5003) AND metric_id NOT IN ( 5014) AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Muscle and Joint Health' )x ORDER BY CASE WHEN split_part(dim_field,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dim_field,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dim_field,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dim_field,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dim_field,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN 7 END;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "msk_enrolled_members_gender_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)gender, round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5004 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLED MEMBER RISK STRATIFICATION",
        "visulization_type": "Table",
        "placeholder_name": "msk_enrolled_members_risk_stratification",
        "style": "",
        "category": "table",
        "data_query": "select split_part(dim_field,'||',3) as stratification,cnt from ( select distinct dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id = 5050 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' )x order by 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "msk_total_sessions",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBER WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "msk_enrolled_members_1+_app",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Muscle and Joint Health') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "PROGRAM DIGITAL ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "msk_prog_engagement",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Muscle and Joint Health') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "msk_participant_activity",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5023 and entity= :entity and split_part(dim_field,'||',1) = 'Muscle and Joint Health' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "TOP PROGRAMS(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "msk_top_programs",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5026 and entity= :entity and split_part(dim_field,'||',1) = 'Muscle and Joint Health' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc average mhq score",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_average_mhq_score",
        "data_query": "select cast( round(cnt, 1) as float ) from sc_kpi.kpi_metrics_final where metric_id = 5051 and entity = :entity and month_ending  =  :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc average daily readiness",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_average_daily_readiness",
        "data_query": "select cast( round(cnt, 1) as float ) from sc_kpi.kpi_metrics_final where metric_id = 5052 and entity = :entity and month_ending  =  :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc average daily readiness score improvement",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_average_daily_readiness_score_improvement",
        "data_query": "select cast( round(cnt, 4) as float ) *100||'%'  from sc_kpi.kpi_metrics_final where metric_id = 5053 and entity = :entity and month_ending  =  :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc mhq average score table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Table",
        "placeholder_name": "sc_mhq_average_score_table",
        "data_query": "select dim_field, cast( round(cnt, 1) as decimal(8,0) ) from sc_kpi.kpi_metrics_final where metric_id = 5055 and entity = :entity and month_ending  =  :month_ending order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc daily readiness average scores table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Table",
        "placeholder_name": "sc_daily_readiness_average_scores_table",
        "data_query": "select dim_field, cast( round(cnt, 1) as decimal(8,0) ) from sc_kpi.kpi_metrics_final where metric_id = 5056 and entity = :entity and month_ending  =  :month_ending order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc daily readiness score improvement chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "CHART",
        "placeholder_name": "sc_daily_readiness_score_improvement_chart",
        "data_query": "select split_part(dim_field,'||',3), cast( round(cnt, 1) as decimal(8,0) ) from sc_kpi.kpi_metrics_final where metric_id = 5054 and entity = :entity and month_ending  =  :month_ending order by case when split_part(dim_field,'||',3)='Worsening' then 1 when split_part(dim_field,'||',3)='No Change' then 2 when split_part(dim_field,'||',3)='1% - 12%' then 3 when split_part(dim_field,'||',3)='13% - 25%' then 4 when split_part(dim_field,'||',3)='26% - 37%' then 5 when split_part(dim_field,'||',3)='38% - 49%' then 6 when split_part(dim_field,'||',3)='50% +' then 7 end;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "duo_program_eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5001 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "duo_program_eligible_regd_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5002 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "duo_enrolled_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "duo_enrollment_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate from sc_kpi.kpi_metrics_final where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "duo_program_enrollment",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,enroll.cnt enrolled_cnt,disenroll.cnt disenrolled_cnt from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5006,5007) and entity= :entity and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt::int from sc_kpi.kpi_metrics_final where metric_id=5006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt::int from sc_kpi.kpi_metrics_final where metric_id=5007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "duo_enrolled_members_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5005 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "duo_assessment_results",
        "style": "",
        "category": "table",
        "data_query": "SELECT case when split_part(dim_field,'||',2) = 'Total Disenrollments' then 'Total Disenrollments' when split_part(dim_field,'||',2) = 'Enrollments' then '     Net Enrollments' else split_part(dim_field,'||',2) end assessment, cnt FROM ( SELECT DISTINCT metric_id, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5008,5009,5010,5011,5012,5013,5015, 5003, 5075,5076) AND metric_id NOT IN (5014) AND entity=:entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' )x ORDER BY CASE WHEN split_part(dim_field,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dim_field,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dim_field,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dim_field,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dim_field,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN 7 END;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "duo_enrolled_members_gender_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dim_field,'||',2)gender, round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct from sc_kpi.kpi_metrics_final where metric_id=5004 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "duo_total_sessions",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5019 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "duo_enrolled_members_1+_app",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5020 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBER WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "duo_average_sessions_1+_app",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "PROGRAM DIGITAL ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "duo_prog_engagement",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dim_field,'||',1)program_name,ts.cnt total_session,avgs.cnt avg_Session, round((ts.cnt/avgs.cnt),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dim_field from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 3) a left join (select distinct month_ending,dim_field,entity from sc_kpi.kpi_metrics_final where metric_id in (5021,5022) and entity= :entity and split_part(dim_field,'||',1) = 'Type 2 Diabetes Management') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dim_field,'||',1) = split_part(elig.dim_field,'||',1)) left join (select distinct month_ending,entity,dim_field,cnt from sc_kpi.kpi_metrics_final where metric_id=5022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dim_field,'||',1) = split_part(avgs.dim_field,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "duo_participant_activity",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT split_part(dim_field,'||',2) activity, cnt FROM ( SELECT DISTINCT dim_field, cnt, row_number() over(partition BY entity ORDER BY cnt DESC)row_num FROM sc_kpi.kpi_metrics_final WHERE metric_id=5023 AND entity= :entity AND split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' AND month_ending = :month_ending ORDER BY 1) x WHERE row_num <= 3 ORDER BY 2 DESC;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "TOP MODULES",
        "visulization_type": "Table",
        "placeholder_name": "duo_top_modules",
        "style": "",
        "category": "table",
        "data_query": "SELECT * FROM ( SELECT DISTINCT split_part(dim_field,'||',2) activity, cnt FROM ( SELECT DISTINCT dim_field, cnt, row_number() over(partition BY entity ORDER BY cnt DESC)row_num FROM sc_kpi.kpi_metrics_final WHERE metric_id=5071 AND entity= :entity AND split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' AND month_ending = :month_ending ORDER BY 1) x WHERE row_num <= 3)d ORDER BY cnt desc ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "TOP TRACKERS",
        "visulization_type": "Table",
        "placeholder_name": "duo_top_trackers",
        "style": "",
        "category": "table",
        "data_query": "SELECT * FROM ( SELECT DISTINCT split_part(dim_field,'||',2) activity, cnt FROM ( SELECT DISTINCT dim_field, cnt, row_number() over(partition BY entity ORDER BY cnt DESC)row_num FROM sc_kpi.kpi_metrics_final WHERE metric_id=5072 AND entity= :entity AND split_part(dim_field,'||',1) = 'Type 2 Diabetes Management' AND month_ending = :month_ending ORDER BY 1) x WHERE row_num <= 3)d ORDER BY cnt desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc risk change measured members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_risk_change_measured_members",
        "data_query": "select cnt::int as 'Measured Members'  from sc_kpi.kpi_metrics_final  where metric_id=2054 and entity = :entity and month_ending = :month_ending",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc lifestyle risk change",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_lifestyle_risk_change",
        "data_query": "select -1*(CAST( ROUND(cnt*100,1) AS DECIMAL(6,1) ) ) || '%' as 'Lifestyle risk change'  from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Lifestyle Risks' and entity=:entity and month_ending = :month_ending",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc top3 lifestyle risk count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_lifestyle_risk_count",
        "data_query": "SELECT t1.dim_field as 'Risk Name', t1.cnt::int as 'T1 Risk Points' FROM (SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) where t1.dim_field in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Lifestyle') and t1.cnt is not null ORDER BY t1.cnt desc limit 3;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc top3 lifestyle risk reduction",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_lifestyle_risk_reduction",
        "data_query": "SELECT t1.dim_field as 'Risk Name',  TRIM( TO_CHAR(tx.cnt-t1.cnt, '999,999,999.9') )  AS 'Risk Reduction' FROM (SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) where t1.dim_field in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Lifestyle') and (tx.cnt-t1.cnt)<0 ORDER BY (tx.cnt-t1.cnt) asc, t1.dim_field limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc top3 lifestyle risk increase",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_lifestyle_risk_increase",
        "data_query": "SELECT t1.dim_field as 'Risk Name', TRIM( TO_CHAR(tx.cnt-t1.cnt, '999,999,999.9') ) AS 'Risk Increase' FROM (SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) where t1.dim_field in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Lifestyle') and (tx.cnt-t1.cnt)>0 ORDER BY (tx.cnt-t1.cnt) desc, t1.dim_field limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc lifestyle risk chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_lifestyle_risk_chart",
        "data_query": "SELECT t1.dim_field AS dim_field, t1.cnt AS 'T1 Risk Points', tx.cnt AS 'Tx Risk Points', CASE WHEN t1.cnt=0 and tx.cnt = 0 THEN '0%' WHEN t1.cnt=0 THEN '' ELSE ROUND(((tx.cnt-t1.cnt)/t1.cnt)*100,1)::VARCHAR || '%' END AS '% change' FROM ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) WHERE t1.dim_field IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Lifestyle') ORDER BY t1.dim_field",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc risk change measured members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_risk_change_measured_members",
        "data_query": "select cnt::int as 'Measured Members'  from sc_kpi.kpi_metrics_final  where metric_id=2054 and entity=:entity and month_ending = :month_ending",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc biometric risk change",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_biometric_risk_change",
        "data_query": "select -1*(CAST( ROUND(cnt*100,1) AS DECIMAL(6,1) ) )  || '%' as 'Biometric risk change'  from sc_kpi.kpi_metrics_final where metric_id=2053 and dim_field = 'Biometric Risks' and entity=:entity and month_ending = :month_ending",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc top3 biometric risk count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_biometric_risk_count",
        "data_query": "SELECT case when t1.dim_field in ('A1C','A1C (PWD)') then 'A1C' else t1.dim_field end as 'Risk Name', t1.cnt::int as 'T1 Risk Points'             FROM (SELECT DISTINCT month_ending, dim_field, entity, cnt          FROM sc_kpi.kpi_metrics_final                      WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1               LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final                       WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx               ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity)               where case when t1.dim_field in ('A1C','A1C (PWD)') then 'A1C'             else t1.dim_field end in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Biometric') and t1.cnt is not null ORDER BY t1.cnt desc limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc top3 biometric risk reduction",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_biometric_risk_reduction",
        "data_query": "SELECT case when t1.dim_field in ('A1C','A1C (PWD)') then 'A1C' else t1.dim_field end as 'Risk Name', TRIM(  TO_CHAR(tx.cnt-t1.cnt, '999,999,999.9') ) AS 'Risk Reduction' FROM (SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) where case when t1.dim_field in ('A1C','A1C (PWD)') then 'A1C' else t1.dim_field end in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Biometric') and (tx.cnt-t1.cnt)<0 ORDER BY (tx.cnt-t1.cnt) asc, t1.dim_field limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc top3 biometric risk increase",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_biometric_risk_increase",
        "data_query": "SELECT case when t1.dim_field in ('A1C','A1C (PWD)') then 'A1C' else t1.dim_field end as 'Risk Name', TRIM(TO_CHAR(tx.cnt-t1.cnt, '999,999,999.9') )  AS 'Risk Increase' FROM (SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) where case when t1.dim_field in ('A1C','A1C (PWD)') then 'A1C' else t1.dim_field end in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Biometric') and (tx.cnt-t1.cnt)>0 ORDER BY (tx.cnt-t1.cnt) desc, t1.dim_field limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc biometric risk chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_biometric_risk_chart",
        "data_query": "SELECT CASE WHEN t1.dim_field IN ('A1C', 'A1C (PWD)') THEN 'A1C' ELSE t1.dim_field END AS dim_field, t1.cnt AS 'T1 Risk Points', tx.cnt AS 'Tx Risk Points', CASE WHEN t1.cnt=0 and tx.cnt = 0 THEN '0%' WHEN t1.cnt=0 THEN '' ELSE ROUND(((tx.cnt-t1.cnt)/t1.cnt)*100,1)::VARCHAR || '%' END AS '% change' FROM ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) WHERE CASE WHEN t1.dim_field IN ('A1C', 'A1C (PWD)') THEN 'A1C' ELSE t1.dim_field END IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Biometric') ORDER BY t1.dim_field",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc risk change measured members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_risk_change_measured_members",
        "data_query": "select cnt::int as 'Measured Members'  from sc_kpi.kpi_metrics_final  where metric_id=2054 and entity=:entity and month_ending = :month_ending",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc preventive risk change",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_preventive_risk_change",
        "data_query": "SELECT -1*(CAST( ROUND(cnt*100,1) AS DECIMAL(6,1) ) ) || '%' AS 'Preventive risk change' FROM sc_kpi.kpi_metrics_final WHERE metric_id=2053 AND dim_field = 'Preventive Risks' AND entity=:entity AND month_ending = :month_ending",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc top3 preventive risk count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_preventive_risk_count",
        "data_query": "SELECT t1.dim_field AS 'Risk Name', t1.cnt::INT AS 'T1 Risk Points' FROM ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) WHERE t1.dim_field IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Preventive') AND t1.cnt IS NOT NULL ORDER BY t1.cnt DESC limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc top3 preventive risk reduction",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_preventive_risk_reduction",
        "data_query": "SELECT t1.dim_field AS 'Risk Name', TRIM( TO_CHAR(tx.cnt-t1.cnt, '999,999,999.9') ) AS 'Risk Reduction' FROM ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) WHERE t1.dim_field IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Preventive') AND ( tx.cnt-t1.cnt)<0 ORDER BY (tx.cnt-t1.cnt) ASC, t1.dim_field limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc top3 preventive risk increase",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_preventive_risk_increase",
        "data_query": "SELECT t1.dim_field AS 'Risk Name', TRIM ( TO_CHAR(tx.cnt-t1.cnt, '999,999,999.9') ) AS 'Risk Increase' FROM ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) WHERE t1.dim_field IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Preventive') AND ( tx.cnt-t1.cnt)>0 ORDER BY (tx.cnt-t1.cnt) DESC, t1.dim_field limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc preventive risk chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_preventive_risk_chart",
        "data_query": "SELECT t1.dim_field AS dim_field, t1.cnt AS 'T1 Risk Points', tx.cnt AS 'Tx Risk Points', CASE WHEN t1.cnt=0 and tx.cnt = 0 THEN '0%' WHEN t1.cnt=0 THEN '' ELSE ROUND(((tx.cnt-t1.cnt)/t1.cnt)*100,1)::VARCHAR || '%' END AS '% change' FROM ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2075 )t1 LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE month_ending = :month_ending AND entity= :entity AND metric_id = 2076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dim_field = tx.dim_field AND t1.entity = tx.entity) WHERE t1.dim_field IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Preventive') ORDER BY t1.dim_field",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Results",
        "visualization_name": "sc diabetes module completions",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_module_completions",
        "data_query": "select cast(cnt as decimal(7, 0)) as cnt   from sc_kpi.kpi_metrics_final  where metric_id=5023 and entity=:entity  and month_ending = :month_ending  and split_part(dim_field,'||',1) = 'Diabetes Education' and split_part(dim_field,'||',2) = 'Module Completion';",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Results",
        "visualization_name": "sc diabetes program completions",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_program_completions",
        "data_query": "select cast(cnt as decimal(7, 0)) as cnt   from sc_kpi.kpi_metrics_final  where metric_id=5023 and entity=:entity  and month_ending = :month_ending  and split_part(dim_field,'||',1) = 'Diabetes Education' and split_part(dim_field,'||',2) = 'Successful Program Completion';",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Results",
        "visualization_name": "sc diabetes module count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_diabetes_module_count",
        "data_query": "SELECT module_name as activity, cnt FROM ( SELECT DISTINCT split_part(dim_field,'||',2) activity,module_name, cnt FROM ( SELECT DISTINCT dim_field ,module_name, cnt, row_number() over(partition BY entity ORDER BY cnt DESC)row_num FROM sc_kpi.kpi_metrics_final a join sc_enterprise_daily.module_lu b on lower(split_part(a.dim_field,'||',2) ) = lower(b.event_value ) WHERE metric_id=5071 AND entity= :entity AND split_part(dim_field,'||',1) = 'Diabetes Education' AND month_ending = :month_ending order by 1 ) x WHERE row_num <= 10)d ORDER BY cnt DESC;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Results",
        "visualization_name": "sc diabetes engagement chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_diabetes_engagement_chart",
        "data_query": "SELECT DISTINCT elig.month_ending, ModuleCompletion.cnt ModuleCompletion_cnt, ProgramCompletion.cnt ProgramCompletion_cnt  FROM (SELECT DISTINCT a.month_ending, a.entity         FROM (SELECT DISTINCT month_ending, entity                 FROM sc_kpi.kpi_metrics_final                  WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending                  AND entity= :entity                  AND metric_id = 3) a          LEFT JOIN (SELECT DISTINCT month_ending, entity                 FROM sc_kpi.kpi_metrics_final                  WHERE metric_id IN (5063)                  AND entity= :entity                  AND split_part(dim_field,'||',1) = 'Diabetes Education') b          ON (a.month_ending = b.month_ending AND a.entity = b.entity) ) elig  LEFT JOIN (SELECT DISTINCT month_ending, entity, dim_field, cnt          FROM sc_kpi.kpi_metrics_final          WHERE metric_id=5063         AND entity= :entity         AND split_part(dim_field,'||',1) = 'Diabetes Education'         and split_part(dim_field,'||',3) in ('moduleCompletion','Module Completion')) ModuleCompletion  ON (elig.month_ending = ModuleCompletion.month_ending AND elig.entity = ModuleCompletion.entity          )  LEFT JOIN (SELECT DISTINCT month_ending, entity, dim_field, cnt          FROM sc_kpi.kpi_metrics_final          WHERE metric_id=5063 AND entity= :entity         AND split_part(dim_field,'||',1) = 'Diabetes Education'         and split_part(dim_field,'||',3) in ('successfulProgramCompletion','Successful Program Completion')) ProgramCompletion  ON (elig.month_ending = ProgramCompletion.month_ending      AND elig.entity = ProgramCompletion.entity      )  ORDER BY 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes elig members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_elig_members",
        "data_query": "select cnt::int from sc_kpi.kpi_metrics_final  where metric_id=5001 and entity=:entity and month_ending = :month_ending  and split_part(dim_field,'||',1) = 'Diabetes Education'  order by 1",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes elig reg members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_elig_reg_members",
        "data_query": "select cnt::int from sc_kpi.kpi_metrics_final  where metric_id=5002 and entity=:entity and month_ending = :month_ending  and split_part(dim_field,'||',1) = 'Diabetes Education'  order by 1",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes enrolled members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_enrolled_members",
        "data_query": "select cnt::int  from sc_kpi.kpi_metrics_final  where metric_id=5003 and entity=:entity and month_ending = :month_ending  and split_part(dim_field,'||',1) = 'Diabetes Education'  order by 1",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes enrollment rate",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_enrollment_rate",
        "data_query": "select round((sum(case when metric_id = 5003 then cnt else null end)/sum(case when metric_id = 5002 then cnt else null end))*100,1)||'%' enrollment_rate  from sc_kpi.kpi_metrics_final  where metric_id in (5002,5003) and entity=:entity and month_ending = :month_ending  and split_part(dim_field,'||',1) = 'Diabetes Education'  order by 1",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes enrollment chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_diabetes_enrollment_chart",
        "data_query": "SELECT DISTINCT elig.month_ending, enroll.cnt enrolled_cnt, disenroll.cnt disenrolled_cnt  FROM (SELECT DISTINCT a.month_ending, a.entity, b.dim_field, b.cnt          FROM (SELECT DISTINCT month_ending, entity                  FROM sc_kpi.kpi_metrics_final                  WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending                  AND month_ending >= '2020-01'                  AND entity= :entity                  AND metric_id = 3) a          LEFT JOIN (SELECT DISTINCT month_ending, dim_field, entity, cnt                  FROM sc_kpi.kpi_metrics_final                  WHERE metric_id IN (5006,5007)                  AND entity= :entity                  AND split_part(dim_field,'||',1) = 'Diabetes Education') b          ON (a.month_ending = b.month_ending AND a.entity = b.entity) ) elig  LEFT JOIN (SELECT DISTINCT month_ending, entity, dim_field, cnt          FROM sc_kpi.kpi_metrics_final          WHERE metric_id=5006          AND entity= :entity) enroll  ON (elig.month_ending = enroll.month_ending AND elig.entity = enroll.entity AND split_part(elig.dim_field,'||',1) = split_part(enroll.dim_field,'||',1))  LEFT JOIN (SELECT DISTINCT month_ending, entity, dim_field, cnt          FROM sc_kpi.kpi_metrics_final          WHERE metric_id=5007 AND entity= :entity) disenroll  ON (elig.month_ending = disenroll.month_ending      AND elig.entity = disenroll.entity      AND split_part(elig.dim_field,'||',1) = split_part(disenroll.dim_field,'||',1))  ORDER BY 1",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes assessment table",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_diabetes_assessment_table",
        "data_query": "SELECT case when split_part(dim_field,'||',2) = 'Total Disenrollments' then 'Total Disenrollments' when split_part(dim_field,'||',2) = 'Enrollments' then '     Net Enrollments' else split_part(dim_field,'||',2) end assessment, cnt FROM ( SELECT DISTINCT metric_id, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5008,5009,5010,5011,5012,5013,5015,5003,5075,5076) AND metric_id NOT IN (5014) AND entity= :entity AND month_ending = :month_ending AND split_part(dim_field,'||',1) = 'Diabetes Education' )x ORDER BY CASE WHEN split_part(dim_field,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dim_field,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dim_field,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dim_field,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dim_field,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dim_field,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dim_field,'||',2) = 'Enrollments' THEN 7 END;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc enrolled age chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_enrolled_age_chart",
        "data_query": "select split_part(dim_field,'||',2)age_group,round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct  from sc_kpi.kpi_metrics_final  where metric_id=5005 and entity=:entity and month_ending = :month_ending  and split_part(dim_field,'||',1) = 'Diabetes Education'  order by 1",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc enrolled gender chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_enrolled_gender_chart",
        "data_query": "select split_part(dim_field,'||',2)gender, round((cnt/sum(cnt)over(partition by :entity))*100,1)||'%'pct  from sc_kpi.kpi_metrics_final where metric_id=5004 and entity=:entity and month_ending = :month_ending  and split_part(dim_field,'||',1) = 'Diabetes Education'  order by 1",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "1Challenge Details  Sponsor Initiated",
        "visualization_name": "sc top challenges count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top_challenges_count",
        "data_query": "SELECT CHALLENGE_NAME, CHALLENGE_TYPE, GOAL_UNITS, CHALLENGE_GOAL, CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, CAST(ROUND(Partipant_Rate::FLOAT,1) AS DECIMAL(6,1 ) ) ||'%'Partipant_Rate FROM ( SELECT DISTINCT CHALLENGE_NAME, CHALLENGE_TYPE, CHALLENGE_GOAL, GOAL_UNITS, TO_CHAR(CHALLENGE_START_DATE,'YYYY-MM-DD') AS CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, (CHALLENGE_COMPLETERS/CHALLENGE_MEMBERS)*100 Partipant_Rate, row_number() OVER( PARTITION BY MONTH_ENDING, ENTITY ORDER BY CHALLENGE_COMPLETERS DESC )rank FROM sc_kpi.kpi_metrics_challenge_participant_detail A WHERE metric_id = 2108 AND entity=:entity AND month_ending = :month_ending ) dd ORDER BY 6 DESC, 5 DESC, 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "1Challenge Details  Sponsor Initiated",
        "visualization_name": "sc challenges in progress",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_challenges_in_progress",
        "data_query": "SELECT CHALLENGE_NAME, CHALLENGE_TYPE, GOAL_UNITS, CHALLENGE_GOAL, CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, CAST(ROUND(Partipant_Rate::FLOAT,1) AS DECIMAL(6,1 ) ) ||'%'Partipant_Rate FROM ( SELECT DISTINCT CHALLENGE_NAME, CHALLENGE_TYPE, CHALLENGE_GOAL, GOAL_UNITS, TO_CHAR(CHALLENGE_START_DATE,'YYYY-MM-DD') AS CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, (CHALLENGE_COMPLETERS/CHALLENGE_MEMBERS)*100 Partipant_Rate, row_number() OVER( PARTITION BY MONTH_ENDING, ENTITY ORDER BY CHALLENGE_COMPLETERS DESC )rank FROM sc_kpi.kpi_metrics_challenge_participant_detail A WHERE metric_id = 2109 AND entity=:entity AND month_ending = :month_ending ) dd ORDER BY 6 DESC, 5 DESC, 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "2Challenge Details  Sponsor Initiated",
        "visualization_name": "sc top challenges count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top_challenges_count",
        "data_query": "SELECT CHALLENGE_NAME, CHALLENGE_TYPE, GOAL_UNITS, CHALLENGE_GOAL, CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, CAST(ROUND(Partipant_Rate::FLOAT,1) AS DECIMAL(6,1 ) ) ||'%'Partipant_Rate FROM ( SELECT DISTINCT CHALLENGE_NAME, CHALLENGE_TYPE, CHALLENGE_GOAL, GOAL_UNITS, TO_CHAR(CHALLENGE_START_DATE,'YYYY-MM-DD') AS CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, (CHALLENGE_COMPLETERS/CHALLENGE_MEMBERS)*100 Partipant_Rate, row_number() OVER( PARTITION BY MONTH_ENDING, ENTITY ORDER BY CHALLENGE_COMPLETERS DESC )rank FROM sc_kpi.kpi_metrics_challenge_participant_detail A WHERE metric_id = 2108 AND entity=:entity AND month_ending = :month_ending ) dd ORDER BY 6 DESC, 5 DESC, 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge completes",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_challenge_completes",
        "data_query": "select cast(cnt as integer) from sc_kpi.kpi_metrics_final where metric_id=51 and entity=:entity and month_ending=:month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge participations",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_challenge_participations",
        "data_query": "select cast(cnt as integer) from sc_kpi.kpi_metrics_final where metric_id=2101 and entity=:entity and month_ending=:month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge completion rate",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_challenge_completion_rate",
        "data_query": "select cast(round(((select cnt from sc_kpi.kpi_metrics_final where metric_id=51 and entity=:entity and month_ending=:month_ending) / (select cnt from sc_kpi.kpi_metrics_final where metric_id=2101 and entity=:entity and month_ending=:month_ending))*100,1) as decimal(6,1) ) || '%';",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge participant rate",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_challenge_participant_rate",
        "data_query": "select cast(round(((select cnt from sc_kpi.kpi_metrics_final where metric_id=2105 and entity=:entity and month_ending=:month_ending) / (select cnt from sc_kpi.kpi_metrics_final where metric_id=7 and entity=:entity and month_ending=:month_ending))*100,1) as decimal(6,1) ) || '%';",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge ptpn by month",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_challenge_ptpn_by_month",
        "data_query": "select x.month_ending,cast(b.cnt as integer) as participations,c.cnt as completions from (select distinct month_ending,entity from sc_kpi.kpi_metrics_final where metric_id=3 and month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending ) x         left join sc_kpi.kpi_metrics_final b on (x.month_ending=b.month_ending and b.metric_id=2100 and x.entity=b.entity)         left join sc_kpi.kpi_metrics_final c on (x.month_ending=c.month_ending and c.metric_id=49 and x.entity=c.entity) where b.entity=:entity order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge ptpn by goal",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_challenge_ptpn_by_goal",
        "data_query": "SELECT xx2.dim_field, cast(ptpns as integer) as ptpns, cast(completes as integer) as completes, cast( ROUND((completes/ptpns)*100,1) as decimal(6,1) )||'%' AS 'Participation Rate'  FROM ( SELECT xx1.*, row_number() over(partition BY month_ending,entity ORDER BY ptpns DESC)row_number          FROM ( SELECT DISTINCT ptpns.month_ending, ptpns.dim_field, ptpns.entity, ptpns.ptpns, comp.completes                  FROM ( SELECT month_ending, dim_field, entity, cnt ptpns                          FROM sc_kpi.kpi_metrics_final                         WHERE metric_id=2104 AND entity=:entity AND month_ending = :month_ending) ptpns                 LEFT JOIN ( SELECT month_ending, dim_field, entity, cnt completes                                 FROM sc_kpi.kpi_metrics_final                                 WHERE metric_id=2011 AND entity=:entity AND month_ending = :month_ending) comp                                         ON ( ptpns.month_ending = comp.month_ending AND ptpns.entity = comp.entity AND ptpns.dim_field = comp.dim_field) ) xx1         where   not (ptpns is null and completes is null) ) xx2 WHERE row_number <= 7 ORDER BY 2 DESC;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge ptpn by type",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_challenge_ptpn_by_type",
        "data_query": "select part.dim_field as challenge_type,cast(part.cnt as integer) as participations,cast(comp.cnt as integer) as completions,cast(round((comp.cnt/part.cnt)*100,1) as decimal(6,1))||'%' as comp_rate from sc_kpi.kpi_metrics_final part         left join sc_kpi.kpi_metrics_final comp                 on (part.dim_field=comp.dim_field and comp.metric_id=2103 and part.entity=comp.entity and part.month_ending=comp.month_ending) where part.metric_id=2102 and part.entity=:entity and part.month_ending=:month_ending AND not (part.cnt is null and comp.cnt is null) order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Benefits Hub",
        "visualization_name": "sc members engaging with benifit hub",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "KPI",
        "placeholder_name": "sc_members_engaging_with_benifit_hub",
        "data_query": "select cast( round(cnt, 1) as decimal(8,0) )  from sc_kpi.kpi_metrics_final where metric_id = 1800 and entity = :entity and month_ending  = :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Benefits Hub",
        "visualization_name": "sc clicks to external program per registered member",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "KPI",
        "placeholder_name": "sc_clicks_to_external_program_per_registered_member",
        "data_query": "select cast( round(cnt, 1) as decimal(8,0) )  from sc_kpi.kpi_metrics_final where metric_id = 1801 and entity = :entity and month_ending  = :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Benefits Hub",
        "visualization_name": "sc benefits hub activity by month chart",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_benefits_hub_activity_by_month_chart",
        "data_query": "SELECT substring(month_id::char(7),1,4)||'-'||substring(month_id::char(7),5,2) as month_ending ,cast ( round( (case when a.cnt is null then 0.0 else a.cnt end ) , 1) as int ) as unique_visitors ,cast (round ( (case when b.cnt is null then 0.0 else b.cnt end ) , 1) as int ) as external_clicks FROM (select distinct month_id from dwimp.dwimp_date) z left join sc_kpi.kpi_metrics_final a on (substring(month_id::char(7),1,4)||'-'||substring(month_id::char(7),5,2)=a.month_ending and a.metric_id=1803 and a.entity= :entity) left join sc_kpi.kpi_metrics_final b on (substring(month_id::char(7),1,4)||'-'||substring(month_id::char(7),5,2)=b.month_ending and b.metric_id=1804 and b.entity=:entity) WHERE substring(month_id::char(7),1,4)||'-'||substring(month_id::char(7),5,2) BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending ORDER BY 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Benefits Hub",
        "visualization_name": "sc top external programs top 5",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_external_programs_top_5",
        "data_query": "select dim_field as programs,cnt as clicks from sc_kpi.kpi_metrics_final where metric_id = 1802 and entity = :entity and month_ending  =  :month_ending Order by cnt desc;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "LEARNING TRACKS ASSIGNED",
        "visulization_type": "KPI",
        "placeholder_name": "sc_learning_tracks_assigned",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(cnt)::INT as lt_assigned from sc_kpi.kpi_metrics_final where metric_id=3060 and entity= :entity and month_ending = :month_ending;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "LEARNING TRACKS COMPLETED",
        "visulization_type": "KPI",
        "placeholder_name": "sc_learning_tracks_completed",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(cnt)::INT as lt_completed from sc_kpi.kpi_metrics_final where metric_id=3061 and entity= :entity and month_ending = :month_ending;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "LEARNING TRACKS COMPLETION RATE",
        "visulization_type": "KPI",
        "placeholder_name": "sc_learning_tracks_completion_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round (((( select sum(cnt) from sc_kpi.kpi_metrics_final where metric_id=3061 and entity=:entity and month_ending = :month_ending )/(select sum(cnt) from sc_kpi.kpi_metrics_final where metric_id=3060 and entity=:entity and month_ending = :month_ending ))*100), 1) || '%';",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "LEARINING TRACKS COMPLETION CHART",
        "visulization_type": "Stacked Bar Chart",
        "placeholder_name": "sc_learning_tracks_completions_per_month",
        "style": "",
        "category": "chart",
        "data_query": "select id_1.month_ending,id_1.cnt as cnt_1,(id_2.cnt) as cnt_2 from (select month_ending,sum(cnt) as cnt from sc_kpi.kpi_metrics_final where metric_id=3062 and entity= :entity and month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending group by 1)id_1 inner join (select month_ending,sum(cnt) as cnt from sc_kpi.kpi_metrics_final where metric_id=3063 and entity= :entity and month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending group by 1)id_2 on id_1.month_ending=id_2.month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "TOP 5 LEARNING TRACK COMPLETIONS",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_5_learning_tracks_completed_table",
        "style": "",
        "category": "table",
        "data_query": "select a.dim_field, sum(a.cnt) as lt_assigned, sum(b.cnt) as lt_completed from sc_kpi.kpi_metrics_final a join sc_kpi.kpi_metrics_final b on a.entity=b.entity and a.month_ending=b.month_ending and b.metric_id=3061 and a.dim_field=b.dim_field where a.metric_id=3060 and a.entity= :entity and a.month_ending = :month_ending and b.cnt is not null group by 1 order by 3 desc, 1 limit 5;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc timeline cards impressions",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_timeline_cards_impressions",
        "data_query": "select cast(cnt as integer) as impressions from sc_kpi.kpi_metrics_final where entity=:entity and metric_id = 6002 and month_ending = :month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc timeline cards distinct members",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_timeline_cards_distinct_members",
        "data_query": "select cast(cnt as integer) as members from sc_kpi.kpi_metrics_final where entity=:entity and metric_id = 6003 and month_ending = :month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc timeline cards clicks",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_timeline_cards_clicks",
        "data_query": "select cast(cnt as integer) as clicks from sc_kpi.kpi_metrics_final where entity=:entity and metric_id = 6004  and month_ending = :month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc timeline cards clicks per user",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_timeline_cards_clicks_per_user",
        "data_query": "select cast( round(cnt, 1) as float) as average_clicks from sc_kpi.kpi_metrics_final where entity=:entity and metric_id = 6005 and month_ending = :month_ending  ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc top campaigns by impressions table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top_campaigns_by_impressions_table",
        "data_query": "SELECT DISTINCT campaignName, to_char(campaignStartDate, 'yyyy-mm-dd') as startDate, cast(round(impressions) as integer) as impressions, members, clicks,  cast((clicks/impressions*100) as decimal(6,1))||'%' as click_rate FROM sc_kpi.kpi_metrics_timeline_campaign_detail_staging A WHERE metric_id = 6000 AND entity=:entity  and month_ending = :month_ending ORDER BY 3 desc, 5 desc limit 10;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Client-Sponsored Timeline Cards (Current Quarter)",
        "visualization_name": "sc top timeline cards by impressions table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top_timeline_cards_by_impressions_table",
        "data_query": "SELECT DISTINCT cardTitle, to_char(cardStartDate, 'yyyy-mm-dd') as startDate, ctaLabel,  cast(round(impressions) as integer) as impressions, members, clicks, cast((clicks/impressions*100) as decimal(6,1))||'%' as click_rate  FROM sc_kpi.kpi_metrics_timeline_card_detail_staging A WHERE metric_id = 6001 AND entity=:entity  and month_ending = :month_ending  ORDER BY 4 desc, 6 desc limit 10;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk elig enrolled members",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_msk_elig_enrolled_members",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5003 and entity=:entity and  split_part(dim_field,'||',1) = 'Muscle and Joint Health'and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk coach session completions",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_msk_coach_session_completions",
        "data_query": "select cnt from sc_kpi.kpi_metrics_final where metric_id=5150 and entity=:entity and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk coach sessions per members",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_msk_coach_sessions_per_members",
        "data_query": "SELECT cast( round(sessions/members, 1) as float) FROM ( SELECT entity, cnt sessions FROM sc_kpi.kpi_metrics_final WHERE metric_id=5150 AND month_ending = :month_ending AND entity = :entity ) A JOIN ( SELECT entity, cnt members FROM sc_kpi.kpi_metrics_final WHERE metric_id=5003 AND month_ending = :month_ending AND entity = :entity AND split_part(dim_field, '||',1 ) = 'Muscle and Joint Health' ) B ON A.entity = B.entity;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk coach engagement chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "CHART",
        "placeholder_name": "sc_msk_coach_engagement_chart",
        "data_query": "SELECT DISTINCT a.month_ending, b.cnt as coaching_session_completion , c.cnt as coaching_messages FROM ( SELECT DISTINCT month_ending, entity FROM sc_kpi.kpi_metrics_final WHERE month_ending BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending AND entity= :entity AND metric_id = 3 ) a LEFT JOIN ( SELECT DISTINCT month_ending, dim_field, entity, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id IN (5151) AND entity= :entity AND split_part(dim_field,'||',1) = 'Muscle and Joint Health' ) b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) LEFT JOIN ( SELECT DISTINCT month_ending, entity, dim_field, cnt FROM sc_kpi.kpi_metrics_final WHERE metric_id=5153 AND split_part(dim_field,'||',1) = 'Muscle and Joint Health' AND entity= :entity ) c ON ( C.month_ending = A.month_ending AND C.entity = A.entity ) ORDER BY 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk activity count table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_msk_activity_count_table",
        "data_query": "select case when Activity = 'CoachMessage' then ' Coaching Messaging' when Activity = 'ClassCompletion' then 'Coching Sessions Completions' else Activity end Activity, Lifetime_Count from ( select split_part(dim_field,'||',2) Activity ,cnt Lifetime_Count from sc_kpi.kpi_metrics_final where metric_id=5150 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' union select split_part(dim_field,'||',2) Activity,cnt Lifetime_Count from sc_kpi.kpi_metrics_final where metric_id=5152 and entity=:entity and month_ending = :month_ending and split_part(dim_field,'||',1) = 'Muscle and Joint Health' )X order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk milestone count table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_msk_milestone_count_table",
        "data_query": "select CASE WHEN split_part(dim_field,'||',3) = 'Progress Goal 1' THEN 'Member + Coach complete 1-4/12' WHEN split_part(dim_field,'||',3) = 'Progress Goal 2' THEN 'Member + Coach complete 5-8/12' WHEN split_part(dim_field,'||',3) = 'Progress Goal 3' THEN 'Member + Coach complete 9-12/12' end milestone,cnt from sc_kpi.kpi_metrics_final where metric_id in (5081) and month_ending = :month_ending and entity = :entity and split_part(dim_field,'||',1) = 'Muscle and Joint Health' and split_part(dim_field,'||',2) = 'Milestone' order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Results",
        "visualization_name": "sc average a1c change",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_average_a1c_change",
        "data_query": "select cast(cnt as decimal(2,2) ) cnt from sc_kpi.kpi_metrics_final where metric_id=5107 and entity=:entity and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Results",
        "visualization_name": "sc diabetes avg reduction over9",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_diabetes_avg_reduction_over9",
        "data_query": "select cast(cnt as decimal(2,2) ) from sc_kpi.kpi_metrics_final where metric_id=5108 and entity=:entity and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Results",
        "visualization_name": "sc diabetes a1c change chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "CHART",
        "placeholder_name": "sc_diabetes_a1c_change_chart",
        "data_query": "select split_part(dim_field,'||',2) A1C_Change, cast( cnt as decimal( 6,2) ) from sc_kpi.kpi_metrics_final where metric_id=5109 and entity=:entity and month_ending = :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Results",
        "visualization_name": "sc diabetes a1c change table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_diabetes_a1c_change_table",
        "data_query": "select A.A1C_Change,  cast( A.cnt as decimal( 6,2) ) as change , ( case when A.cnt is not null then B.cnt else null end ) ::INT as Unique_Members from ( select entity, split_part(dim_field,'||',2) A1C_Change, cnt from sc_kpi.kpi_metrics_final where metric_id=5109 and entity=:entity and month_ending = :month_ending order by 1 ) A left join ( select entity , split_part(dim_field,'||',2) A1C_Change, cnt from sc_kpi.kpi_metrics_final where metric_id=5110 and entity=:entity and month_ending = :month_ending order by 1 ) B on A.entity = B.entity and A.A1C_Change = B.A1C_Change order by 1; ",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge initiated",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_challenge_initiated",
        "data_query": "select cnt::INT as cnt from sc_kpi.kpi_metrics_final where metric_id=2110 and entity=:entity and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge invitations",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_challenge_invitations",
        "data_query": "select cnt::INT as cnt from sc_kpi.kpi_metrics_final where metric_id=2111 and entity=:entity and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge participations",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_challenge_participations",
        "data_query": "select nvl(cnt,0)::INT as cnt from sc_kpi.kpi_metrics_final where metric_id=2112 and entity=:entity and month_ending = :month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge completions rate",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_challenge_completions_rate",
        "data_query": "select case when cyo_challenge_participations = 0 then '-' else cast ( ( ( cyo_challenge_completions / cyo_challenge_participations) * 100 )::CHAR(5) as decimal(6,1) ) || '%' end cyo_challenge_completion_rate from ( ( select entity, nvl(cnt, 0) cyo_challenge_completions from sc_kpi.kpi_metrics_final where metric_id=2113 and entity=:entity and month_ending = :month_ending ) A join ( select entity, nvl(cnt, 0) cyo_challenge_participations from sc_kpi.kpi_metrics_final where metric_id=2112 and entity=:entity and month_ending = :month_ending ) B on a.entity = b.entity ) x;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge participations by month chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "CHART",
        "placeholder_name": "sc_challenge_participations_by_month_chart",
        "data_query": "select A.month_ending , A.cnt, B.cnt from ( select month_ending,entity, nvl(cnt, 0) cnt from sc_kpi.kpi_metrics_final where metric_id in (2115) and entity=:entity ) A left join (select month_ending,entity, nvl(cnt, 0) cnt from sc_kpi.kpi_metrics_final where metric_id in (2114) and entity=:entity ) B on A.month_ending = B.month_ending and A.entity = B.entity where A.month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge participation by goal type table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_challenge_participation_by_goal_type_table",
        "data_query": "select A.challenge_type, A.cnt::INT as cnt_1, B.cnt::INT as cnt_2, C.cnt::INT as cnt_3, case when c.cnt = 0 or c.cnt is null then '-' else cast (( nvl(D.cnt, 0 ) / C.cnt )*100 as decimal (6,1) ) ||'%' end as cnt_4 from ( select month_ending ,entity, cnt , dim_field challenge_type from sc_kpi.kpi_metrics_final where metric_id in (2116) and entity=:entity and month_ending = :month_ending ) A left join ( select month_ending ,entity, cnt , dim_field challenge_type from sc_kpi.kpi_metrics_final where metric_id in (2117) and entity=:entity and month_ending = :month_ending ) B on A.entity = B.entity and A.challenge_type = B.challenge_type left join ( select month_ending ,entity, cnt , dim_field challenge_type from sc_kpi.kpi_metrics_final where metric_id in (2118) and entity=:entity and month_ending = :month_ending ) C on A.entity = C.entity and A.challenge_type = C.challenge_type left join ( select month_ending ,entity, cnt , dim_field challenge_type from sc_kpi.kpi_metrics_final where metric_id in (2119) and entity=:entity and month_ending = :month_ending ) D on A.entity = D.entity and A.challenge_type = D.challenge_type WHERE   not (A.cnt is null and B.cnt is null and C.cnt is null and D.cnt is null) order by 2 desc limit 7 ;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "CLINICAL PROGRAM (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "clinical_program",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dim_field,'||',2) activity,cnt from (select distinct dim_field,cnt,row_number() over(partition by entity order by cnt desc)row_num from sc_kpi.kpi_metrics_final where metric_id=5026 and entity= :entity and split_part(dim_field,'||',1) = 'Fertility Program' and month_ending = :month_ending order by 1) x where row_num <= 5 order by 2 desc",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Programs (Current Quarter)",
        "visualization_name": "CATEGORY FEATURE UTILIZATION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_category_feature_utilization_chart",
        "style": "",
        "category": "chart",
        "data_query": "SELECT uv.dim_field, uv.'Unique Visitors', pv.'Page Views', round(pv.'Page Views'/apv.visits,1) as 'Average page view per visit' FROM ( SELECT dim_field, cnt AS 'Unique Visitors' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6014 AND entity= :entity AND month_ending = :month_ending ) uv JOIN ( SELECT dim_field, cnt as 'Page Views' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6012 AND entity= :entity AND month_ending = :month_ending ) pv ON uv.dim_field = pv.dim_field JOIN ( SELECT dim_field, cnt as 'Visits' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6013 AND entity= :entity AND month_ending = :month_ending ) apv ON uv.dim_field = apv.dim_field order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Programs (Current Quarter)",
        "visualization_name": "TOP 10 PROGRAMS",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_10_programs",
        "style": "",
        "category": "table",
        "data_query": "SELECT uv.dim_field, pv.'Page Views', uv.'Unique Visitors', cast((pv.'Page Views'/apv.visits) as decimal(6,1)) as 'Average page view per visit' FROM ( SELECT dim_field, cnt AS 'Unique Visitors' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6008 AND entity= :entity AND month_ending = :month_ending ) uv JOIN ( SELECT dim_field, cnt as 'Page Views' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6006 AND entity= :entity AND month_ending = :month_ending ) pv ON uv.dim_field = pv.dim_field JOIN ( SELECT dim_field, cnt as 'Visits' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6007 AND entity= :entity AND month_ending = :month_ending ) apv ON uv.dim_field = apv.dim_field order by 3 desc limit 10;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Programs (Current Quarter)",
        "visualization_name": "TOP 10 PROGRAM CONTENT",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_10_program_content",
        "style": "",
        "category": "table",
        "data_query": "SELECT split_part(uv.dim_field,'(',1) as 'Top 10 Program Content', pv.'Content Type', uv.'Content Length', pv.'Content Start', apv.'Content Complete', uv.'Unique Visitors' FROM ( SELECT dim_field, split_part(split_part(dim_field,'(',2),')',1) as 'Content Length', cnt AS 'Unique Visitors' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6011 AND entity= :entity AND month_ending = :month_ending ) uv JOIN ( SELECT split_part(dim_field,'||',3) as dim_field, split_part(dim_field,'||',2) as 'Content Type', cnt AS 'Content Start' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6009 AND entity= :entity AND month_ending = :month_ending ) pv ON uv.dim_field = pv.dim_field JOIN ( SELECT split_part(dim_field,'||',3) as dim_field, cnt AS 'Content Complete' FROM sc_kpi.kpi_metrics_final WHERE metric_id = 6010 AND entity= :entity AND month_ending = :month_ending ) apv ON uv.dim_field = apv.dim_field ORDER BY 6 DESC LIMIT 10;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Content Consumption by Subject (Last 12 Months)",
        "visualization_name": "sc unique content visitors",
        "section_name": "",
        "visulization_type": "KPI",
        "placeholder_name": "sc_unique_content_visitors",
        "data_query": "SELECT isnull(cnt,0)::int from sc_kpi.kpi_metrics_final where metric_id = 2211 and month_ending = :month_ending and entity = :entity;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Content Consumption by Subject (Last 12 Months)",
        "visualization_name": "sc total content visits",
        "section_name": "",
        "visulization_type": "KPI",
        "placeholder_name": "sc_total_content_visits",
        "data_query": "SELECT isnull(cnt,0)::int from sc_kpi.kpi_metrics_final where metric_id = 2212 and month_ending = :month_ending and entity = :entity;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Content Consumption by Subject (Last 12 Months)",
        "visualization_name": "sc top 3 engaged subjects",
        "section_name": "",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_3_engaged_subjects",
        "data_query": "SELECT CASE WHEN med.dim_field = 'Dental Appointment' then 'Dental Appt.' when med.dim_field = 'Medical Appointment Adherence' then 'Medical Appt. Adherence' else med.dim_field end as theme_name,cast(isnull(med.cnt,0) as DECIMAL(5,1)) as median_visits,isnull(v.cnt,0) as unique_visitors FROM ( SELECT dim_field,cnt FROM sc_kpi.kpi_metrics_final where metric_id = 2217 and month_ending = :month_ending and entity = :entity  ) med JOIN  (SELECT dim_field, cnt from sc_kpi.kpi_metrics_final where metric_id = 2216  and month_ending = :month_ending and entity =:entity) v on v.dim_field = med.dim_field order by round(isnull(med.cnt,0)) desc,isnull(v.cnt,0) desc limit 3;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Content Consumption by Subject (Last 12 Months)",
        "visualization_name": "sc member visits by subject and content type",
        "section_name": "",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_member_visits_by_subject_and_content_type",
        "data_query": "SELECT CASE WHEN a.dim_field = 'Dental Appointment' then 'Dental Appt.' when a.dim_field = 'Medical Appointment Adherence' then 'Medical Appt. Adherence' else a.dim_field end as theme_name,isnull(b.cnt,0)::int as article_visits,isnull(c.cnt,0)::int as slideshow_visits,isnull(d.cnt,0)::int as video_visits, isnull(a.cnt,0)::int as unique_visitors,round(isnull(e.cnt,0),1) as median_visits FROM (SELECT dim_field, cnt from sc_kpi.kpi_metrics_final where metric_id = 2216 and month_ending = :month_ending and entity =:entity) a LEFT JOIN (SELECT dim_field, cnt from sc_kpi.kpi_metrics_final where metric_id = 2213 and month_ending = :month_ending and entity =:entity) b on a.dim_field = b.dim_field LEFT JOIN (SELECT dim_field, cnt from sc_kpi.kpi_metrics_final where metric_id = 2214 and month_ending = :month_ending and entity =:entity) c on a.dim_Field = c.dim_field LEFT JOIN(SELECT dim_field, cnt from sc_kpi.kpi_metrics_final where metric_id = 2215 and month_ending = :month_ending and entity =:entity) d on a.dim_field = d.dim_field LEFT JOIN (SELECT dim_field, cnt from sc_kpi.kpi_metrics_final where metric_id = 2217 and month_ending = :month_ending and entity =:entity) e on a.dim_field = e.dim_field order by a.dim_field asc;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    }
]