[
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "OVERALL RISK CHANGE",
        "visulization_type": "KPI",
        "placeholder_name": "overall_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'OVERALL RISK CHANGE' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Overall Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending ; ",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "MEASURED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "outcomes_measured_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast (metric_value as decimal(10, 0) ) as 'MEASURED MEMBERS'  from sc_kpi.metrics_values where metric_id=100002054 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending ; ",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "PREVENTIVE RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "preventive_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Preventive risk' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Preventive Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending;",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "LIFESTYLE RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "lifestyle_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Lifestyle risk' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Lifestyle Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending ;",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Behavior Change and Health Impact",
        "visualization_name": "BIOMETRIC RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "biometric_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Biometric risk' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Biometric Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')  =:month_ending;",
        "section_name": "OUTCOMES",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "REGISTRATION (% OF ELIGIBLE)",
        "visulization_type": "KPI",
        "placeholder_name": "regn_percent",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast (  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending) )*100,1) as decimal(6,1) ) || '%' as 'REGISTRATION (% OF ELIGIBLE)';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "RealAge Test Completion (% of Eligible)",
        "visulization_type": "KPI",
        "placeholder_name": "reslage_test_completion_percent",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002017 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  )*100,1) || '%' as 'REGISTRATION (% OF ELIGIBLE)';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "INCENTIVE PARTICIPATION",
        "visulization_type": "KPI",
        "placeholder_name": "incentive_participation",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002092 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100002091 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  )*100,1) || '%' as 'INCENTIVE PARTICIPATION';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "MONTHLY ACTIVE USERS",
        "visulization_type": "KPI",
        "placeholder_name": "monthly_user",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(metric_value*100,1) || '%' as 'MONTHLY ACTIVE USERS' from sc_kpi.metrics_values where metric_id=10000105 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "90-day engagement",
        "visulization_type": "KPI",
        "placeholder_name": "90day_engagement",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(metric_value*100,1) || '%' as '90-day engagement' from sc_kpi.metrics_values where metric_id=10000103 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending ; ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Challenge participation (% of registered)",
        "visulization_type": "KPI",
        "placeholder_name": "challenge_ptpn",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast(round(((select metric_value from sc_kpi.metrics_values where metric_id=100002105 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') =:month_ending ) / (select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') =:month_ending ))*100,1) as decimal(6,1) ) || '%';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Content visits per Content Visitor",
        "visulization_type": "KPI",
        "placeholder_name": "content_clicks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002028 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100002078 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  ),1) as 'Content visits per Content Visitor';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Lifestyle management enrollment rate",
        "visulization_type": "KPI",
        "placeholder_name": "lifestyle_mgmt_enrollment",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100003001 and dims = 'Enrolled' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')  =:month_ending )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100003001 and dims = 'Targeted' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  )*100,1) || '%' as 'Lifestyle management enrollment rate';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "MEMBERS WITH 1+ CONDITION RISK",
        "visulization_type": "KPI",
        "placeholder_name": "1+condition_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002996 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  )  / ( select sum(metric_value) from sc_kpi.metrics_values where metric_id=100002047 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending )  )*100,1) || '%' as 'MEMBERS WITH 1+ CONDITION RISK';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Members with 1+ Lifestyle Risk",
        "visulization_type": "KPI",
        "placeholder_name": "1+lifestyle_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002995 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending )  / ( select sum(metric_value) from sc_kpi.metrics_values where metric_id=100002047 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  )*100,1) || '%' as 'Members with 1+ Lifestyle Risk';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "NET RISK CHANGE",
        "visulization_type": "KPI",
        "placeholder_name": "net_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'NET RISK CHANGE' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Overall Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ; ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Preventive risk change",
        "visulization_type": "KPI",
        "placeholder_name": "preventive_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Preventive risk change' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Preventive Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending; ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Biometric/Clinical risk change",
        "visulization_type": "KPI",
        "placeholder_name": "biometric_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Biometric risk change' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Biometric Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "1Program Overview",
        "visualization_name": "Lifestyle risk change",
        "visulization_type": "KPI",
        "placeholder_name": "lifestyle_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Lifestyle risk change' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Lifestyle Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending; ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "REGISTRATION (% OF ELIGIBLE)",
        "visulization_type": "KPI",
        "placeholder_name": "regn_percent",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast (  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  )*100,1) as decimal(6,1) ) || '%' as 'REGISTRATION (% OF ELIGIBLE)';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "RealAge Test Completion (% of Eligible)",
        "visulization_type": "KPI",
        "placeholder_name": "reslage_test_completion_percent",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002017 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  )*100,1) || '%' as 'REGISTRATION (% OF ELIGIBLE)';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "INCENTIVE PARTICIPATION",
        "visulization_type": "KPI",
        "placeholder_name": "incentive_participation",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002092 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100002091 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending )  )*100,1) || '%' as 'INCENTIVE PARTICIPATION';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "MONTHLY ACTIVE USERS",
        "visulization_type": "KPI",
        "placeholder_name": "monthly_user",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(metric_value*100,1) || '%' as 'MONTHLY ACTIVE USERS' from sc_kpi.metrics_values where metric_id=10000105 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending; ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "90-day engagement",
        "visulization_type": "KPI",
        "placeholder_name": "90day_engagement",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(metric_value*100,1) || '%' as '90-day engagement' from sc_kpi.metrics_values where metric_id=10000103 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Challenge participation (% of registered)",
        "visulization_type": "KPI",
        "placeholder_name": "challenge_ptpn",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast(round(((select metric_value from sc_kpi.metrics_values where metric_id=100002105 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending ) / (select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending ))*100,1) as decimal(6,1) ) || '%';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Content visits per Content Visitor",
        "visulization_type": "KPI",
        "placeholder_name": "content_clicks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002028 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  / ( select metric_value from sc_kpi.metrics_values where metric_id=100002078 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  ),1) as 'Content visits per Content Visitor';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "MEMBERS WITH 1+ CONDITION RISK",
        "visulization_type": "KPI",
        "placeholder_name": "1+condition_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002996 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending )  / ( select sum(metric_value) from sc_kpi.metrics_values where metric_id=100002047 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )  )*100,1) || '%' as 'MEMBERS WITH 1+ CONDITION RISK';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Members with 1+ Lifestyle Risk",
        "visulization_type": "KPI",
        "placeholder_name": "1+lifestyle_risk",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  round( (  ( select metric_value from sc_kpi.metrics_values where metric_id=100002995 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending )  / ( select sum(metric_value) from sc_kpi.metrics_values where metric_id=100002047 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending )  )*100,1) || '%' as 'Members with 1+ Lifestyle Risk';",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "NET RISK CHANGE",
        "visulization_type": "KPI",
        "placeholder_name": "net_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'NET RISK CHANGE' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Overall Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending; ",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Preventive risk change",
        "visulization_type": "KPI",
        "placeholder_name": "preventive_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Preventive risk change' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Preventive Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Biometric/Clinical risk change",
        "visulization_type": "KPI",
        "placeholder_name": "biometric_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Biometric risk change' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Biometric Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "2Program Overview",
        "visualization_name": "Lifestyle risk change",
        "visulization_type": "KPI",
        "placeholder_name": "lifestyle_risk_change",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select -1*(round(metric_value*100,1)) || '%' as 'Lifestyle risk change' from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Lifestyle Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Employer Groups",
        "visualization_name": "EMPLOYER GROUPS",
        "visulization_type": "KPI",
        "placeholder_name": "employers_grp_exec",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value  as 'EMPLOYER GROUPS' from sc_kpi.metrics_values where metric_id=100003108 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Employer Groups",
        "visualization_name": "EMPLOYER GROUPS - ELIGIBLE MEMBERS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "employers_grp_eligible_members",
        "style": "",
        "category": "chart",
        "data_query": "select * from (select distinct dims , metric_value from sc_kpi.metrics_values where metric_id=100003107 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending)dd order by case when dims = '0 - 99' then 1 when dims = '100 - 999' then 2 else 3 end;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": " "
    },
    {
        "slide_title": "Employer Groups",
        "visualization_name": "Top 10 Employer Name",
        "visulization_type": "Table",
        "placeholder_name": "employers_grp_table",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT REPORTGROUPNAME, ELIGIBLE, REGISTERED, CAST (ROUND((REG_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS REG_RATE, CAST (ROUND((INCENT_PARTIC_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS INCENT_PARTIC_RATE, CAST (ROUND((CHAL_PARTIC_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS CHAL_PARTIC_RATE, CAST (ROUND((RAT_CY_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS RAT_CY_RATE, CAST (ROUND((RAT_LIFETIME_RATE)*100,1) AS DECIMAL(6, 1) ) || '%' AS RAT_LIFETIME_RATE, CAST (ROUND((MAU_SITE)*100,1) AS DECIMAL(6, 1) ) || '%' AS MAU_SITE, CAST (ROUND((MAU_ALL)*100,1) AS DECIMAL(6, 1) ) || '%' AS MAU_ALL, CAST (ROUND((OVERALL_RISK)*100,1) * (-1 ) AS DECIMAL(6, 1) ) || '%' AS OVERALL_RISKS, EMAIL_SENDS FROM sc_kpi.ipr_top10employers A WHERE CUSTOMERID= :entity AND  month_ending=:month_ending  ORDER BY 3 DESC;",
        "section_name": "EXECUTIVE SUMMARY",
        "transformation_rule": " "
    },
    {
        "slide_title": "Eligibility Trends",
        "visualization_name": "Total eligible members",
        "visulization_type": "KPI",
        "placeholder_name": "eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Eligibility Trends",
        "visualization_name": "ELIGIBLE MEMBERS BY MONTH",
        "visulization_type": "Bar Chart",
        "placeholder_name": "eligible_members_by_month",
        "style": "",
        "category": "chart",
        "data_query": "select to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value from sc_kpi.metrics_values where metric_id=100003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') between  to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Eligibility Trends",
        "visualization_name": "ADDITIONS AND REMOVALS BY MONTH",
        "visulization_type": "Stacked Bar Chart",
        "placeholder_name": "addition_removal_by_month",
        "style": "",
        "category": "chart",
        "data_query": "select id_1.month_ending,id_1.metric_value as metric_value_1,-1*(id_2.metric_value) as metric_value_2 from (select to_char(reporting_end_period,'yyyy-mm') as month_ending,metric_value from sc_kpi.metrics_values where metric_id=100001 and entity= :entity and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1) id_1  inner join (select to_char(reporting_end_period,'yyyy-mm') as month_ending,metric_value from sc_kpi.metrics_values where metric_id=100002 and entity= :entity and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1)id_2 on id_1.month_ending =id_2.month_ending order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Eligibility Trends",
        "visualization_name": "Current Quarter Vs Previous Quarter",
        "visulization_type": "KPI",
        "placeholder_name": "current_q_vs_prior_q",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((( (select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(to_date(:month_ending,'yyyy-mm-dd'),'yyyy-mm'))  - (select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm'))) /(select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm')))*100,1) || '%' as 'CQ VS PQ';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "Average Age",
        "visulization_type": "KPI",
        "placeholder_name": "avg_age",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(metric_value,1) avg_age from sc_kpi.metrics_values where metric_id=100002013 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm') = :month_ending;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "Missing Email",
        "visulization_type": "KPI",
        "placeholder_name": "missing_email",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((( select metric_value from sc_kpi.metrics_values where metric_id=100002015 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')= :month_ending ) /( select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')= :month_ending ))*100,1) || '%' as 'Missing Email';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "Missing Phone",
        "visulization_type": "KPI",
        "placeholder_name": "missing_phone",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((( select metric_value from sc_kpi.metrics_values where metric_id=100002016 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ) /( select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ))*100,1) || '%' as 'Missing Phone';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "Gender Breakdown",
        "visulization_type": "Pie Chart",
        "placeholder_name": "eligibe_member_by_gender",
        "style": "",
        "category": "chart",
        "data_query": "select dims,round((metric_value/total_sum)*100,2) || '%'  as PCT from (select dims,metric_value,sum(metric_value) over(partition by entity,to_char(reporting_end_period,'yyyy-mm') order by to_char(reporting_end_period,'yyyy-mm'))Total_Sum from sc_kpi.metrics_values where metric_id=100002014  and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1)x order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "ELIGIBLE MEMBERS BY AGE",
        "visulization_type": "Bar Chart",
        "placeholder_name": "eligibile_members_by_age",
        "style": "",
        "category": "chart",
        "data_query": "select dims,round((metric_value/total_sum)*100,1) || '%'  as PCT from (select dims,metric_value,sum(metric_value) over(partition by entity,to_char(reporting_end_period,'yyyy-mm') order by to_char(reporting_end_period,'yyyy-mm'))Total_Sum from sc_kpi.metrics_values where metric_id=100002012 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1)x order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Demographics and Data Quality",
        "visualization_name": "ELIGIBLE MEMBERS BY LOCATION",
        "visulization_type": "Map",
        "placeholder_name": "eligible_member_by_location",
        "style": "",
        "category": "map",
        "data_query": "select DISTINCT   month_ending,REPORTGROUPNAME AS ENTITY,CITY,STATE,LATITUDE,LONGITUDE,MAP_CNT FROM SC_KPI.IPR_MAP_ELIGIBLES A WHERE STATE IN ('AL','AR','AZ','CA','CO','CT','DC','DE','FL','GA','IA','ID','IL','IN','KS','KY','LA','MA','MD','ME','MI','MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM','NV','NY','OH','OK','OR','PA','RI','SC','SD','TN','TX','UT','VA','VT','WA','WI','WV','WY') and REPORTGROUPNAME= :entity and month_ending= :month_ending;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Registration Rate",
        "visulization_type": "KPI",
        "placeholder_name": "regn_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast( round((( select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) /( select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ))*100,1)  as decimal(6,1) )|| '%' as 'Registration Rate (Since Launch)';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Current Calendar Year RealAge Test Completion Rate (of Registered)",
        "visulization_type": "KPI",
        "placeholder_name": "realage_regd_2",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast( round((( select metric_value from sc_kpi.metrics_values where metric_id=100002017 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) /( select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ))*100,1)  as decimal(6,1) ) || '%' as 'RealAge Test Completion Rate Current Cal Year (of Registered)';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Current Calendar Year RealAge Test Completion Rate (of Eligible)",
        "visulization_type": "KPI",
        "placeholder_name": "realage_eligible",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast( round((( select metric_value from sc_kpi.metrics_values where metric_id=100002017 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) /( select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ))*100,1)  as decimal(6,1) ) || '%' as 'RealAge Test Completion Rate Current Cal Year (of Elig)';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "RealAge Test Completion Rate (of Registered)",
        "visulization_type": "KPI",
        "placeholder_name": "realage_regd",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast( round((( select metric_value from sc_kpi.metrics_values where metric_id=1000020 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) /( select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ))  *100,1)  as decimal(6,1) ) || '%' as 'RealAge Test Completion Rate Since Launch (of Registered)';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Registered Members",
        "visulization_type": "KPI",
        "placeholder_name": "regd_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Distinct RealAge Test Completers",
        "visulization_type": "KPI",
        "placeholder_name": "distinct_test_completers",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value  from sc_kpi.metrics_values where metric_id=1000020 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Distinct RealAge Test Completers(Current Year)",
        "visulization_type": "KPI",
        "placeholder_name": "distinct_test_completers_curr_year",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value  from sc_kpi.metrics_values where metric_id=100002017 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Registration CQ VS PQ",
        "visulization_type": "KPI",
        "placeholder_name": "current_q_vs_prior_q_regn",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((( ( (select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(to_date(:month_ending,'yyyy-mm-dd'),'yyyy-mm')) / (select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(to_date(:month_ending,'yyyy-mm-dd'),'yyyy-mm'))) - ( (select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm')) / (select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm')))) /  ( (select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm')) / (select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm'))) )*100,1) ||'%' as 'Registration CQ VS PQ';",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Registration and RealAge Test Completion",
        "visualization_name": "Eligible/REG/RealAge Completers by Month",
        "visulization_type": "Combo Chart",
        "placeholder_name": "eligibility_and_regn",
        "style": "",
        "category": "chart",
        "data_query": "select elig.month_ending,elig.metric_value::int elig,cast( round((reg.metric_value/elig.metric_value)*100,1)  as decimal(6,1) ) || '%' reg_pct, cast( round((tc.metric_value/reg.metric_value)*100,1) as decimal(6,1) ) || '%' tc_pct from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,metric_value from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003 )elig left join ( select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,metric_value from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id=100007 ) reg on (elig.month_ending = reg.month_ending and elig.entity = reg.entity) left join ( select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,metric_value from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id=1000017 ) tc on (elig.month_ending = tc.month_ending and elig.entity = tc.entity) order by 1;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": ""
    },
    {
        "slide_title": "Registration and RealAge Completion by Group",
        "visualization_name": "RELATIONSHIP",
        "visulization_type": "Combo Chart",
        "placeholder_name": "relationship",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.entity,elig.dims,elig_metric_value,round((reg_metric_value/elig_metric_value)*100,2) ||'%' as reg_pct,round((rat_metric_value/elig_metric_value)*100,2) ||'%' rat_pct, (case when elig.dims = 'Employee' then 1 when elig.dims = 'Spouse' then 2 else 3 end) sort from (select distinct entity,dims,to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value elig_metric_value from sc_kpi.metrics_values where metric_id=100002050 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) elig left join (select distinct entity,dims, to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value reg_metric_value from sc_kpi.metrics_values where metric_id=100002024 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) reg on (elig.dims = reg.dims and elig.month_ending = reg.month_ending and elig.entity = reg.entity) left join (select distinct entity,dims,to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value rat_metric_value from sc_kpi.metrics_values where metric_id=100002018 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) rat on (elig.dims = rat.dims and elig.month_ending = rat.month_ending and elig.entity = rat.entity) order by 6;",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "col_drop:entity, sort"
    },
    {
        "slide_title": "Registration and RealAge Completion by Group",
        "visualization_name": "GENDER",
        "visulization_type": "Combo Chart",
        "placeholder_name": "gender",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.entity,elig.dims,elig_metric_value,round((reg_metric_value/elig_metric_value)*100,2) ||'%' as reg_pct,round((rat_metric_value/elig_metric_value)*100,2) ||'%' rat_pct, (case when elig.dims = 'Male' then 1 when elig.dims = 'Female' then 2 else 3 end) sort from (select distinct entity,dims, to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value elig_metric_value from sc_kpi.metrics_values where metric_id=100002014 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) elig left join (select distinct entity,dims,to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value reg_metric_value from sc_kpi.metrics_values where metric_id=100002025 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) reg on (elig.dims = reg.dims and elig.month_ending = reg.month_ending and elig.entity = reg.entity) left join (select distinct entity,dims,to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value rat_metric_value from sc_kpi.metrics_values where metric_id=100002019 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) rat on (elig.dims = rat.dims and elig.month_ending = rat.month_ending and elig.entity = rat.entity) order by 2",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "col_drop:entity, sort"
    },
    {
        "slide_title": "Registration and RealAge Completion by Group",
        "visualization_name": "AGE GROUPS",
        "visulization_type": "Combo Chart",
        "placeholder_name": "age_groups",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.entity,elig.dims,elig_metric_value,round((reg_metric_value/elig_metric_value)*100,2) ||'%' as reg_pct,round((rat_metric_value/elig_metric_value)*100,2) ||'%' rat_pct from (select distinct entity,dims,to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value elig_metric_value from sc_kpi.metrics_values where metric_id=100002012 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') =:month_ending ) elig left join (select distinct entity,dims,to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value reg_metric_value from sc_kpi.metrics_values where metric_id=100002026 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) reg on (elig.dims = reg.dims and elig.month_ending = reg.month_ending and elig.entity = reg.entity) left join (select distinct entity,dims,to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value rat_metric_value from sc_kpi.metrics_values where metric_id=100002020 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) rat on (elig.dims = rat.dims and elig.month_ending = rat.month_ending and elig.entity = rat.entity) order by 2; ",
        "section_name": "ELIGIBILITY AND REGISTRATION",
        "transformation_rule": "col_drop:entity"
    },
    {
        "slide_title": "RealAge Results",
        "visualization_name": "AVERAGE REALAGE DELTA",
        "visulization_type": "KPI",
        "placeholder_name": "avg_realage_delta",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select distinct  round(metric_value,1) as 'Average RealAge Delta' from sc_kpi.metrics_values where metric_id=100002022 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": " "
    },
    {
        "slide_title": "RealAge Results",
        "visualization_name": "MEMBERS WITH REALAGE DELTA>1.0",
        "visulization_type": "KPI",
        "placeholder_name": "members_with_realage_delta",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select distinct  round((sum(case when dims IN ('GT 5', '1.1 to 2.9', '3 to 5') then metric_value else null end)/sum(metric_value))*100,1)||'%' as 'RealAge Delta GT1' from sc_kpi.metrics_values where metric_id=100002021 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "RealAge Results",
        "visualization_name": "DISTINCT REALAGE TEST COMPLETERS",
        "visulization_type": "KPI",
        "placeholder_name": "distinct_realage_test_completers",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=1000020 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Risk Analysis Summary1",
        "visualization_name": "OVERALL RISK SEGMENTATION",
        "visulization_type": "Table",
        "placeholder_name": "overall_risk_segmentation",
        "style": "",
        "category": "table",
        "data_query": "select distinct dims, cast ( round((SUM(case when entity= 8500001 and to_char(reporting_end_period,'yyyy-mm')=:month_ending  then metric_value end) over(partition by dims) / SUM(case when entity= 8500001 and to_char(reporting_end_period,'yyyy-mm')=:month_ending then metric_value end) over())*100,1) as decimal(6, 1) ) || '%' as 'Book of Business', cast ( round((SUM(case when entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending   then metric_value end) over(partition by dims) / SUM(case when entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending   then metric_value end) over())*100,1) as decimal(6, 1) ) || '%' as 'Client' from sc_kpi.metrics_values where metric_id=100002047 and to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Analysis Summary1",
        "visualization_name": "LIFESTYLE RISK SEGMENTATION",
        "visulization_type": "Table",
        "placeholder_name": "lifestyle_risk_table",
        "style": "",
        "category": "table",
        "data_query": "select distinct * from ( select distinct dims , cast (round( (SUM(case when entity= 8500001 and to_char(reporting_end_period,'yyyy-mm')  =:month_ending   and metric_id=100002048 then metric_value end) over(partition by dims) /SUM(case when entity= 8500001 and to_char(reporting_end_period,'yyyy-mm')=:month_ending   and metric_id=1000020 then metric_value end) over() )*100,1) as decimal(6, 1) ) || '%' as 'Book of Business', cast ( round( (SUM(case when entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending   and metric_id=100002048 then metric_value end) over(partition by dims) /SUM(case when entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending   and metric_id=1000020 then metric_value end) over() )*100,1) as decimal(6, 1) ) || '%' as 'Client' from sc_kpi.metrics_values where metric_id in (100002048,1000020) and to_char(reporting_end_period,'yyyy-mm')=:month_ending   )xx where nullif(dims,'') is not null order by 1;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Analysis Summary1",
        "visualization_name": "PRECONDITION RISK SEGMENTATION",
        "visulization_type": "Table",
        "placeholder_name": "precondition_risk",
        "style": "",
        "category": "table",
        "data_query": "select distinct * from ( select distinct dims , cast( round( (SUM(case when entity= 8500001 and to_char(reporting_end_period,'yyyy-mm')=:month_ending  and metric_id=100002049 then metric_value end) over(partition by dims) /SUM(case when entity= 8500001 and to_char(reporting_end_period,'yyyy-mm')=:month_ending  and metric_id=1000020 then metric_value end) over() )*100,1) as decimal(6, 1) ) || '%' as 'Book of Business', cast ( round( (SUM(case when entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  and metric_id=100002049 then metric_value end) over(partition by dims) /SUM(case when entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  and metric_id=1000020 then metric_value end) over() )*100,1) as decimal(6, 1) ) || '%' as 'Client' from sc_kpi.metrics_values where metric_id in (100002049,1000020) and to_char(reporting_end_period,'yyyy-mm')=:month_ending  )xx where nullif(dims,'') is not null order by 1;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Analysis Summary1",
        "visualization_name": "CONDITION RISK SEGMENTATION",
        "visulization_type": "Table",
        "placeholder_name": "condition_risk",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT dims, Book_of_Business AS 'Book of Business', client , upper(dims) upper_dims FROM ( SELECT DISTINCT dims , CAST ( ROUND( (SUM( CASE WHEN entity= 8500001 AND to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND metric_id=100002051 THEN metric_value END) OVER( PARTITION BY dims) /SUM( CASE WHEN entity= 8500001 AND to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND metric_id=1000020 THEN metric_value END) OVER() )*100,1) AS DECIMAL(6,1 ) ) || '%' AS Book_of_Business, CAST ( ROUND( (SUM( CASE WHEN entity=:entity AND to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND metric_id=100002051 THEN metric_value END) OVER( PARTITION BY dims) /SUM( CASE WHEN entity=:entity AND to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND metric_id=1000020 THEN metric_value END) OVER() )*100,1) AS DECIMAL(6,1 ) ) || '%' AS 'Client' FROM sc_kpi.metrics_values WHERE metric_id in (100002051,1000020) AND to_char(reporting_end_period,'yyyy-mm')=:month_ending  )xx WHERE nullif(dims,'') IS NOT NULL ORDER BY upper_dims ;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "col_drop:upper_dims"
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "eligible_members_biometric",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "SCREENING PARTICIPANTS",
        "visulization_type": "KPI",
        "placeholder_name": "screening_participants",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100002071 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "PARTICIPATION RATE",
        "visulization_type": "KPI",
        "placeholder_name": "participation_rate_biometric",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum((case when metric_id=100002071 then metric_value else null end))/ sum((case when metric_id=100003 then metric_value else null end)))*100,1)||'%' from sc_kpi.metrics_values where metric_id in (100003,100002071) and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "PARTICIPANTS BY GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "ptpn_by_gender_bio",
        "style": "",
        "category": "chart",
        "data_query": "select dims,round((metric_value/sum(metric_value) over(partition by entity))*100,1)||'%' gender_pct from sc_kpi.metrics_values where metric_id in (100002072) and to_char(reporting_end_period,'yyyy-mm')=:month_ending  and entity=:entity order by 1;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Biometric/Clinical Screening Participation",
        "visualization_name": "CUMULATIVE BIOMETRIC COMPLETIONS BY MONTH",
        "visulization_type": "Line Chart",
        "placeholder_name": "cumulative_biometric_completion_by_month",
        "style": "",
        "category": "chart",
        "data_query": "select month_ending,dims,metric_value from ( SELECT DISTINCT to_char(to_date(to_char(reporting_end_period,'yyyy-mm'),'yyyy-mm-dd'),'Month') month_ending, to_char(to_date(to_char(reporting_end_period,'yyyy-mm'),'yyyy-mm-dd'),'yyyy-mm') month_ending2, CASE WHEN SUBSTRING(:month_ending,1,4)=SUBSTRING(to_char(reporting_end_period,'yyyy-mm'),1,4) THEN 'CY' WHEN SUBSTRING(to_char(reporting_end_period,'yyyy-mm'),1,4) < SUBSTRING(:month_ending,1,4) THEN 'PY' END dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100002073) AND entity=:entity AND CASE WHEN TO_CHAR(SYSDATE::Date,'mm') = 01 THEN to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(TRUNC(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14 ),'yy'),'yyyy-mm') AND :month_ending WHEN TO_CHAR(SYSDATE::Date,'mm') <> 01 THEN to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(TRUNC(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14 ),'yy'),'yyyy-mm') AND :month_ending END ) dd ORDER BY month_ending2;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "pivot:cum_biometric_by_month"
    },
    {
        "slide_title": "Biometric/Clinical Screening Results",
        "visualization_name": "MEMBERS WITH 1+ RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "members_with_1+_risks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(member_pct)||'%' as 'Member with 1+ Risks' from ( select dims,round((metric_value/sum(metric_value)over())*100,5) member_pct from sc_kpi.metrics_values where metric_id in (100002077) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where dims IN ('1','2','3', '4+');",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Biometric/Clinical Screening Results",
        "visualization_name": "MEMBERS WITH 3+ RISKS",
        "visulization_type": "KPI",
        "placeholder_name": "members_3+_risks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(member_pct)||'%' as 'Member with 3+ Risks' from ( select dims,round((metric_value/sum(metric_value)over())*100,5) member_pct from sc_kpi.metrics_values where metric_id in (100002077) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where dims IN ('3', '4+');",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Biometric/Clinical Screening Results",
        "visualization_name": "RISKS PER MEMBER",
        "visulization_type": "Bar Chart",
        "placeholder_name": "risks_per_members",
        "style": "",
        "category": "chart",
        "data_query": "select dims,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%' as 'Member PCT' from sc_kpi.metrics_values where metric_id in (100002077) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Biometric/Clinical Screening Results",
        "visualization_name": "BIOMETRIC RISK FACTORS",
        "visulization_type": "Stacked Bar Chart",
        "placeholder_name": "biometric_risk_factors",
        "style": "",
        "category": "chart",
        "data_query": "SELECT * FROM ( SELECT DISTINCT split_part(dims,'||',1)test_name , split_part(dims,'||',2) risk_color , ROUND((metric_value/SUM(metric_value) OVER( PARTITION BY :entity, split_part(dims,'||',1)))*100,1) ||'%' member_risk FROM sc_kpi.metrics_values WHERE metric_id in (100002074) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) x WHERE member_risk IS NOT NULL and test_name NOT IN ('Glucose (Non Fasting)') ORDER BY ( CASE WHEN test_name IN ('A1C') THEN 1 WHEN test_name IN ('Blood Pressure - Diastolic (Lower)') THEN 2 WHEN test_name IN ('Blood Pressure - Systolic (Upper)') THEN 3 WHEN test_name IN ('BMI (Body Mass Index)') THEN 4 WHEN test_name IN ('Cholesterol - HDL (Good)') THEN 5 WHEN test_name IN ('Cholesterol - LDL (Bad)') THEN 6 WHEN test_name IN ('Cholesterol - Total') THEN 7 WHEN test_name IN ('Glucose (Fasting)') THEN 8 WHEN test_name IN ('Glucose (Non Fasting)') THEN 9 WHEN test_name IN ('Total Cholesterol/HDL Ratio') THEN 10 WHEN test_name IN ('Triglycerides') THEN 11 WHEN test_name IN ('VLDL Cholesterol') THEN 12 ELSE 13 END), ( CASE WHEN risk_color = 'G' THEN 1 WHEN risk_color = 'Y' THEN 2 WHEN risk_color = 'R' THEN 3 ELSE 4 END );",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "pivot:get_bio_risk_pivot_df"
    },
    {
        "slide_title": "RealAge Results",
        "visualization_name": "REALAGE DELTA DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "realage_delta_dist",
        "style": "",
        "category": "chart",
        "data_query": "select distinct  dims,round((metric_value/SUM(metric_value) over ())*100,1)||'%' as 'RealAge Delta', case when dims IN ('LT -5') then 1 when dims IN ('-4.9 to -3') then 2 when dims IN ('-2.9 to -1') then 3 when dims IN ('-.9 to 1') then 4 when dims IN ('1.1 to 2.9') then 5 when dims IN ('3 to 5') then 6 when dims IN ('GT 5') then 7 end sort_order from sc_kpi.metrics_values where metric_id=100002021 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 3;",
        "section_name": "HEALTH INSIGHTS",
        "transformation_rule": "col_drop:sort_order"
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc monthly users siteonly",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_monthly_users_siteonly",
        "data_query": "select round(metric_value*100,1)::NUMERIC(5,1) || '%' as 'AVERAGE MONTHLY ACTIVE USER' from sc_kpi.metrics_values where metric_id=10000104 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc monthly users siteemail",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_monthly_users_siteemail",
        "data_query": "select round(metric_value*100,1)::NUMERIC(5,1) || '%' as 'AVERAGE MONTHLY ACTIVE USER' from sc_kpi.metrics_values where metric_id=10000105 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc curr quat engagement",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_curr_quat_engagement",
        "data_query": "select round(metric_value*100,1)::NUMERIC(5,1) || '%' as 'CURRENT QUARTER ENGAGEMENT' from sc_kpi.metrics_values where metric_id=10000103 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc active users post regn",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_active_users_post_regn",
        "data_query": "select dims as 'Activity Groups', round(metric_value*100,1) || '%' as '% Active Users - Rolling' from sc_kpi.metrics_values where metric_id=1000035 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc monthly active users",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_monthly_active_users",
        "data_query": "select month_ending,round(metric_value*100,1) || '%' as 'Mau Calendar Month' from sc_kpi.metrics_values where metric_id=10000101 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc device usage quarterly",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_device_usage_quarterly",
        "data_query": "select dims,(metric_value/sum(metric_value)over(partition by :entity)) as 'DEVICE TYPE' from sc_kpi.metrics_values where metric_id=1000029 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by case when dims = 'Web' then 1 when dims = 'iOS' then 2 when dims = 'Android' then 3 else 4 end;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Overall Platform Activity",
        "visualization_name": "sc device usage",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_device_usage",
        "data_query": "select dims,(metric_value/sum(metric_value)over(partition by :entity)) as 'DEVICE TYPE' from sc_kpi.metrics_values where metric_id=1000026 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by case when dims = 'Web' then 1 when dims = 'iOS' then 2 when dims = 'Android' then 3 else 4 end;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Feature Utilization",
        "visualization_name": "ALL TIME DiGITAL ENGAGEMENT TABLE",
        "visulization_type": "Table",
        "placeholder_name": "digital_engagement_table",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT dims, Total_Visitor, Unique_Visitor, Page_View_per_Visit, Average_Time_Spent_Minutes FROM ( SELECT dims, Total_Visitor, Unique_Visitor, Page_View_per_Visit, Average_Time_Spent_Minutes, row_number() over(ORDER BY Unique_Visitor DESC) row_num FROM ( SELECT dims, SUM( CASE WHEN metric_id=100002081 THEN metric_value ELSE NULL END) AS Total_Visitor , SUM( CASE WHEN metric_id=100003007 THEN metric_value ELSE NULL END) AS Unique_Visitor , CAST ( ROUND(SUM( CASE WHEN metric_id=100002083 THEN metric_value ELSE NULL END)/SUM( CASE WHEN metric_id=100002081 THEN metric_value ELSE NULL END),1) AS DECIMAL(6,1 ) ) AS Page_View_per_Visit , CAST ( ROUND((SUM( CASE WHEN metric_id=100002082 THEN metric_value ELSE NULL END)/SUM( CASE WHEN metric_id=100002081 THEN metric_value ELSE NULL END))/60,1) AS DECIMAL(6,1 ) ) AS Average_Time_Spent_Minutes FROM sc_kpi.metrics_values WHERE metric_id in (100003007,100002081,100002082,100002083) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  GROUP BY 1 ORDER BY 2 DESC ) jj WHERE Unique_Visitor IS NOT NULL ) jj1 WHERE row_num <= 12 ORDER BY 3 DESC, dims ;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Feature Utilization",
        "visualization_name": "ALL TIME UNIQUE VISITORS BY PLATFORM FEATURE",
        "visulization_type": "Bar Chart",
        "placeholder_name": "unique_visitors",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT dims, metric_value FROM ( SELECT DISTINCT dims, metric_value, row_number() over(ORDER BY metric_value DESC) row_num FROM ( SELECT CASE WHEN dims = 'Covid-19 Care Center' THEN 'Cov19 CC' WHEN dims = 'Health Profile' THEN 'HlthProf' WHEN dims = 'Incentive' THEN 'Inmetric_value' WHEN dims = 'Inspirations' THEN 'Insp' WHEN dims = 'Medication Prices' THEN 'Med Pric' WHEN dims = 'Medications' THEN 'Medcatns' WHEN dims = 'Realage Tips' THEN 'RA Tips' WHEN dims = 'Relax 360' THEN 'Rlx-360' ELSE dims END dims , metric_value AS 'metric_value' FROM sc_kpi.metrics_values WHERE metric_id in (100003007) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ORDER BY 2 DESC )jj WHERE metric_value IS NOT NULL )jj2 WHERE row_num<= 12 ORDER BY 2 DESC, 1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Feature Utilization",
        "visualization_name": "CURRENT DiGITAL ENGAGEMENT TABLE",
        "visulization_type": "Table",
        "placeholder_name": "curr_qtr_digital_engagement_table",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT dims, Total_Visitor, Unique_Visitor, Page_View_per_Visit, Average_Time_Spent_Minutes FROM ( SELECT dims, Total_Visitor, Unique_Visitor, Page_View_per_Visit, Average_Time_Spent_Minutes, row_number() OVER(ORDER BY Unique_Visitor DESC) row_num FROM ( SELECT dims, SUM( CASE WHEN metric_id=100002210 THEN metric_value ELSE NULL END) AS Total_Visitor , SUM( CASE WHEN metric_id=100002207 THEN metric_value ELSE NULL END) AS Unique_Visitor , CAST ( ROUND(SUM( CASE WHEN metric_id=100002209 THEN metric_value ELSE NULL END)/SUM( CASE WHEN metric_id=100002210 THEN metric_value ELSE NULL END),1) AS DECIMAL(6,1 ) ) AS Page_View_per_Visit , CAST ( ROUND((SUM( CASE WHEN metric_id=100002208 THEN metric_value ELSE NULL END)/SUM( CASE WHEN metric_id=100002210 THEN metric_value ELSE NULL END))/60,1) AS DECIMAL(6,1 ) ) AS Average_Time_Spent_Minutes FROM sc_kpi.metrics_values WHERE metric_id in (100002207,100002208 ,100002209 , 100002210) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND UPPER(dims) <> 'FAD' GROUP BY 1 ORDER BY 2 DESC ) jj WHERE Unique_Visitor IS NOT NULL ) jj1 WHERE row_num <= 12 ORDER BY 3 DESC ,1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": ""
    },
    {
        "slide_title": "Feature Utilization",
        "visualization_name": "CURRENT UNIQUE VISITORS BY PLATFORM FEATURE",
        "visulization_type": "Bar Chart",
        "placeholder_name": "current_qtr_unique_visitors",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT dims, metric_value FROM ( SELECT DISTINCT dims, metric_value, row_number() over(ORDER BY metric_value DESC)row_num FROM ( SELECT CASE WHEN dims = 'Covid-19 Care Center' THEN 'Cov19 CC' WHEN dims = 'Health Profile' THEN 'HlthProf' WHEN dims = 'Incentive' THEN 'Inmetric_value' WHEN dims = 'Inspirations' THEN 'Insp' WHEN dims = 'Medication Prices' THEN 'Med Pric' WHEN dims = 'Medications' THEN 'Medcatns' WHEN dims = 'Realage Tips' THEN 'RA Tips' WHEN dims = 'Relax 360' THEN 'Rlx-360' ELSE dims END dims , metric_value AS 'metric_value' FROM sc_kpi.metrics_values WHERE metric_id in (100002207) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND UPPER(dims) <> 'FAD' ORDER BY 1 )jj WHERE metric_value IS NOT NULL ) jj1 WHERE row_num <= 12 ORDER BY 2 DESC,1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Content Consumption1",
        "visualization_name": "TOTAL CONTENT VISITS",
        "visulization_type": "KPI",
        "placeholder_name": "total_content_clicks",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value as 'Total Content Clicks' from sc_kpi.metrics_values where metric_id=100002028  and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Content Consumption1",
        "visualization_name": "CONTENT VISITS PER CONTENT VISITORS",
        "visulization_type": "KPI",
        "placeholder_name": "content_clicks_per_user",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum((case when metric_id=100002028 then metric_value else null end))/ sum((case when metric_id=100002078 then metric_value else null end)),1) from sc_kpi.metrics_values where metric_id in (100002028,100002078) and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Content Consumption1",
        "visualization_name": "CONTENT DETAILS TABLE",
        "visulization_type": "Table",
        "placeholder_name": "content_details_table",
        "style": "",
        "category": "table",
        "data_query": "SELECT dims, metric_value AS 'Content Visits', cast (ROUND((metric_value/SUM(metric_value) over(partition BY :entity))*100,1) as decimal(6,1) ) ||'%' AS 'Content Visits % of Total' FROM sc_kpi.metrics_values WHERE metric_id=100002030 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND dims IN ( SELECT DISTINCT dims FROM ( SELECT dims, metric_value, row_number() over(ORDER BY metric_value DESC) row_number FROM sc_kpi.metrics_values WHERE metric_id=100002030 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending ) xx WHERE row_number <= 15) ORDER BY 2 DESC;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "GREEN DAYS EARNED",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "KPI",
        "placeholder_name": "sc_green_days_earned",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100002031 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green days learned current quarter",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "KPI",
        "placeholder_name": "sc_green_days_learned_current_quarter",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100002500 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green day QoQ change",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_green_day_QoQ_change",
        "data_query": "select case when (metric_value_prev_quarter = 0 or (metric_value_prev_quarter = 0 and metric_value_current_quarter = 0 ) or (to_number(left(:month_ending,4))-to_number(left(min_month,4)))*12+to_number(right(:month_ending,2))-to_number(right(min_month,2))<5) then 'N/A' when metric_value_prev_quarter != 0 then cast ( ( ( ( metric_value_current_quarter - metric_value_prev_quarter) / metric_value_prev_quarter) * 100 )::CHAR(5) as decimal(6,1) ) || '%' end QOQ_change from ( ( select entity, nvl(metric_value, 0) metric_value_current_quarter from sc_kpi.metrics_values where metric_id=100002500 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ) A join ( select entity, nvl(metric_value, 0) metric_value_prev_quarter from sc_kpi.metrics_values where metric_id=100002500 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') = (to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-3),'yyyy-mm') ) ) B on a.entity = b.entity join ( select entity, min(case when metric_value > 0 then to_char(reporting_end_period,'yyyy-mm') end) min_month from sc_kpi.metrics_values where metric_id=100007 and entity=:entity group by 1 ) c on a.entity = c.entity ) x;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green day YoY change",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_green_day_YoY_change",
        "data_query": "select case when (metric_value_prev_year = 0 or (metric_value_prev_year = 0 and metric_value_current_year = 0 ) or (to_number(left(:month_ending,4))-to_number(left(min_month,4)))*12+to_number(right(:month_ending,2))-to_number(right(min_month,2))<14) then 'N/A' when metric_value_prev_year != 0 then cast ( ( ( ( metric_value_current_year - metric_value_prev_year) / metric_value_prev_year) * 100 )::CHAR(5) as decimal(6,1) ) || '%' end YOY_change from ( ( select entity, nvl(metric_value, 0) metric_value_current_year from sc_kpi.metrics_values where metric_id=100002500 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ) A join ( select entity, nvl(metric_value, 0) metric_value_prev_year from sc_kpi.metrics_values where metric_id=100002500 and entity=:entity and month_ending = (to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-12),'yyyy-mm') ) ) B on a.entity = b.entity join ( select entity, min(case when metric_value > 0 then month_ending end) min_month from sc_kpi.metrics_values where metric_id=100007 and entity=:entity group by 1 ) c on a.entity = c.entity ) x;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc member with 1 plus green days",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_member_with_1_plus_green_days",
        "data_query": "select case when (reg_members = 0 or (reg_members = 0 and members_with_1_greendays = 0 ) ) then 'N/A' when reg_members != 0 then cast (( ( members_with_1_greendays / reg_members) * 100 )::CHAR(5) as decimal(6,1) ) || '%' end members_with_1_greendays_percent from ( ( select entity, nvl(metric_value, 0) members_with_1_greendays from sc_kpi.metrics_values where metric_id=100002032 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ) A join ( select entity, nvl(metric_value, 0) reg_members from sc_kpi.metrics_values where metric_id=100007 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ) B on a.entity = b.entity ) x;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green days earned chart",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "CHART",
        "placeholder_name": "sc_green_days_earned_chart",
        "data_query": "select distinct cal.month_ending,GD.metric_value GD,round(GD.metric_value / GDP.metric_value,0)as GD_per_user from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where metric_id=100003 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1) cal left join (select month_ending,entity,metric_value from sc_kpi.metrics_values where metric_id=100002033)GD on (cal.month_ending = GD.month_ending and cal.entity = GD.entity) left join (select month_ending,entity,metric_value from sc_kpi.metrics_values where metric_id=100002038)GDP on (cal.month_ending = GDP.month_ending and cal.entity = GDP.entity) order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green days automatic vs manual tracking by members",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "CHART",
        "placeholder_name": "sc_green_days_automatic_vs_manual_tracking_by_members",
        "data_query": "select dims,round((metric_value/sum(metric_value) over(partition by entity))*100,1)||'%' greenday_tracker_pct from sc_kpi.metrics_values where metric_id in (100002504) and to_char(reporting_end_period,'yyyy-mm')=:month_ending  and entity=:entity order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Green Day Tracking",
        "visualization_name": "sc green day auto tracking channel distribution",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "CHART",
        "placeholder_name": "sc_green_day_auto_tracking_channel_distribution",
        "data_query": "select dims, cast ((metric_value/sum_metric_value) as decimal(6,3) ) || '%' from ( select entity, month_ending, dims ,metric_value from sc_kpi.metrics_values where metric_id in (100002505) and to_char(reporting_end_period,'yyyy-mm')=:month_ending   and entity=:entity ) A join ( select entity, month_ending, sum(metric_value) sum_metric_value from sc_kpi.metrics_values where metric_id in (100002505) and to_char(reporting_end_period,'yyyy-mm')=:month_ending   and entity=:entity group by 1,2 )B on A.entity = B.entity and a.month_ending = B.month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "INCENTIVE ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "incentive_eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100002091 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ; ",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "UNIQUE INCENTIVE EARNERS",
        "visulization_type": "KPI",
        "placeholder_name": "unique_incentive_earners",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100002092 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ; ",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "INCENTIVE PARTICIPATION RATE",
        "visulization_type": "KPI",
        "placeholder_name": "incentive_ptpn_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select distinct round((incentearn.metric_value/incentelig.metric_value)*100,1) || '%' incent_participation_rate from (select to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity,metric_value from sc_kpi.metrics_values where metric_id=100002091 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )incentelig left join (select to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity,metric_value from sc_kpi.metrics_values where metric_id=100002092 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) incentearn on (incentelig.month_ending = incentearn.month_ending and incentelig.entity = incentearn.entity)",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "INCENTIVE EARNERS PER MONTH",
        "visulization_type": "Bar Chart",
        "placeholder_name": "incentive_earners_per_month",
        "style": "",
        "category": "chart",
        "data_query": "select to_char(reporting_end_period,'yyyy-mm') month_ending,metric_value from sc_kpi.metrics_values where metric_id=100002069 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') between to_char(trunc(to_date(:month_ending,'yyyy-mm-dd'),'yyyy'),'yyyy-mm') and :month_ending order by 1;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "Incentive Earning (Current Year)",
        "visualization_name": "TOP 5 INCENTIVE GROUPS EARNERS (TOP 3 ACTIVITES IN EACH GROUPS)",
        "visulization_type": "Table",
        "placeholder_name": "top_5_incentive_groups",
        "style": "",
        "category": "table",
        "data_query": "select split_part(dims,'||',1)incentive_groups,split_part(dims,'||',2)incentive_desc,metric_value from sc_kpi.metrics_values where metric_id=100002070 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1,3 desc;",
        "section_name": "DIGITAL ENGAGEMENT",
        "transformation_rule": " "
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "TARGETED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "targeted_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100003001 and entity=:entity and lower(dims) IN ('targeted') and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100003001 and entity=:entity and lower(dims) IN ('enrolled')  and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when lower(dims) IN ('enrolled') then metric_value else null end)/sum(case when lower(dims) IN ('targeted') then metric_value else null end))*100,1) || '%' enrollment_rate from sc_kpi.metrics_values where metric_id=100003001 and entity=:entity and   to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "ENCOUTERS PER ENROLLED MEMBER",
        "visulization_type": "KPI",
        "placeholder_name": "encounters_per_enrolled_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(metric_value,1) as encounter_per_enrolled_member from sc_kpi.metrics_values where metric_id=100003002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "ENROLLEES PER MONTH",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrollees_per_month",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,lm.encounter_per_enrolled_member from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003 )elig left join (select month_ending,entity,metric_value as encounter_per_enrolled_member from sc_kpi.metrics_values where metric_id=100003003 and entity=:entity) lm on (elig.month_ending = lm.month_ending and elig.entity = lm.entity) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "PARTICIPATION FUNNEL",
        "visulization_type": "Funnel",
        "placeholder_name": "ptpn_funnel_high_touch",
        "style": "",
        "category": "funnel",
        "data_query": "select dims,metric_value from sc_kpi.metrics_values where metric_id=100003001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by case when dims IN ('Targeted') then 1 when dims IN ('Callable') then 2 when dims IN ('Attempted') then 3 when dims IN ('Enrolled') then 4 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "funnel_1"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "sc enrolled members by age chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_enrolled_members_by_age_chart",
        "data_query": "select split_part(dims,'||',2), metric_value as enrolled_member_by_age from sc_kpi.metrics_values where metric_id=100003023 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "sc enrolled members by relationship chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_enrolled_members_by_relationship_chart",
        "data_query": "select dims, enrolled_member_by_relationship from ( Select split_part(dims,'||',2) dims , metric_value as enrolled_member_by_relationship from sc_kpi.metrics_values where metric_id=100003021 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ) D order by case when dims = 'Employee' then 1 when dims = 'Spouse' then 2 when dims = 'Other' then 3 end;",
        "category": "chart",
        "style": "",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation",
        "visualization_name": "sc enrolled members by gender chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Pie Chart",
        "placeholder_name": "sc_enrolled_members_by_gender_chart",
        "data_query": "Select split_part(dims,'||',2), round(metric_value/sum(metric_value) over (partition by entity),2) as enrolled_member_by_gender from sc_kpi.metrics_values where metric_id=100003022 and metric_value is not null and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc total coaching interactions",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_total_coaching_interactions",
        "data_query": "Select cast( round(metric_value, 1) as decimal(8,0)) as total_coaching_interations from sc_kpi.metrics_values where metric_id=100003041 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending    order by 1;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc coaching calls",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_coaching_calls",
        "data_query": "Select cast( round(metric_value, 1) as decimal(8,0))  as total_coaching_calls from sc_kpi.metrics_values where metric_id=100003042 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')   =:month_ending order by 1;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc chat messaging interactions",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_chat_messaging_interactions",
        "data_query": "select cast( round(metric_value, 1) as decimal(8,0)) as chat_messaging_interactions from sc_kpi.metrics_values where metric_id=100003043 and entity= :entity  and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc coaching calls per enrolled member",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_coaching_calls_per_enrolled_member",
        "data_query": "select round((select cast( round(metric_value, 1) as float) from sc_kpi.metrics_values where metric_id=100003042 and entity= :entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending  )/(select metric_value from sc_kpi.metrics_values where metric_id=100003001 and dims='Enrolled' and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ),1) as coaching_calls_per_enrolled_member;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc interactions by month and modality chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_interactions_by_month_and_modality_chart",
        "data_query": "select a.month_ending, sum(a.metric_value) as monthly_coaching_calls, sum(b.metric_value) as monthly_messaging_interactions from sc_kpi.metrics_values a join sc_kpi.metrics_values b on a.entity=b.entity and a.to_char(reporting_end_period,'yyyy-mm')=b.month_ending and b.metric_id=100003045 where a.metric_id=100003044 and a.entity= :entity and A.to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending group by 1 order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc coaching calls per enrolled members chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_coaching_calls_per_enrolled_members_chart",
        "data_query": "select dims, metric_value as coaching_calls_per_enrolled_member from sc_kpi.metrics_values where metric_id=100003048 and  entity= :entity  and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Lifestyle Management Participation  Engagement",
        "visualization_name": "sc top telephonic individual goals completed table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_telephonic_individual_goals_completed_table",
        "data_query": "select a.dims, sum(a.metric_value) as telephonic_goals_active, sum(b.metric_value) as telephonic_goals_completed from sc_kpi.metrics_values a join sc_kpi.metrics_values b on a.entity=b.entity and a.to_char(reporting_end_period,'yyyy-mm')=b.to_char(reporting_end_period,'yyyy-mm') and b.metric_id=100003047 and a.dims=b.dims where   a.metric_id=100003046 and a.entity= :entity and a.to_char(reporting_end_period,'yyyy-mm')=:month_ending  group by 1 order by 2 desc, 1 limit 5;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "TARGETED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "targeted_members_disease",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100003004 and entity=:entity and lower(dims) IN ('targeted') and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_disease",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100003004 and entity=:entity and lower(dims) IN ('enrolled') and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_disease",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when lower(dims) IN ('enrolled') then metric_value else null end)/sum(case when lower(dims) IN ('targeted') then metric_value else null end))*100,1) || '%' enrollment_rate from sc_kpi.metrics_values where metric_id=100003004 and entity=:entity and   to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "ENCOUTERS PER ENROLLED MEMBER",
        "visulization_type": "KPI",
        "placeholder_name": "encounters_per_enrolled_members_disease",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(metric_value,1) as encounter_per_enrolled_member from sc_kpi.metrics_values where metric_id=100003005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "ENROLLEES PER MONTH",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrollees_per_month_disease",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,dm.encounter_per_enrolled_member from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003 )elig left join (select month_ending,entity,metric_value as encounter_per_enrolled_member from sc_kpi.metrics_values where metric_id=100003006 and entity=:entity) dm on (elig.month_ending = dm.month_ending and elig.entity = dm.entity) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "High-Touch Disease Management Participation  Results",
        "visualization_name": "PARTICIPATION FUNNEL",
        "visulization_type": "Funnel",
        "placeholder_name": "ptpn_funnel_disease",
        "style": "",
        "category": "funnel",
        "data_query": "select dims,metric_value from sc_kpi.metrics_values where metric_id=100003004 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by case when dims IN ('Targeted') then 1 when dims IN ('Callable') then 2 when dims IN ('Attempted') then 3 when dims IN ('Enrolled') then 4 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "funnel_2"
    },
    {
        "slide_title": "Marketplace",
        "visualization_name": "CURRENT ENROLLMENTS IN MARKETPLACE",
        "visulization_type": "KPI",
        "placeholder_name": "current_enrollment",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(metric_value) total_enrollment from sc_kpi.metrics_values where metric_id=100005003 and split_part(dims,'||',2) = 'Enrollments' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending and  (split_part(dims,'||',1) IN ('Parenting Program', 'Unwinding Anxiety', 'Fertility Program', 'Type 2 Diabetes Management', 'Pregnancy Program', 'Financial Well-being', 'Scaleback', 'Tobacco Cessation', 'Muscle and Joint Health' , 'Diabetes Education' )) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Marketplace",
        "visualization_name": "MEMBERS ENROLLING IN 1+ PROGRAMS",
        "visulization_type": "KPI",
        "placeholder_name": "membes_1+_program",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(metric_value) members_enrolling_1plus_prog from sc_kpi.metrics_values where metric_id=100005042 and split_part(dims,'||',1) = 'Market Place' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Marketplace",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Stacked Bar Chart",
        "placeholder_name": "program_engagement_marketplace",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,elig.entity,split_part(enroll.dims,'||',1)program_name,enroll.metric_value enrolled_metric_value from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where metric_id=100003 and entity= :entity and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and month_ending >= '2020-01' order by 1) elig left join (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity) where (split_part(enroll.dims,'||',1) IN ('Parenting Program', 'Unwinding Anxiety', 'Fertility Program', 'Type 2 Diabetes Management', 'Pregnancy Program', 'Financial Well-being', 'Scaleback', 'Tobacco Cessation', 'Muscle and Joint Health', 'Diabetes Education' )) order by 1,3;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "pivot:get_program_engagemnt_df"
    },
    {
        "slide_title": "Marketplace",
        "visualization_name": "PARTICIPANT ACTIVITY",
        "visulization_type": "Table",
        "placeholder_name": "participant_activity_marketplace",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT lu.dims program_name, ppelig.metric_value ppelig_metric_value, ppeligreg.metric_value ppeligreg_metric_value, CASE WHEN enroll.metric_value > 1 THEN assess.metric_value ELSE NULL END assessment_starts , CASE WHEN enroll.metric_value > 1 THEN qual.metric_value ELSE NULL END qualified_metric_value , enroll.metric_value enroll_metric_value , CAST( ROUND((enroll.metric_value/ppeligreg.metric_value)*100,1) AS DECIMAL(6,1) )||'%' enroll_rate from ( select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,split_part(dims,'||',1)dims,entity from sc_kpi.metrics_values where metric_id in (100005001,100005003) AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) LU left join ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005001) AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) ppelig on (LU.month_ending = ppelig.month_ending and lu.entity = ppelig.entity and lu.dims = split_part(ppelig.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005002 AND entity= :entity) ppeligreg ON ( LU.month_ending = ppeligreg.month_ending AND LU.entity = ppeligreg.entity AND lu.dims = split_part(ppeligreg.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005003 AND entity= :entity) enroll ON ( LU.month_ending = enroll.month_ending AND LU.entity = enroll.entity AND lu.dims = split_part(enroll.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005008 AND entity= :entity) assess ON ( LU.month_ending = assess.month_ending AND LU.entity = assess.entity AND LU.dims = split_part(assess.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005010 AND entity= :entity) qual ON ( LU.month_ending = qual.month_ending AND LU.entity = qual.entity AND LU.dims = split_part(qual.dims,'||',1)) WHERE ( LU.dims IN ('Parenting Program', 'Unwinding Anxiety', 'Fertility Program', 'Type 2 Diabetes Management', 'Pregnancy Program', 'Financial Well-being', 'Scaleback', 'Tobacco Cessation', 'Muscle and Joint Health', 'Diabetes Education' )) and ( enroll.metric_value is not null or ppelig.metric_value is not null ) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_members_fert",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_regd_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_fertility",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_fert",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending and split_part(dims,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_enrollment_fertility",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,enroll.metric_value enrolled_metric_value,disenroll.metric_value disenrolled_metric_value from ( select distinct a.month_ending,a.entity,b.dims from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005006,100005007) and entity= :entity and split_part(dims,'||',1) = 'Fertility Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value::int from sc_kpi.metrics_values where metric_id=100005006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) left join (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value::int from sc_kpi.metrics_values where metric_id=100005007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrolled_members_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Fertility  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "assessment_results",
        "style": "",
        "category": "table",
        "data_query": "SELECT CASE WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 'Total Disenrollments' WHEN split_part(dims,'||',2) = 'Enrolled via another Ovia program' THEN '          Enrolled via another Ovia program' WHEN split_part(dims,'||',2) = 'Enrolled via qualification assessment' THEN '          Enrolled via qualification assessment' WHEN split_part(dims,'||',2) = 'Enrollments' THEN '     Net Enrollments' ELSE split_part(dims,'||',2) END dims, metric_value FROM ( SELECT DISTINCT dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005003,100005008,100005009,100005010,100005011,100005012,100005013,100005014,100005015,100005075,100005076) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND split_part(dims,'||',1) = 'Fertility Program' )x ORDER BY CASE WHEN split_part(dims,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dims,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dims,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dims,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dims,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dims,'||',2) = 'Enrollments' THEN 7 WHEN split_part(dims,'||',2) = 'Enrolled via another Ovia program' THEN 8 WHEN split_part(dims,'||',2) = 'Enrolled via qualification assessment' THEN 9 END ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005020 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Fertility Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Fertility Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_res_fertility",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, ts.metric_value total_session, avgs.metric_value avg_Session, ROUND ( CAST ( ROUND((ts.metric_value/avgs.metric_value),1) AS DECIMAL(6,1) ), 1) AS avg_session_per_users FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dims FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14 ),'yyyy-mm') AND :month_ending AND entity= :entity AND metric_id = 100003) a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity FROM sc_kpi.metrics_values WHERE metric_id in (100005021,100005022) AND entity= :entity AND split_part(dims,'||',1) = 'Fertility Program') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005021 AND entity= :entity) ts ON ( ts.month_ending = elig.month_ending AND ts.entity = elig.entity AND split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005022 AND entity= :entity) avgs ON ( elig.month_ending = avgs.month_ending AND elig.entity = avgs.entity AND split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "obj_to_float:avg_session_per_users"
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "participant_activity_fertility",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005023 and entity= :entity and split_part(dims,'||',1) = 'Fertility Program' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 5 order by 2 desc",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value  from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_regd_members_preg",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value  from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_pregnancy",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_pregnancy",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_enrollments_pregnancy",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, enroll.metric_value enrolled_metric_value, disenroll.metric_value disenrolled_metric_value FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dims FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending AND month_ending >= '2020-01' AND entity= :entity AND metric_id = 100003) a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity FROM sc_kpi.metrics_values WHERE metric_id in (100005006,100005007) AND entity= :entity AND split_part(dims,'||',1) = 'Pregnancy Program') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005006 AND entity= :entity) enroll ON ( elig.month_ending = enroll.month_ending AND elig.entity = enroll.entity AND split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005007 AND entity= :entity) disenroll ON ( elig.month_ending = disenroll.month_ending AND elig.entity = disenroll.entity AND split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "pregnency_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,3)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "assessment_results_preg",
        "style": "",
        "category": "table",
        "data_query": "SELECT CASE WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 'Total Disenrollments' WHEN split_part(dims,'||',2) = 'Enrolled via another Ovia program' THEN '          Enrolled via another Ovia program' WHEN split_part(dims,'||',2) = 'Enrolled via qualification assessment' THEN '          Enrolled via qualification assessment' WHEN split_part(dims,'||',2) = 'Enrollments' THEN '     Net Enrollments' ELSE split_part(dims,'||',2) END assessment, metric_value FROM ( SELECT DISTINCT dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005003,100005008,100005009,100005010,100005011,100005012,100005013,100005014,100005015,100005075,100005076) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND split_part(dims,'||',1) = 'Pregnancy Program' )x ORDER BY CASE WHEN split_part(dims,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dims,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dims,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dims,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dims,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dims,'||',2) = 'Enrollments' THEN 7 WHEN split_part(dims,'||',2) = 'Enrolled via another Ovia program' THEN 8 WHEN split_part(dims,'||',2) = 'Enrolled via qualification assessment' THEN 9 END ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Enrollment",
        "visualization_name": "GESTATIONAL AGE DISTRIBUTION(In Months)",
        "visulization_type": "Bar Chart",
        "placeholder_name": "gestational_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)grp,pct from ( select distinct dims,round((metric_value/sum(metric_value)over(partition by :entity))*100,3)||'%'pct from sc_kpi.metrics_values where metric_id in (100005016) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Pregnancy Program' )x order by case when split_part(dims,'||',2) = '1-3' then 1 when split_part(dims,'||',2) = '4-6' then 2 when split_part(dims,'||',2) = '7-9' then 3 when split_part(dims,'||',2) = '10+' then 4 end",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_preg",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005020 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Pregnancy Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions_preg",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct  to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm')  month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Pregnancy Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_res_pregnancy",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value::int total_session,avgs.metric_value::int avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm')  month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Pregnancy Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_pregnancy",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005023 and entity= :entity and split_part(dims,'||',1) = 'Pregnancy Program' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Engagement",
        "visualization_name": "CLINICAL PROGRAM (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "clinical_program_preg",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005026 and entity= :entity and split_part(dims,'||',1) = 'Pregnancy Program' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "HIGH RISK",
        "visulization_type": "KPI",
        "placeholder_name": "high_risk_preg",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005032 and split_part(dims,'||',1) = 'Pregnancy Program' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "BIRTHS REPORTED",
        "visulization_type": "KPI",
        "placeholder_name": "births_reported",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005033 and split_part(dims,'||',1) = 'Pregnancy Program' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "C-SECTION RATE",
        "visulization_type": "KPI",
        "placeholder_name": "c_section_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005034 and split_part(dims,'||',2) = 'C Section' then metric_value else null end) / sum(case when metric_id=100005033 then metric_value else null end))*100,1)||'%' c_section_rate from sc_kpi.metrics_values where metric_id in (100005033,100005034) and split_part(dims,'||',1) = 'Pregnancy Program' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "PRETERM DELIVERY",
        "visulization_type": "KPI",
        "placeholder_name": "preterm_delivery_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast( round((a.metric_value / b.metric_value)*100,1) as decimal(6,1) ) ||'%' from ( select entity , month_ending , metric_value from sc_kpi.metrics_values where metric_id in (100005035) and split_part(dims,'||',1) = 'Pregnancy Program' and split_part(dims,'||',2) = 'PreTerm' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ) A join ( select entity , month_ending , metric_value from sc_kpi.metrics_values where metric_id=100005033 and split_part(dims,'||',1) = 'Pregnancy Program' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ) B on a.entity = b.entity and a.month_ending = b.month_ending",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "ACTIVITY TRENDS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "activity_trends_pregnancy",
        "style": "",
        "category": "chart",
        "data_query": "SELECT a.month_ending , SUM( CASE WHEN split_part(b.dims,'||',2) in ('digitalCoach','Digital Coach') AND b.metric_value IS NOT NULL THEN b.metric_value ELSE NULL END)digitalCoach , SUM( CASE WHEN split_part(b.dims,'||',2) in ('moduleEnrollment','Module Completion') AND b.metric_value IS NOT NULL THEN b.metric_value ELSE NULL END) moduleEnrollment FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, metric_value FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14), 'yyyy-mm') AND :month_ending AND entity= :entity and month_ending >= '2020-01' AND metric_id = 100003 )a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE entity= :entity AND metric_id=100005037 AND split_part(dims,'||',1) = 'Pregnancy Program' ) b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) GROUP BY 1 ORDER BY 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "WEEKS AT DELIVERY",
        "visulization_type": "Pie Chart",
        "placeholder_name": "weeks_at_delivery",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)DeliveryTerm,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%' pct from sc_kpi.metrics_values where metric_id in (100005035) and split_part(dims,'||',1) = 'Pregnancy Program' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "pivot:pie_chart_null"
    },
    {
        "slide_title": "Pregnancy  Results",
        "visualization_name": "DELIVERY TYPE",
        "visulization_type": "Pie Chart",
        "placeholder_name": "delivery_type",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)DeliveryTerm,(metric_value/sum(metric_value)over(partition by :entity)) pct from sc_kpi.metrics_values where metric_id in (100005036) and split_part(dims,'||',1) = 'Pregnancy Program' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "pivot:pie_chart_null"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program _regd_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,5003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "prog_enrollment_parenting",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,enroll.metric_value enrolled_metric_value,disenroll.metric_value disenrolled_metric_value from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005006,100005007) and entity= :entity and split_part(dims,'||',1) = 'Parenting Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "age_dist_parenting",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Parenting  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "assesment_parenting",
        "style": "",
        "category": "table",
        "data_query": "SELECT CASE WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 'Total Disenrollments' WHEN split_part(dims,'||',2) = 'Enrolled via another Ovia program' THEN '          Enrolled via another Ovia program' WHEN split_part(dims,'||',2) = 'Enrolled via qualification assessment' THEN '          Enrolled via qualification assessment' WHEN split_part(dims,'||',2) = 'Enrollments' THEN '     Net Enrollments' ELSE split_part(dims,'||',2) END assessment, metric_value  FROM ( SELECT DISTINCT dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005003,100005008,100005009,100005010,100005011,100005012,100005013,100005014,100005015,100005075,100005076) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND split_part(dims,'||',1) = 'Parenting Program' )x ORDER BY CASE WHEN split_part(dims,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dims,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dims,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dims,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dims,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dims,'||',2) = 'Enrollments' THEN 7 WHEN split_part(dims,'||',2) = 'Enrolled via another Ovia program' THEN 8 WHEN split_part(dims,'||',2) = 'Enrolled via qualification assessment' THEN 9 END;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005020 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Parenting Program' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions_parenting",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Parenting Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct  to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_parenting",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value::int total_session,avgs.metric_value::int avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct  to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct  to_char(reporting_end_period,'yyyy-mm')  month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Parenting Program') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_parenting",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005023 and entity= :entity and split_part(dims,'||',1) = 'Parenting Program' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Parenting  Engagement",
        "visualization_name": "CLINICAL PROGRAM (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "clinical_program_parenting",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005026 and entity= :entity and split_part(dims,'||',1) = 'Parenting Program' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_regd_members_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_enrollments_financial",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dims,'||',1)program_name, enroll.metric_value enrolled_metric_value, disenroll.metric_value disenrolled_metric_value FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dims, b.metric_value FROM ( SELECT DISTINCT  to_char(reporting_end_period,'yyyy-mm') month_ending, entity FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14 ),'yyyy-mm') AND :month_ending AND entity= :entity AND metric_id = 100003) a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005006,100005007) AND entity= :entity AND split_part(dims,'||',1) = 'Financial Well-being') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005006 AND entity= :entity) enroll ON ( elig.month_ending = enroll.month_ending AND elig.entity = enroll.entity AND split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005007 AND entity= :entity) disenroll ON ( elig.month_ending = disenroll.month_ending AND elig.entity = disenroll.entity AND split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrollment_by_age_financial",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLMENT BY GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "enrollment_by_gender_financial",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)gender, round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005004 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Financial Well-Being  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_enrolled_members_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005020 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Financial Well-being' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions_financial",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Financial Well-being') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_financial",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dims,'||',1)program_name, ts.metric_value::int total_session, avgs.metric_value::int avg_Session, ROUND((ts.metric_value/avgs.metric_value),1) avg_session_per_users FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dims FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending and month_ending >= '2020-01' AND entity= :entity AND metric_id = 100003) a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity FROM sc_kpi.metrics_values WHERE metric_id in (100005021,100005022) AND entity= :entity AND split_part(dims,'||',1) = 'Financial Well-being') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005021 AND entity= :entity) ts ON ( ts.month_ending = elig.month_ending AND ts.entity = elig.entity AND split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005022 AND entity= :entity) avgs ON ( elig.month_ending = avgs.month_ending AND elig.entity = avgs.entity AND split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "participant_activity_financial",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005023 and entity= :entity and split_part(dims,'||',1) = 'Financial Well-being' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "CONTENT VIEW (TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "content_view_financial",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005025 and entity= :entity and split_part(dims,'||',1) = 'Financial Well-being' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Financial Well-Being  Engagement",
        "visualization_name": "TOOL USE (TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "tool_use_financial",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005024 and entity= :entity and split_part(dims,'||',1) = 'Financial Well-being' and  to_char(reporting_end_period,'yyyy-mm') =:month_ending order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_members_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "program_eligible_regd_members_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_members_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_enrollment_craving",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name, enroll.metric_value enrolled_metric_value,disenroll.metric_value disenrolled_metric_value from ( select distinct a.month_ending,a.entity,b.dims,b.metric_value from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity,metric_value from sc_kpi.metrics_values where metric_id in (100005006,100005007) and entity= :entity and split_part(dims,'||',1) = 'Tobacco Cessation') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS BY TYPE",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_by_type_craving",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,smoke.metric_value smoke_metric_value,vape.metric_value vape_metric_value from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005017,100005018) and entity= :entity and split_part(dims,'||',1) = 'Tobacco Cessation') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005017 and entity= :entity) smoke on (elig.month_ending = smoke.month_ending and elig.entity = smoke.entity and split_part(elig.dims,'||',1) = split_part(smoke.dims,'||',1)) left join (select  DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005018 and entity= :entity) vape on (elig.month_ending = vape.month_ending and elig.entity = vape.entity and split_part(elig.dims,'||',1) = split_part(vape.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrolled_members_bar_craving",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "enrolled_members_pie_craving",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)gender, round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005004 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Craving to Quit  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "assessment_results_craving",
        "style": "",
        "category": "table",
        "data_query": "select case when split_part(dims,'||',2) = 'Total Disenrollments' then 'Total Disenrollments' when split_part(dims,'||',2) = 'Enrollments' then '     Net Enrollments' else split_part(dims,'||',2) end assessment, metric_value from ( select distinct dims,metric_value from sc_kpi.metrics_values where metric_id in (100005008,100005009,100005010,100005011,100005012,100005013,100005075,100005076,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Tobacco Cessation' )x order by case when split_part(dims,'||',2) = 'Total Assessment Starts' then 1 when split_part(dims,'||',2) = 'Total Assessment Completions' then 2 when split_part(dims,'||',2) = 'Total Assessment Qualified' then 3 when split_part(dims,'||',2) = 'Total Assessment Disqualified' then 4 WHEN split_part(dims,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dims,'||',2) = 'Enrollments' THEN 7 when split_part(dims,'||',2) = 'Smoking' then 8 when split_part(dims,'||',2) = 'Vaping' then 9 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_session_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005020 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_sessions_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Tobacco Cessation') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_craving_quit",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dims,'||',1)program_name, ts.metric_value total_session, avgs.metric_value avg_Session, ROUND((ts.metric_value/avgs.metric_value),1) avg_session_per_users FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dims FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending and month_ending >= '2020-01' AND entity= :entity AND metric_id = 100003) a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity FROM sc_kpi.metrics_values WHERE metric_id in (100005021,100005022) AND entity= :entity AND split_part(dims,'||',1) = 'Tobacco Cessation') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005021 AND entity= :entity) ts ON ( ts.month_ending = elig.month_ending AND ts.entity = elig.entity AND split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005022 AND entity= :entity) avgs ON ( elig.month_ending = avgs.month_ending AND elig.entity = avgs.entity AND split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_craving_quit",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005023 and entity= :entity and split_part(dims,'||',1) = 'Tobacco Cessation' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Craving to Quit  Engagement",
        "visualization_name": "TOOL USE (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "tool_use_craving",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005024 and entity= :entity and split_part(dims,'||',1) = 'Tobacco Cessation' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Craving to Quit  Results",
        "visualization_name": "PARTICIPANTS QUIT SMOKING",
        "visulization_type": "KPI",
        "placeholder_name": "quit_smoking_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005039 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Craving to Quit  Results",
        "visualization_name": "QUIT RATE (of Module Completers)",
        "visulization_type": "KPI",
        "placeholder_name": "quit_rate_craving",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005039 then metric_value else null end)/sum(case when metric_id=100005038 then metric_value else null end))*100,1)||'%' pct from sc_kpi.metrics_values where metric_id in (100005038,100005039) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Tobacco Cessation' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Craving to Quit  Results",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_craving",
        "style": "",
        "category": "chart",
        "data_query": "select to_char(reporting_end_period,'yyyy-mm') month_ending,sum(case when lower( split_part(dims,'||',2) ) =  'community' then metric_value else null end) community ,sum(case when split_part(dims,'||',2) = 'Tool Use' then metric_value else null end) tooluse ,sum(case when split_part(dims,'||',2) = 'Digital Coaching' then metric_value else null end) digital_coaching ,sum(case when split_part(dims,'||',2) = 'Tracker Entries' then metric_value else null end) trackerentries from sc_kpi.metrics_values where metric_id in (100005040) and entity= :entity and split_part(dims,'||',1) = 'Tobacco Cessation' and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending group by 1 order by 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Craving to Quit  Results",
        "visualization_name": "MILESTONE COMPLETION",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_craving",
        "style": "",
        "category": "table",
        "data_query": "select * from ( select distinct split_part(dims,'||',2) milestone,metric_value from sc_kpi.metrics_values where metric_id=100005041 and entity= :entity and split_part(dims,'||',1) = 'Tobacco Cessation' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ) X ORDER BY case when milestone IN ('Enrollments') then 1 when milestone IN ('Completed All Modules') then 2 when milestone IN ('Program Completion') then 3 when milestone IN ('Module 4 Completion') then 4 else 5 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "prog_eligible_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(metric_value as decimal(7, 0)) as metric_value  from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "prog_regd_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(metric_value as decimal(7, 0)) as metric_value  from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_member_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select cast(metric_value as decimal(7, 0)) as metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Unwinding Anxiety' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "prog_enroll_anx",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,enroll.metric_value enrolled_metric_value,disenroll.metric_value disenrolled_metric_value from ( select distinct a.month_ending,a.entity,b.dims,b.metric_value from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity,metric_value from sc_kpi.metrics_values where metric_id in (100005006,100005007) and entity= :entity and split_part(dims,'||',1) = 'Unwinding Anxiety') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "age_dist_anx",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Unwinding Anxiety' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "gender_anx",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)gender, round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005004 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Unwinding Anxiety' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(metric_value as decimal(7, 0)) as metric_value  from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_member_1+_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(metric_value as decimal(7, 0)) as metric_value  from sc_kpi.metrics_values where metric_id=100005020 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_1+_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select to_char(reporting_end_period,'yyyy-mm') DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Unwinding Anxiety') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct  to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "prog_engagement_anx",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Unwinding Anxiety') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "ptpn_activity_anx",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005023 and entity= :entity and split_part(dims,'||',1) = 'Unwinding Anxiety' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "CONTENT VIEW (TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "conten_view_anx",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005025 and entity= :entity and split_part(dims,'||',1) = 'Unwinding Anxiety' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Engagement",
        "visualization_name": "TOOL USE (TOP 3)",
        "visulization_type": "Table",
        "placeholder_name": "tool_use_anx",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005024 and entity= :entity and split_part(dims,'||',1) = 'Unwinding Anxiety' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   order by 1) x where row_num <= 3 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "TOTAL MODULE COMPLETION",
        "visulization_type": "KPI",
        "placeholder_name": "module_comp_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select  cast(metric_value as decimal(7, 0)) as metric_value  from sc_kpi.metrics_values where metric_id=100005023 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Unwinding Anxiety' and lower( split_part(dims,'||',2) ) like 'module%completion' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "AVERAGE GAD - 7 SCORE",
        "visulization_type": "KPI",
        "placeholder_name": "avg_gad_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "SELECT CAST (  metric_value as DECIMAL(6,1 ) ) FROM sc_kpi.metrics_values WHERE metric_id=100005027 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND split_part(dims,'||',1) = 'Unwinding Anxiety' ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "ACTIVITY TRENDS ( Distinct Members Per Month)",
        "visulization_type": "Bar Chart",
        "placeholder_name": "activity_trends_anx",
        "style": "",
        "category": "chart",
        "data_query": "SELECT to_char(reporting_end_period,'yyyy-mm') month_ending, SUM( CASE WHEN lower( split_part(dims,'||',2) ) like 'module%completion' THEN metric_value ELSE NULL END) community , SUM( CASE WHEN lower(split_part(dims,'||',2) ) like 'tool%use' THEN metric_value ELSE NULL END) tooluse, SUM( CASE WHEN lower(split_part(dims,'||',2)) in ('community') THEN metric_value ELSE NULL END) community FROM sc_kpi.metrics_values WHERE metric_id in (100005028) AND entity= :entity AND split_part(dims,'||',1) = 'Unwinding Anxiety' AND to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending GROUP BY 1 ORDER BY 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "MEMBERS DECREASING GAD-7 SCORE BY 25%",
        "visulization_type": "KPI",
        "placeholder_name": "gad_score_anx",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "SELECT sum(metric_value) FROM sc_kpi.metrics_values WHERE metric_id=100005031 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND split_part(dims,'||',1) = 'Unwinding Anxiety' AND split_part(dims,'||',2) in( '26%-37%','38%-49%','50% or greater') ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "GAD-7 DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "gad_dist_anx",
        "style": "",
        "category": "chart",
        "data_query": "SELECT CASE WHEN x.GAD7 = '0-4 Minimal' THEN 1 WHEN x.GAD7 = '5-9 Mild' THEN 2 WHEN x.GAD7 = '10-14 Moderate' THEN 3 WHEN x.GAD7 = '15-21 Severe' THEN 4 END sort, x.GAD7, x.pct , y.pct FROM ( SELECT split_part(dims,'||',2) GAD7, ROUND((metric_value/SUM(metric_value)over(partition BY :entity))*100,1)||'%'pct FROM sc_kpi.metrics_values WHERE metric_id=100005029 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND split_part(dims,'||',1) = 'Unwinding Anxiety' ORDER BY 1 ) x JOIN ( SELECT split_part(dims,'||',2) GAD7, ROUND((metric_value/SUM(metric_value)over(partition BY :entity))*100,1)||'%'pct FROM sc_kpi.metrics_values WHERE metric_id=100005030 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND split_part(dims,'||',1) = 'Unwinding Anxiety' ORDER BY 1 ) y ON x.GAD7 = y.GAD7 order by 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:sort"
    },
    {
        "slide_title": "Unwinding Anxiety  Results",
        "visualization_name": "GAD-7 IMPROVEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "gad_imp_anx",
        "style": "",
        "category": "chart",
        "data_query": "SELECT CASE WHEN x.GAD7 = 'Worsening' THEN 1 WHEN x.GAD7 = 'None' THEN 2 WHEN x.GAD7 = '1%-12%' THEN 3 WHEN x.GAD7 = '12%-25%' THEN 4 WHEN x.GAD7 = '26%-37%' THEN 5 WHEN x.GAD7 = '38%-49%' THEN 6 WHEN x.GAD7 ='50% or greater' THEN 7 END sort, x.* FROM ( SELECT split_part(dims,'||',2) GAD7, ROUND((metric_value/SUM(metric_value)over(partition BY :entity))*100,1)||'%'pct FROM sc_kpi.metrics_values WHERE metric_id=100005031 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND split_part(dims,'||',1) = 'Unwinding Anxiety') x ORDER BY 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:sort"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "eligible_members_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')  =:month_ending   and split_part(dims,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "regd_members_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "enrollment_rate_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_ennrollment_scale",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dims,'||',1)program_name, enroll.metric_value enrolled_metric_value, disenroll.metric_value disenrolled_metric_value FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dims, b.metric_value FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending and month_ending >= '2020-01' AND entity= :entity AND metric_id = 100003) a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005006,100005007) AND entity= :entity AND split_part(dims,'||',1) = 'Scaleback') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005006 AND entity= :entity) enroll ON ( elig.month_ending = enroll.month_ending AND elig.entity = enroll.entity AND split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005007 AND entity= :entity) disenroll ON ( elig.month_ending = disenroll.month_ending AND elig.entity = disenroll.entity AND split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "enrolled_members_age_distribution_scale",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "emrolled_member_gender_dist_scale",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)gender, round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005004 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "total_sessions_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "enrolled_members_1+_app_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005020 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Scaleback' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "avg_monthly_session_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Scaleback') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select  DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "PROGRAM ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "program_engagement_scale",
        "style": "",
        "category": "chart",
        "data_query": "SELECT DISTINCT elig.month_ending, split_part(elig.dims,'||',1)program_name, ts.metric_value total_session, avgs.metric_value avg_Session, ROUND((ts.metric_value/avgs.metric_value),1) avg_session_per_users FROM ( SELECT DISTINCT a.month_ending, a.entity, b.dims FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'), -14),'yyyy-mm') AND :month_ending and month_ending >= '2020-01' AND entity= :entity AND metric_id = 100003) a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity FROM sc_kpi.metrics_values WHERE metric_id in (100005021,100005022) AND entity= :entity AND split_part(dims,'||',1) = 'Scaleback') b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) ) elig LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005021 AND entity= :entity) ts ON ( ts.month_ending = elig.month_ending AND ts.entity = elig.entity AND split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005022 AND entity= :entity) avgs ON ( elig.month_ending = avgs.month_ending AND elig.entity = avgs.entity AND split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) ORDER BY 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "participant_activity_scale",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005023 and entity= :entity and split_part(dims,'||',1) = 'Scaleback' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Scale Back  Engagement",
        "visualization_name": "TRACKERS (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "trackers_scale",
        "style": "",
        "category": "table",
        "data_query": "select * from (SELECT DISTINCT split_part(dims,'||',2) activity, metric_value FROM ( SELECT DISTINCT dims, metric_value, row_number() over(partition BY entity ORDER BY metric_value DESC)row_num FROM sc_kpi.metrics_values WHERE metric_id=100005043 AND entity= :entity AND split_part(dims,'||',1) = 'Scaleback' AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ORDER BY 1) x WHERE row_num <= 5)d ORDER BY case when activity IN ('Active_minutes','Active Minutes') then 1 when activity IN ('Meals_logged','Meals Logged') then 2 when activity IN ('Weight') then 3 else 4 end;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Results",
        "visualization_name": "PROGRAM COMPLETION",
        "visulization_type": "KPI",
        "placeholder_name": "program_completions_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "SELECT metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005105 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Results",
        "visualization_name": "TOTAL POUNDS LOST",
        "visulization_type": "KPI",
        "placeholder_name": "total_pounds_lost_scale",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "SELECT metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005100 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Scale Back  Results",
        "visualization_name": "ACTIVITY TRENDS (Distinct Members per Month)",
        "visulization_type": "Bar Chart",
        "placeholder_name": "activity_trend_scale",
        "style": "",
        "category": "chart",
        "data_query": "SELECT to_char(reporting_end_period,'yyyy-mm') month_ending, SUM( CASE WHEN split_part(dims,'||',2) = 'Digital Coaching' and split_part(dims,'||',3) = 'SC_DGTL_FS_DPP_WL' THEN metric_value ELSE NULL END) dig_coach , SUM( CASE WHEN split_part(dims,'||',2) = 'Tracker' and split_part(dims,'||',3) = 'SC_DGTL_FS_DPP_WL' THEN metric_value ELSE NULL END) monthly_tracker FROM sc_kpi.metrics_values WHERE metric_id=100005044 AND entity= :entity AND split_part(dims,'||',1) = 'Scaleback' AND to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending GROUP BY 1 ORDER BY 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Scale Back  Results",
        "visualization_name": "MILESTONES",
        "visulization_type": "Table",
        "placeholder_name": "scaleback_milestones",
        "style": "",
        "category": "table",
        "data_query": "SELECT CASE WHEN f.Milestone = 'Progress Goal 1' THEN 'Completed 2 class sessions and 2 weigh-ins' WHEN f.Milestone = 'Progress Goal 2' THEN 'Completed 6/7 class sessions and 6/7 weigh-ins' WHEN f.Milestone = 'Progress Goal 3' THEN 'Participant has lost >=5% of weight based upon initial non-rejected BodyTrace or fitbit weight' WHEN f.Milestone = 'Successful Program Completion' THEN 'Member indicates that they completed program and achieved Goal of 5% weight loss' ELSE f.Milestone END AS 'Milestone', f.Members, CASE WHEN f.milestone <> ('Enrollments') THEN CAST (100* (f.members/e.members) AS DECIMAL(6,1) ) || '%' ELSE NULL END AS 'Percent of Total' FROM ( SELECT split_part(dims,'||',2) Milestone, metric_value AS Members, entity,to_char(reporting_end_period,'yyyy-mm') month_ending FROM sc_kpi.metrics_values WHERE metric_id in (100005003) AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity = :entity AND split_part(dims,'||',1) = 'Scaleback' UNION SELECT split_part(dims,'||',3) Milestone, metric_value AS Members, entity,to_char(reporting_end_period,'yyyy-mm') month_ending FROM sc_kpi.metrics_values WHERE metric_id in (100005081) AND to_char(reporting_end_period,'yyyy-mm') = :month_ending  AND entity = :entity AND split_part(dims,'||',1) = 'Scaleback' AND split_part(dims,'||',2) = 'Milestone' )f LEFT JOIN ( SELECT split_part(dims,'||',2) Milestone, metric_value AS Members, entity,to_char(reporting_end_period,'yyyy-mm') month_ending FROM sc_kpi.metrics_values WHERE metric_id in (100005003) AND to_char(reporting_end_period,'yyyy-mm') =:month_ending  AND entity = :entity AND split_part(dims,'||',1) = 'Scaleback' )e ON ( e.entity = f.entity AND e.month_ending = f.month_ending) ORDER BY ( CASE WHEN f.Milestone = 'Enrollments' THEN '01' ELSE f.milestone END) ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "msk_program_eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "msk_program_eligible_regd_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "msk_enrolled_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "msk_enrollment_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "msk_program_enrollment",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,enroll.metric_value enrolled_metric_value,disenroll.metric_value disenrolled_metric_value from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005006,100005007) and entity= :entity and split_part(dims,'||',1) = 'Muscle and Joint Health') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value::int from sc_kpi.metrics_values where metric_id=100005006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value::int from sc_kpi.metrics_values where metric_id=100005007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "msk_enrolled_members_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "msk_assessment_results",
        "style": "",
        "category": "table",
        "data_query": "SELECT case when split_part(dims,'||',2) = 'Total Disenrollments' then 'Total Disenrollments' when split_part(dims,'||',2) = 'Enrollments' then '     Net Enrollments' else split_part(dims,'||',2) end assessment, metric_value FROM ( SELECT DISTINCT dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005003,100005008,100005009,100005010,100005011,100005012,100005013,100005015,100005075,100005076,100005003) AND metric_id NOT IN (100005014) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending  AND split_part(dims,'||',1) = 'Muscle and Joint Health' )x ORDER BY CASE WHEN split_part(dims,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dims,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dims,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dims,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dims,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dims,'||',2) = 'Enrollments' THEN 7 END;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "msk_enrolled_members_gender_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)gender, round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005004 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Enrollment",
        "visualization_name": "ENROLLED MEMBER RISK STRATIFICATION",
        "visulization_type": "Table",
        "placeholder_name": "msk_enrolled_members_risk_stratification",
        "style": "",
        "category": "table",
        "data_query": "select split_part(dims,'||',3) as stratification,metric_value from ( select distinct dims,metric_value from sc_kpi.metrics_values where metric_id=100005050 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' )x order by 1",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "msk_total_sessions",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBER WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "msk_enrolled_members_1+_app",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Muscle and Joint Health') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "PROGRAM DIGITAL ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "msk_prog_engagement",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Muscle and Joint Health') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "msk_participant_activity",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005023 and entity= :entity and split_part(dims,'||',1) = 'Muscle and Joint Health' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 5 order by 2 desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement",
        "visualization_name": "TOP PROGRAMS(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "msk_top_programs",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005026 and entity= :entity and split_part(dims,'||',1) = 'Muscle and Joint Health' and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1) x where row_num <= 5 order by 2 desc",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc average mhq score",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_average_mhq_score",
        "data_query": "select cast( round(metric_value, 1) as float ) from sc_kpi.metrics_values where metric_id=100005051 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')=  :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc average daily readiness",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_average_daily_readiness",
        "data_query": "select cast( round(metric_value, 1) as float ) from sc_kpi.metrics_values where metric_id=100005052 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')=  :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc average daily readiness score improvement",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_average_daily_readiness_score_improvement",
        "data_query": "select cast( round(metric_value, 4) as float ) *100||'%'  from sc_kpi.metrics_values where metric_id=100005053 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')=  :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc mhq average score table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Table",
        "placeholder_name": "sc_mhq_average_score_table",
        "data_query": "select dims, cast( round(metric_value, 1) as decimal(8,0) ) from sc_kpi.metrics_values where metric_id=100005055 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')=  :month_ending order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc daily readiness average scores table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "Table",
        "placeholder_name": "sc_daily_readiness_average_scores_table",
        "data_query": "select dims, cast( round(metric_value, 1) as decimal(8,0) ) from sc_kpi.metrics_values where metric_id=100005056 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')=  :month_ending order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Results",
        "visualization_name": "sc daily readiness score improvement chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "CHART",
        "placeholder_name": "sc_daily_readiness_score_improvement_chart",
        "data_query": "select split_part(dims,'||',3), cast( round(metric_value, 1) as decimal(8,0) ) from sc_kpi.metrics_values where metric_id=100005054 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')=  :month_ending order by case when split_part(dims,'||',3)='Worsening' then 1 when split_part(dims,'||',3)='No Change' then 2 when split_part(dims,'||',3)='1% - 12%' then 3 when split_part(dims,'||',3)='13% - 25%' then 4 when split_part(dims,'||',3)='26% - 37%' then 5 when split_part(dims,'||',3)='38% - 49%' then 6 when split_part(dims,'||',3)='50% +' then 7 end;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "duo_program_eligible_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "PROGRAM ELIGIBLE AND REGISTERED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "duo_program_eligible_regd_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ENROLLED MEMBERS",
        "visulization_type": "KPI",
        "placeholder_name": "duo_enrolled_members",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and split_part(dims,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ENROLLMENT RATE",
        "visulization_type": "KPI",
        "placeholder_name": "duo_enrollment_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate from sc_kpi.metrics_values where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and split_part(dims,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "PROGRAM ENROLLMENTS",
        "visulization_type": "Bar Chart",
        "placeholder_name": "duo_program_enrollment",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,enroll.metric_value enrolled_metric_value,disenroll.metric_value disenrolled_metric_value from ( select a.month_ending,a.entity,b.dims from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005006,100005007) and entity= :entity and split_part(dims,'||',1) = 'Type 2 Diabetes Management') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value::int from sc_kpi.metrics_values where metric_id=100005006 and entity= :entity) enroll on (elig.month_ending = enroll.month_ending and elig.entity = enroll.entity and split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value::int from sc_kpi.metrics_values where metric_id=100005007 and entity= :entity) disenroll on (elig.month_ending = disenroll.month_ending and elig.entity = disenroll.entity and split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ENROLLMENT MEMBERS - AGE DISTRIBUTION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "duo_enrolled_members_age_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ASSESSMENTS RESULTS",
        "visulization_type": "Table",
        "placeholder_name": "duo_assessment_results",
        "style": "",
        "category": "table",
        "data_query": "SELECT case when split_part(dims,'||',2) = 'Total Disenrollments' then 'Total Disenrollments' when split_part(dims,'||',2) = 'Enrollments' then '     Net Enrollments' else split_part(dims,'||',2) end assessment, metric_value FROM ( SELECT DISTINCT metric_id, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005008,100005009,100005010,100005011,100005012,100005013,100005015, 100005003, 100005075,100005076) AND metric_id NOT IN (100005014) AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND split_part(dims,'||',1) = 'Type 2 Diabetes Management' )x ORDER BY CASE WHEN split_part(dims,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dims,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dims,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dims,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dims,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dims,'||',2) = 'Enrollments' THEN 7 END;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Manage Diabetes  Enrollment",
        "visualization_name": "ENROLLED MEMBERS - GENDER",
        "visulization_type": "Pie Chart",
        "placeholder_name": "duo_enrolled_members_gender_dist",
        "style": "",
        "category": "chart",
        "data_query": "select split_part(dims,'||',2)gender, round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct from sc_kpi.metrics_values where metric_id=100005004 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "TOTAL SESSIONS",
        "visulization_type": "KPI",
        "placeholder_name": "duo_total_sessions",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005019 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and split_part(dims,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "ENROLLED MEMBERS WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "duo_enrolled_members_1+_app",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005020 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Type 2 Diabetes Management' order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "AVERAGE MONTHLY SESSIONS PER MEMBER WITH 1+ APP LAUNCHES",
        "visulization_type": "KPI",
        "placeholder_name": "duo_average_sessions_1+_app",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round(sum(total_session)/sum(avg_Session),1)avg_session_peruser from ( select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Type 2 Diabetes Management') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1 ) xx1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "PROGRAM DIGITAL ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "duo_prog_engagement",
        "style": "",
        "category": "chart",
        "data_query": "select distinct elig.month_ending,split_part(elig.dims,'||',1)program_name,ts.metric_value total_session,avgs.metric_value avg_Session, round((ts.metric_value/avgs.metric_value),1) avg_session_per_users from ( select distinct a.month_ending,a.entity,b.dims from (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity from sc_kpi.metrics_values where to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending and entity= :entity and metric_id = 100003) a left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,dims,entity from sc_kpi.metrics_values where metric_id in (100005021,100005022) and entity= :entity and split_part(dims,'||',1) = 'Type 2 Diabetes Management') b on (a.month_ending = b.month_ending and a.entity = b.entity) ) elig left join (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005021 and entity= :entity) ts on (ts.month_ending = elig.month_ending and ts.entity = elig.entity and split_part(ts.dims,'||',1) = split_part(elig.dims,'||',1)) left join (select distinct to_char(reporting_end_period,'yyyy-mm') month_ending,entity,dims,metric_value from sc_kpi.metrics_values where metric_id=100005022 and entity= :entity) avgs on (elig.month_ending = avgs.month_ending and elig.entity = avgs.entity and split_part(elig.dims,'||',1) = split_part(avgs.dims,'||',1)) order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "col_drop:program_name"
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "PARTICIPANT ACTIVITY(TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "duo_participant_activity",
        "style": "",
        "category": "table",
        "data_query": "SELECT DISTINCT split_part(dims,'||',2) activity, metric_value FROM ( SELECT DISTINCT dims, metric_value, row_number() over(partition BY entity ORDER BY metric_value DESC)row_num FROM sc_kpi.metrics_values WHERE metric_id=100005023 AND entity= :entity AND split_part(dims,'||',1) = 'Type 2 Diabetes Management' AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ORDER BY 1) x WHERE row_num <= 3 ORDER BY 2 DESC;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "TOP MODULES",
        "visulization_type": "Table",
        "placeholder_name": "duo_top_modules",
        "style": "",
        "category": "table",
        "data_query": "SELECT * FROM ( SELECT DISTINCT split_part(dims,'||',2) activity, metric_value FROM ( SELECT DISTINCT dims, metric_value, row_number() over(partition BY entity ORDER BY metric_value DESC)row_num FROM sc_kpi.metrics_values WHERE metric_id=100005071 AND entity= :entity AND split_part(dims,'||',1) = 'Type 2 Diabetes Management' AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ORDER BY 1) x WHERE row_num <= 3)d ORDER BY metric_value desc ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Manage Diabetes  Engagement",
        "visualization_name": "TOP TRACKERS",
        "visulization_type": "Table",
        "placeholder_name": "duo_top_trackers",
        "style": "",
        "category": "table",
        "data_query": "SELECT * FROM ( SELECT DISTINCT split_part(dims,'||',2) activity, metric_value FROM ( SELECT DISTINCT dims, metric_value, row_number() over(partition BY entity ORDER BY metric_value DESC)row_num FROM sc_kpi.metrics_values WHERE metric_id=100005072 AND entity= :entity AND split_part(dims,'||',1) = 'Type 2 Diabetes Management' AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ORDER BY 1) x WHERE row_num <= 3)d ORDER BY metric_value desc;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc risk change measured members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_risk_change_measured_members",
        "data_query": "select metric_value::int as 'Measured Members'  from sc_kpi.metrics_values  where metric_id=100002054 and entity = :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc lifestyle risk change",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_lifestyle_risk_change",
        "data_query": "select -1*(CAST( ROUND(metric_value*100,1) AS DECIMAL(6,1) ) ) || '%' as 'Lifestyle risk change'  from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Lifestyle Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc top3 lifestyle risk count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_lifestyle_risk_count",
        "data_query": "SELECT t1.dims as 'Risk Name', t1.metric_value::int as 'T1 Risk Points' FROM (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')  =:month_ending   and entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) where t1.dims in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Lifestyle') and t1.metric_value is not null ORDER BY t1.metric_value desc limit 3;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc top3 lifestyle risk reduction",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_lifestyle_risk_reduction",
        "data_query": "SELECT t1.dims as 'Risk Name',  TRIM( TO_CHAR(tx.metric_value-t1.metric_value, '999,999,999.9') )  AS 'Risk Reduction' FROM (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) where t1.dims in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Lifestyle') and (tx.metric_value-t1.metric_value)<0 ORDER BY (tx.metric_value-t1.metric_value) asc, t1.dims limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc top3 lifestyle risk increase",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_lifestyle_risk_increase",
        "data_query": "SELECT t1.dims as 'Risk Name', TRIM( TO_CHAR(tx.metric_value-t1.metric_value, '999,999,999.9') ) AS 'Risk Increase' FROM (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) where t1.dims in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Lifestyle') and (tx.metric_value-t1.metric_value)>0 ORDER BY (tx.metric_value-t1.metric_value) desc, t1.dims limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Lifestyle Risk",
        "visualization_name": "sc lifestyle risk chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_lifestyle_risk_chart",
        "data_query": "SELECT t1.dims AS dims, t1.metric_value AS 'T1 Risk Points', tx.metric_value AS 'Tx Risk Points', CASE WHEN t1.metric_value=0 and tx.metric_value = 0 THEN '0%' WHEN t1.metric_value=0 THEN '' ELSE ROUND(((tx.metric_value-t1.metric_value)/t1.metric_value)*100,1)::VARCHAR || '%' END AS '% change' FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) WHERE t1.dims IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Lifestyle') ORDER BY t1.dims",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc risk change measured members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_risk_change_measured_members",
        "data_query": "select metric_value::int as 'Measured Members'  from sc_kpi.metrics_values  where metric_id=100002054 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc biometric risk change",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_biometric_risk_change",
        "data_query": "select -1*(CAST( ROUND(metric_value*100,1) AS DECIMAL(6,1) ) )  || '%' as 'Biometric risk change'  from sc_kpi.metrics_values where metric_id=100002053 and dims = 'Biometric Risks' and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc top3 biometric risk count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_biometric_risk_count",
        "data_query": "SELECT case when t1.dims in ('A1C','A1C (PWD)') then 'A1C' else t1.dims end as 'Risk Name', t1.metric_value::int as 'T1 Risk Points'  FROM (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value          FROM sc_kpi.metrics_values  WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND entity= :entity AND metric_id=100002075 )t1   LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values  WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending   AND entity= :entity AND metric_id=100002076 )tx  ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) where case when t1.dims in ('A1C','A1C (PWD)') then 'A1C' else t1.dims end in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Biometric') and t1.metric_value is not null ORDER BY t1.metric_value desc limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc top3 biometric risk reduction",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_biometric_risk_reduction",
        "data_query": "SELECT case when t1.dims in ('A1C','A1C (PWD)') then 'A1C' else t1.dims end as 'Risk Name', TRIM(  TO_CHAR(tx.metric_value-t1.metric_value, '999,999,999.9') ) AS 'Risk Reduction' FROM (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm') month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm') =:month_ending AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) where case when t1.dims in ('A1C','A1C (PWD)') then 'A1C' else t1.dims end in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Biometric') and (tx.metric_value-t1.metric_value)<0 ORDER BY (tx.metric_value-t1.metric_value) asc, t1.dims limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc top3 biometric risk increase",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_biometric_risk_increase",
        "data_query": "SELECT case when t1.dims in ('A1C','A1C (PWD)') then 'A1C' else t1.dims end as 'Risk Name', TRIM(TO_CHAR(tx.metric_value-t1.metric_value, '999,999,999.9') )  AS 'Risk Increase' FROM (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) where case when t1.dims in ('A1C','A1C (PWD)') then 'A1C' else t1.dims end in (select qbr_risk_name from sc_enterprise_daily.risk_lu where risk_category='Biometric') and (tx.metric_value-t1.metric_value)>0 ORDER BY (tx.metric_value-t1.metric_value) desc, t1.dims limit 3;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Biometric/Clinical Risk",
        "visualization_name": "sc biometric risk chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_biometric_risk_chart",
        "data_query": "SELECT CASE WHEN t1.dims IN ('A1C', 'A1C (PWD)') THEN 'A1C' ELSE t1.dims END AS dims, t1.metric_value AS 'T1 Risk Points', tx.metric_value AS 'Tx Risk Points', CASE WHEN t1.metric_value=0 and tx.metric_value = 0 THEN '0%' WHEN t1.metric_value=0 THEN '' ELSE ROUND(((tx.metric_value-t1.metric_value)/t1.metric_value)*100,1)::VARCHAR || '%' END AS '% change' FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) WHERE CASE WHEN t1.dims IN ('A1C', 'A1C (PWD)') THEN 'A1C' ELSE t1.dims END IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Biometric') ORDER BY t1.dims",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc risk change measured members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_risk_change_measured_members",
        "data_query": "select metric_value::int as 'Measured Members'  from sc_kpi.metrics_values  where metric_id=100002054 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc preventive risk change",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_preventive_risk_change",
        "data_query": "SELECT -1*(CAST( ROUND(metric_value*100,1) AS DECIMAL(6,1) ) ) || '%' AS 'Preventive risk change' FROM sc_kpi.metrics_values WHERE metric_id=100002053 AND dims = 'Preventive Risks' AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending ",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc top3 preventive risk count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_preventive_risk_count",
        "data_query": "SELECT t1.dims AS 'Risk Name', t1.metric_value::INT AS 'T1 Risk Points' FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm') =:month_ending AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm') =:month_ending AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) WHERE t1.dims IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Preventive') AND t1.metric_value IS NOT NULL ORDER BY t1.metric_value DESC limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc top3 preventive risk reduction",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_preventive_risk_reduction",
        "data_query": "SELECT t1.dims AS 'Risk Name', TRIM( TO_CHAR(tx.metric_value-t1.metric_value, '999,999,999.9') ) AS 'Risk Reduction' FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) WHERE t1.dims IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Preventive') AND ( tx.metric_value-t1.metric_value)<0 ORDER BY (tx.metric_value-t1.metric_value) ASC, t1.dims limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc top3 preventive risk increase",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top3_preventive_risk_increase",
        "data_query": "SELECT t1.dims AS 'Risk Name', TRIM ( TO_CHAR(tx.metric_value-t1.metric_value, '999,999,999.9') ) AS 'Risk Increase' FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm') =:month_ending AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) WHERE t1.dims IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Preventive') AND ( tx.metric_value-t1.metric_value)>0 ORDER BY (tx.metric_value-t1.metric_value) DESC, t1.dims limit 3",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Risk Change  Preventive Risk",
        "visualization_name": "sc preventive risk chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_preventive_risk_chart",
        "data_query": "SELECT t1.dims AS dims, t1.metric_value AS 'T1 Risk Points', tx.metric_value AS 'Tx Risk Points', CASE WHEN t1.metric_value=0 and tx.metric_value = 0 THEN '0%' WHEN t1.metric_value=0 THEN '' ELSE ROUND(((tx.metric_value-t1.metric_value)/t1.metric_value)*100,1)::VARCHAR || '%' END AS '% change' FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity= :entity AND metric_id=100002075 )t1 LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE  to_char(reporting_end_period,'yyyy-mm') =:month_ending AND entity= :entity AND metric_id=100002076 )tx ON ( t1.month_ending = tx.month_ending AND t1.dims = tx.dims AND t1.entity = tx.entity) WHERE t1.dims IN ( SELECT qbr_risk_name FROM sc_enterprise_daily.risk_lu WHERE risk_category='Preventive') ORDER BY t1.dims",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Results",
        "visualization_name": "sc diabetes module completions",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_module_completions",
        "data_query": "select cast(metric_value as decimal(7, 0)) as metric_value   from sc_kpi.metrics_values  where metric_id=100005023 and entity=:entity  and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Diabetes Education' and split_part(dims,'||',2) = 'Module Completion';",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Results",
        "visualization_name": "sc diabetes program completions",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_program_completions",
        "data_query": "select cast(metric_value as decimal(7, 0)) as metric_value   from sc_kpi.metrics_values  where metric_id=100005023 and entity=:entity  and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and split_part(dims,'||',1) = 'Diabetes Education' and split_part(dims,'||',2) = 'Successful Program Completion';",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Results",
        "visualization_name": "sc diabetes module count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_diabetes_module_count",
        "data_query": "SELECT module_name as activity, metric_value FROM ( SELECT DISTINCT split_part(dims,'||',2) activity,module_name, metric_value FROM ( SELECT DISTINCT dims ,module_name, metric_value, row_number() over(partition BY entity ORDER BY metric_value DESC)row_num FROM sc_kpi.metrics_values a join sc_enterprise_daily.module_lu b on lower(split_part(a.dims,'||',2) ) = lower(b.event_value ) WHERE metric_id=100005071 AND entity= :entity AND split_part(dims,'||',1) = 'Diabetes Education' AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  order by 1 ) x WHERE row_num <= 10)d ORDER BY metric_value DESC;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Results",
        "visualization_name": "sc diabetes engagement chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_diabetes_engagement_chart",
        "data_query": "SELECT DISTINCT elig.month_ending, ModuleCompletion.metric_value ModuleCompletion_metric_value, ProgramCompletion.metric_value ProgramCompletion_metric_value  FROM (SELECT DISTINCT a.month_ending, a.entity         FROM (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity                 FROM sc_kpi.metrics_values                  WHERE to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending                  AND entity= :entity                  AND metric_id = 100003) a          LEFT JOIN (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity                 FROM sc_kpi.metrics_values                  WHERE metric_id in (100005063)                  AND entity= :entity                  AND split_part(dims,'||',1) = 'Diabetes Education') b          ON (a.month_ending = b.month_ending AND a.entity = b.entity) ) elig  LEFT JOIN (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value          FROM sc_kpi.metrics_values          WHERE metric_id=100005063         AND entity= :entity         AND split_part(dims,'||',1) = 'Diabetes Education'         and split_part(dims,'||',3) in ('moduleCompletion','Module Completion')) ModuleCompletion  ON (elig.month_ending = ModuleCompletion.month_ending AND elig.entity = ModuleCompletion.entity          )  LEFT JOIN (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value          FROM sc_kpi.metrics_values          WHERE metric_id=100005063 AND entity= :entity         AND split_part(dims,'||',1) = 'Diabetes Education'         and split_part(dims,'||',3) in ('successfulProgramCompletion','Successful Program Completion')) ProgramCompletion  ON (elig.month_ending = ProgramCompletion.month_ending      AND elig.entity = ProgramCompletion.entity      )  ORDER BY 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes elig members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_elig_members",
        "data_query": "select metric_value::int from sc_kpi.metrics_values  where metric_id=100005001 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Diabetes Education'  order by 1",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes elig reg members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_elig_reg_members",
        "data_query": "select metric_value::int from sc_kpi.metrics_values  where metric_id=100005002 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and split_part(dims,'||',1) = 'Diabetes Education'  order by 1",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes enrolled members",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_enrolled_members",
        "data_query": "select metric_value::int  from sc_kpi.metrics_values  where metric_id=100005003 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Diabetes Education'  order by 1",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes enrollment rate",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_diabetes_enrollment_rate",
        "data_query": "select round((sum(case when metric_id=100005003 then metric_value else null end)/sum(case when metric_id=100005002 then metric_value else null end))*100,1)||'%' enrollment_rate  from sc_kpi.metrics_values  where metric_id in (100005002,100005003) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Diabetes Education'  order by 1",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes enrollment chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_diabetes_enrollment_chart",
        "data_query": "SELECT DISTINCT elig.month_ending, enroll.metric_value enrolled_metric_value, disenroll.metric_value disenrolled_metric_value  FROM (SELECT DISTINCT a.month_ending, a.entity, b.dims, b.metric_value          FROM (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity                  FROM sc_kpi.metrics_values                  WHERE to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending                  AND month_ending >= '2020-01'                  AND entity= :entity                  AND metric_id = 100003) a          LEFT JOIN (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value                  FROM sc_kpi.metrics_values                  WHERE metric_id in (100005006,100005007)                  AND entity= :entity                  AND split_part(dims,'||',1) = 'Diabetes Education') b          ON (a.month_ending = b.month_ending AND a.entity = b.entity) ) elig  LEFT JOIN (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value          FROM sc_kpi.metrics_values          WHERE metric_id=100005006          AND entity= :entity) enroll  ON (elig.month_ending = enroll.month_ending AND elig.entity = enroll.entity AND split_part(elig.dims,'||',1) = split_part(enroll.dims,'||',1))  LEFT JOIN (SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value          FROM sc_kpi.metrics_values          WHERE metric_id=100005007 AND entity= :entity) disenroll  ON (elig.month_ending = disenroll.month_ending      AND elig.entity = disenroll.entity      AND split_part(elig.dims,'||',1) = split_part(disenroll.dims,'||',1))  ORDER BY 1",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc diabetes assessment table",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_diabetes_assessment_table",
        "data_query": "SELECT case when split_part(dims,'||',2) = 'Total Disenrollments' then 'Total Disenrollments' when split_part(dims,'||',2) = 'Enrollments' then '     Net Enrollments' else split_part(dims,'||',2) end assessment, metric_value FROM ( SELECT DISTINCT metric_id, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005008,100005009,100005010,100005011,100005012,100005013,100005015,100005003,100005075,100005076) AND metric_id NOT IN (100005014) AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm')  =:month_ending   and split_part(dims,'||',1) = 'Diabetes Education' )x ORDER BY CASE WHEN split_part(dims,'||',2) = 'Total Assessment Starts' THEN 1 WHEN split_part(dims,'||',2) = 'Total Assessment Completions' THEN 2 WHEN split_part(dims,'||',2) = 'Total Assessment Qualified' THEN 3 WHEN split_part(dims,'||',2) = 'Total Assessment Disqualified' THEN 4 WHEN split_part(dims,'||',2) = 'Total Enrollments' THEN 5 WHEN split_part(dims,'||',2) = 'Total Disenrollments' THEN 6 WHEN split_part(dims,'||',2) = 'Enrollments' THEN 7 END;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc enrolled age chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_enrolled_age_chart",
        "data_query": "select split_part(dims,'||',2)age_group,round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct  from sc_kpi.metrics_values  where metric_id=100005005 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Diabetes Education'  order by 1",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Diabetes Education  Enrollment",
        "visualization_name": "sc enrolled gender chart",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_enrolled_gender_chart",
        "data_query": "select split_part(dims,'||',2)gender, round((metric_value/sum(metric_value)over(partition by :entity))*100,1)||'%'pct  from sc_kpi.metrics_values where metric_id=100005004 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   and split_part(dims,'||',1) = 'Diabetes Education'  order by 1",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "1Challenge Details  Sponsor Initiated",
        "visualization_name": "sc top challenges count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top_challenges_count",
        "data_query": "SELECT CHALLENGE_NAME, CHALLENGE_TYPE, GOAL_UNITS, CHALLENGE_GOAL, CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, CAST(ROUND(Partipant_Rate::FLOAT,1) AS DECIMAL(6,1 ) ) ||'%'Partipant_Rate FROM ( SELECT DISTINCT CHALLENGE_NAME, CHALLENGE_TYPE, CHALLENGE_GOAL, GOAL_UNITS, TO_CHAR(CHALLENGE_START_DATE,'YYYY-MM-DD') AS CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, (CHALLENGE_COMPLETERS/CHALLENGE_MEMBERS)*100 Partipant_Rate, row_number() OVER( PARTITION BY MONTH_ENDING, ENTITY ORDER BY CHALLENGE_COMPLETERS DESC )rank FROM sc_kpi.kpi_metrics_challenge_participant_detail A WHERE metric_id=100002108 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ) dd ORDER BY 6 DESC, 5 DESC, 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "1Challenge Details  Sponsor Initiated",
        "visualization_name": "sc challenges in progress",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_challenges_in_progress",
        "data_query": "SELECT CHALLENGE_NAME, CHALLENGE_TYPE, GOAL_UNITS, CHALLENGE_GOAL, CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, CAST(ROUND(Partipant_Rate::FLOAT,1) AS DECIMAL(6,1 ) ) ||'%'Partipant_Rate FROM ( SELECT DISTINCT CHALLENGE_NAME, CHALLENGE_TYPE, CHALLENGE_GOAL, GOAL_UNITS, TO_CHAR(CHALLENGE_START_DATE,'YYYY-MM-DD') AS CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, (CHALLENGE_COMPLETERS/CHALLENGE_MEMBERS)*100 Partipant_Rate, row_number() OVER( PARTITION BY MONTH_ENDING, ENTITY ORDER BY CHALLENGE_COMPLETERS DESC )rank FROM sc_kpi.kpi_metrics_challenge_participant_detail A WHERE metric_id=100002109 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending ) dd ORDER BY 6 DESC, 5 DESC, 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "2Challenge Details  Sponsor Initiated",
        "visualization_name": "sc top challenges count",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top_challenges_count",
        "data_query": "SELECT CHALLENGE_NAME, CHALLENGE_TYPE, GOAL_UNITS, CHALLENGE_GOAL, CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, CAST(ROUND(Partipant_Rate::FLOAT,1) AS DECIMAL(6,1 ) ) ||'%'Partipant_Rate FROM ( SELECT DISTINCT CHALLENGE_NAME, CHALLENGE_TYPE, CHALLENGE_GOAL, GOAL_UNITS, TO_CHAR(CHALLENGE_START_DATE,'YYYY-MM-DD') AS CHALLENGE_START_DATE, CHALLENGE_MEMBERS, CHALLENGE_COMPLETERS, (CHALLENGE_COMPLETERS/CHALLENGE_MEMBERS)*100 Partipant_Rate, row_number() OVER( PARTITION BY MONTH_ENDING, ENTITY ORDER BY CHALLENGE_COMPLETERS DESC )rank FROM sc_kpi.kpi_metrics_challenge_participant_detail A WHERE metric_id=100002108 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending ) dd ORDER BY 6 DESC, 5 DESC, 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge completes",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_challenge_completes",
        "data_query": "select cast(metric_value as integer) from sc_kpi.metrics_values where metric_id=1000051 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge participations",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_challenge_participations",
        "data_query": "select cast(metric_value as integer) from sc_kpi.metrics_values where metric_id=100002101 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge completion rate",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_challenge_completion_rate",
        "data_query": "select cast(round(((select metric_value from sc_kpi.metrics_values where metric_id=1000051 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') ) / (select metric_value from sc_kpi.metrics_values where metric_id=100002101 and entity=:entity and to_char(reporting_end_period,'yyyy-mm') =:month_ending))*100,1) as decimal(6,1) ) || '%';",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge participant rate",
        "section_name": "",
        "visulization_type": "TEXT",
        "placeholder_name": "sc_challenge_participant_rate",
        "data_query": "select cast(round(((select metric_value from sc_kpi.metrics_values where metric_id=100002105 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')) / (select metric_value from sc_kpi.metrics_values where metric_id=100007 and entity=:entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending))*100,1) as decimal(6,1) ) || '%';",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge ptpn by month",
        "section_name": "",
        "visulization_type": "CHART",
        "placeholder_name": "sc_challenge_ptpn_by_month",
        "data_query": "select x.month_ending,cast(b.metric_value as integer) as participations,c.metric_value as completions from (select DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending,entity from sc_kpi.metrics_values where metric_id=100003 and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending ) x         left join sc_kpi.metrics_values b on (x.to_char(reporting_end_period,'yyyy-mm')=b.month_ending and b.metric_id=100002100 and x.entity=b.entity)         left join sc_kpi.metrics_values c on (x.to_char(reporting_end_period,'yyyy-mm')=c.month_ending and c.metric_id=1000049 and x.entity=c.entity) where b.entity=:entity order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge ptpn by goal",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_challenge_ptpn_by_goal",
        "data_query": "SELECT xx2.dims, cast(ptpns as integer) as ptpns, cast(completes as integer) as completes, cast( ROUND((completes/ptpns)*100,1) as decimal(6,1) )||'%' AS 'Participation Rate'  FROM ( SELECT xx1.*, row_number() over(partition BY month_ending,entity ORDER BY ptpns DESC)row_number FROM ( SELECT DISTINCT ptpns.month_ending, ptpns.dims, ptpns.entity, ptpns.ptpns, comp.completes  FROM ( SELECT  to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value ptpns FROM sc_kpi.metrics_values  WHERE metric_id=100002104 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending ) ptpns LEFT JOIN ( SELECT  to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value completes   FROM sc_kpi.metrics_values  WHERE metric_id=100002011 AND entity=:entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending) comp  ON ( ptpns.month_ending = comp.month_ending AND ptpns.entity = comp.entity AND ptpns.dims = comp.dims) ) xx1  where   not (ptpns is null and completes is null) ) xx2 WHERE row_number <= 7 ORDER BY 2 DESC;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Sponsor Initiated",
        "visualization_name": "sc challenge ptpn by type",
        "section_name": "",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_challenge_ptpn_by_type",
        "data_query": "select part.dims as challenge_type,cast(part.metric_value as integer) as participations,cast(comp.metric_value as integer) as completions,cast(round((comp.metric_value/part.metric_value)*100,1) as decimal(6,1))||'%' as comp_rate from sc_kpi.metrics_values part  left join sc_kpi.metrics_values comp  on (part.dims=comp.dims and comp.metric_id=100002103 and part.entity=comp.entity and part.to_char(reporting_end_period,'yyyy-mm')=comp.to_char(reporting_end_period,'yyyy-mm')) where part.metric_id=100002102 and part.entity=:entity and part.to_char(reporting_end_period,'yyyy-mm') =:month_ending  AND not (part.metric_value is null and comp.metric_value is null) order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Benefits Hub",
        "visualization_name": "sc members engaging with benifit hub",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "KPI",
        "placeholder_name": "sc_members_engaging_with_benifit_hub",
        "data_query": "select cast( round(metric_value, 1) as decimal(8,0) )  from sc_kpi.metrics_values where metric_id=100001800 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')= :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Benefits Hub",
        "visualization_name": "sc clicks to external program per registered member",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "KPI",
        "placeholder_name": "sc_clicks_to_external_program_per_registered_member",
        "data_query": "select cast( round(metric_value, 1) as decimal(8,0) )  from sc_kpi.metrics_values where metric_id=100001801 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')= :month_ending;",
        "category": "text",
        "style": "blue,Calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Benefits Hub",
        "visualization_name": "sc benefits hub activity by month chart",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_benefits_hub_activity_by_month_chart",
        "data_query": "SELECT substring(month_id::char(7),1,4)||'-'||substring(month_id::char(7),5,2) as month_ending ,cast ( round( (case when a.metric_value is null then 0.0 else a.metric_value end ) , 1) as int ) as unique_visitors ,cast (round ( (case when b.metric_value is null then 0.0 else b.metric_value end ) , 1) as int ) as external_clicks FROM (select distinct month_id from dwimp.dwimp_date) z left join sc_kpi.metrics_values a on (substring(month_id::char(7),1,4)||'-'||substring(month_id::char(7),5,2)=to_char(a.reporting_end_period,'yyyy-mm') and a.metric_id=100001803 and a.entity= :entity) left join sc_kpi.metrics_values b on (substring(month_id::char(7),1,4)||'-'||substring(month_id::char(7),5,2)=b.to_char(b.reporting_end_period,'yyyy-mm') and b.metric_id=100001804 and b.entity=:entity) WHERE substring(month_id::char(7),1,4)||'-'||substring(month_id::char(7),5,2) BETWEEN TO_CHAR(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending ORDER BY 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Benefits Hub",
        "visualization_name": "sc top external programs top 5",
        "section_name": "DIGITAL ENGAGEMENT",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_external_programs_top_5",
        "data_query": "select dims as programs,metric_value as clicks from sc_kpi.metrics_values where metric_id=100001802 and entity = :entity and to_char(reporting_end_period,'yyyy-mm')=:month_ending Order by metric_value desc;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "LEARNING TRACKS ASSIGNED",
        "visulization_type": "KPI",
        "placeholder_name": "sc_learning_tracks_assigned",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(metric_value)::INT as lt_assigned from sc_kpi.metrics_values where metric_id=100003060 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "LEARNING TRACKS COMPLETED",
        "visulization_type": "KPI",
        "placeholder_name": "sc_learning_tracks_completed",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select sum(metric_value)::INT as lt_completed from sc_kpi.metrics_values where metric_id=100003061 and entity= :entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "LEARNING TRACKS COMPLETION RATE",
        "visulization_type": "KPI",
        "placeholder_name": "sc_learning_tracks_completion_rate",
        "style": "blue,Calibri,28",
        "category": "text",
        "data_query": "select round (((( select sum(metric_value) from sc_kpi.metrics_values where metric_id=100003061 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  )/(select sum(metric_value) from sc_kpi.metrics_values where metric_id=100003060 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ))*100), 1) || '%';",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "LEARINING TRACKS COMPLETION CHART",
        "visulization_type": "Stacked Bar Chart",
        "placeholder_name": "sc_learning_tracks_completions_per_month",
        "style": "",
        "category": "chart",
        "data_query": "select id_1.month_ending,id_1.metric_value as metric_value_1,(id_2.metric_value) as metric_value_2 from (select to_char(reporting_end_period,'yyyy-mm') month_ending,sum(metric_value) as metric_value from sc_kpi.metrics_values where metric_id=100003062 and entity= :entity and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending group by 1)id_1 inner join (select to_char(reporting_end_period,'yyyy-mm') month_ending,sum(metric_value) as metric_value from sc_kpi.metrics_values where metric_id=100003063 and entity= :entity and to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending group by 1)id_2 on id_1.month_ending=id_2.month_ending order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Learning Tracks",
        "visualization_name": "TOP 5 LEARNING TRACK COMPLETIONS",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_5_learning_tracks_completed_table",
        "style": "",
        "category": "table",
        "data_query": "select a.dims, sum(a.metric_value) as lt_assigned, sum(b.metric_value) as lt_completed from sc_kpi.metrics_values a join sc_kpi.metrics_values b on a.entity=b.entity and  to_char(a.reporting_end_period,'yyyy-mm')=to_char(b.reporting_end_period,'yyyy-mm') and b.metric_id=100003061  and a.dims=b.dims where a.metric_id=100003060 and a.entity= :entity and to_char(a.reporting_end_period,'yyyy-mm') =:month_ending  and b.metric_value is not null group by 1 order by 3 desc, 1 limit 5        ",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc timeline cards impressions",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_timeline_cards_impressions",
        "data_query": "select cast(metric_value as integer) as impressions from sc_kpi.metrics_values where entity=:entity and metric_id=100006002 and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc timeline cards distinct members",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_timeline_cards_distinct_members",
        "data_query": "select cast(metric_value as integer) as members from sc_kpi.metrics_values where entity=:entity and metric_id=100006003 and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc timeline cards clicks",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_timeline_cards_clicks",
        "data_query": "select cast(metric_value as integer) as clicks from sc_kpi.metrics_values where entity=:entity and metric_id=100006004  and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc timeline cards clicks per user",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_timeline_cards_clicks_per_user",
        "data_query": "select cast( round(metric_value, 1) as float) as average_clicks from sc_kpi.metrics_values where entity=:entity and metric_id=100006005 and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Client-Sponsored Timeline Card Campaigns (Current Quarter)",
        "visualization_name": "sc top campaigns by impressions table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top_campaigns_by_impressions_table",
        "data_query": "SELECT DISTINCT campaignName, to_char(campaignStartDate, 'yyyy-mm-dd') as startDate, cast(round(impressions) as integer) as impressions, members, clicks,  cast((clicks/impressions*100) as decimal(6,1))||'%' as click_rate FROM sc_kpi.kpi_metrics_timeline_campaign_detail_staging A WHERE metric_id=100006000 AND entity=:entity  and  to_char(reporting_end_period,'yyyy-mm')=:month_ending  ORDER BY 3 desc, 5 desc limit 10;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Client-Sponsored Timeline Cards (Current Quarter)",
        "visualization_name": "sc top timeline cards by impressions table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_top_timeline_cards_by_impressions_table",
        "data_query": "SELECT DISTINCT cardTitle, to_char(cardStartDate, 'yyyy-mm-dd') as startDate, ctaLabel,  cast(round(impressions) as integer) as impressions, members, clicks, cast((clicks/impressions*100) as decimal(6,1))||'%' as click_rate  FROM sc_kpi.kpi_metrics_timeline_card_detail_staging A WHERE metric_id=100006001 AND entity=:entity  and  to_char(reporting_end_period,'yyyy-mm')=:month_ending   ORDER BY 4 desc, 6 desc limit 10;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk elig enrolled members",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_msk_elig_enrolled_members",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005003 and entity=:entity and  split_part(dims,'||',1) = 'Muscle and Joint Health'and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk coach session completions",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_msk_coach_session_completions",
        "data_query": "select metric_value from sc_kpi.metrics_values where metric_id=100005150 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')=:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk coach sessions per members",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_msk_coach_sessions_per_members",
        "data_query": "SELECT cast( round(sessions/members, 1) as float) FROM ( SELECT entity, metric_value sessions FROM sc_kpi.metrics_values WHERE metric_id=100005150 AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity = :entity ) A JOIN ( SELECT entity, metric_value members FROM sc_kpi.metrics_values WHERE metric_id=100005003 AND  to_char(reporting_end_period,'yyyy-mm')=:month_ending  AND entity = :entity AND split_part(dims, '||',1 ) = 'Muscle and Joint Health' ) B ON A.entity = B.entity;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_float"
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk coach engagement chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "CHART",
        "placeholder_name": "sc_msk_coach_engagement_chart",
        "data_query": "SELECT DISTINCT a.month_ending, b.metric_value as coaching_session_completion , c.metric_value as coaching_messages FROM ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity FROM sc_kpi.metrics_values WHERE to_char(reporting_end_period,'yyyy-mm') between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') AND :month_ending AND entity= :entity AND metric_id = 1000013 ) a LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, dims, entity, metric_value FROM sc_kpi.metrics_values WHERE metric_id in (100005151) AND entity= :entity AND split_part(dims,'||',1) = 'Muscle and Joint Health' ) b ON ( a.month_ending = b.month_ending AND a.entity = b.entity) LEFT JOIN ( SELECT DISTINCT to_char(reporting_end_period,'yyyy-mm')  month_ending, entity, dims, metric_value FROM sc_kpi.metrics_values WHERE metric_id=100005153 AND split_part(dims,'||',1) = 'Muscle and Joint Health' AND entity= :entity ) c ON ( C.month_ending = A.month_ending AND C.entity = A.entity ) ORDER BY 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk activity count table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_msk_activity_count_table",
        "data_query": "select case when Activity = 'CoachMessage' then ' Coaching Messaging' when Activity = 'ClassCompletion' then 'Coching Sessions Completions' else Activity end Activity, Lifetime_Count from ( select split_part(dims,'||',2) Activity ,metric_value Lifetime_Count from sc_kpi.metrics_values where metric_id=100005150 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and split_part(dims,'||',1) = 'Muscle and Joint Health' union select split_part(dims,'||',2) Activity,metric_value Lifetime_Count from sc_kpi.metrics_values where metric_id=100005152 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')  =:month_ending and split_part(dims,'||',1) = 'Muscle and Joint Health' )X order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Muscle/Joint Health  Engagement 2",
        "visualization_name": "sc msk milestone count table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_msk_milestone_count_table",
        "data_query": "select CASE WHEN split_part(dims,'||',3) = 'Progress Goal 1' THEN 'Member + Coach complete 1-4/12' WHEN split_part(dims,'||',3) = 'Progress Goal 2' THEN 'Member + Coach complete 5-8/12' WHEN split_part(dims,'||',3) = 'Progress Goal 3' THEN 'Member + Coach complete 9-12/12' end milestone,metric_value from sc_kpi.metrics_values where metric_id in (100005081) and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and entity = :entity and split_part(dims,'||',1) = 'Muscle and Joint Health' and split_part(dims,'||',2) = 'Milestone' order by 1;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Results",
        "visualization_name": "sc average a1c change",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_average_a1c_change",
        "data_query": "select cast(metric_value as decimal(2,2) ) metric_value from sc_kpi.metrics_values where metric_id=100005107 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Results",
        "visualization_name": "sc diabetes avg reduction over9",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_diabetes_avg_reduction_over9",
        "data_query": "select cast(metric_value as decimal(2,2) ) from sc_kpi.metrics_values where metric_id=100005108 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Results",
        "visualization_name": "sc diabetes a1c change chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "CHART",
        "placeholder_name": "sc_diabetes_a1c_change_chart",
        "data_query": "select split_part(dims,'||',2) A1C_Change, cast( metric_value as decimal( 6,2) ) from sc_kpi.metrics_values where metric_id=100005109 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Manage Diabetes  Results",
        "visualization_name": "sc diabetes a1c change table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_diabetes_a1c_change_table",
        "data_query": "select A.A1C_Change,  cast( A.metric_value as decimal( 6,2) ) as change , ( case when A.metric_value is not null then B.metric_value else null end ) ::INT as Unique_Members from ( select entity, split_part(dims,'||',2) A1C_Change, metric_value from sc_kpi.metrics_values where metric_id=100005109 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  order by 1 ) A left join ( select entity , split_part(dims,'||',2) A1C_Change, metric_value from sc_kpi.metrics_values where metric_id=100005110 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')  =:month_ending order by 1 ) B on A.entity = B.entity and A.A1C_Change = B.A1C_Change order by 1; ",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge initiated",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_challenge_initiated",
        "data_query": "select metric_value::INT as metric_value from sc_kpi.metrics_values where metric_id=100002110 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge invitations",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_challenge_invitations",
        "data_query": "select metric_value::INT as metric_value from sc_kpi.metrics_values where metric_id=100002111 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge participations",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_challenge_participations",
        "data_query": "select nvl(metric_value,0)::INT as metric_value from sc_kpi.metrics_values where metric_id=100002112 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending ;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": "get_integer"
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge completions rate",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "KPI",
        "placeholder_name": "sc_challenge_completions_rate",
        "data_query": "select case when cyo_challenge_participations = 0 then '-' else cast ( ( ( cyo_challenge_completions / cyo_challenge_participations) * 100 )::CHAR(5) as decimal(6,1) ) || '%' end cyo_challenge_completion_rate from ( ( select entity, nvl(metric_value, 0) cyo_challenge_completions from sc_kpi.metrics_values where metric_id=100002113 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')  =:month_ending ) A join ( select entity, nvl(metric_value, 0) cyo_challenge_participations from sc_kpi.metrics_values where metric_id=100002112 and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) B on a.entity = b.entity ) x;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge participations by month chart",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "CHART",
        "placeholder_name": "sc_challenge_participations_by_month_chart",
        "data_query": "select A.month_ending , A.metric_value, B.metric_value from ( select to_char(reporting_end_period,'yyyy-mm') month_ending,entity, nvl(metric_value, 0) metric_value from sc_kpi.metrics_values where metric_id in (100002115) and entity=:entity ) A left join (select to_char(reporting_end_period,'yyyy-mm') month_ending,entity, nvl(metric_value, 0) metric_value from sc_kpi.metrics_values where metric_id in (100002114) and entity=:entity ) B on A.month_ending = B.month_ending and A.entity = B.entity where A.month_ending between to_char(add_months(to_date(:month_ending,'yyyy-mm-dd'),-14),'yyyy-mm') and :month_ending order by 1;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Challenge Participation  Create Your Own (Peer to Peer)",
        "visualization_name": "sc challenge participation by goal type table",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "visulization_type": "TABLE",
        "placeholder_name": "sc_challenge_participation_by_goal_type_table",
        "data_query": "select A.challenge_type, A.metric_value::INT as metric_value_1, B.metric_value::INT as metric_value_2, C.metric_value::INT as metric_value_3, case when c.metric_value = 0 or c.metric_value is null then '-' else cast (( nvl(D.metric_value, 0 ) / C.metric_value )*100 as decimal (6,1) ) ||'%' end as metric_value_4 from ( select to_char(reporting_end_period,'yyyy-mm') month_ending ,entity, metric_value , dims challenge_type from sc_kpi.metrics_values where metric_id in (100002116) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')  =:month_ending ) A left join ( select to_char(reporting_end_period,'yyyy-mm') month_ending ,entity, metric_value , dims challenge_type from sc_kpi.metrics_values where metric_id in (100002117) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) B on A.entity = B.entity and A.challenge_type = B.challenge_type left join ( select to_char(reporting_end_period,'yyyy-mm') month_ending ,entity, metric_value , dims challenge_type from sc_kpi.metrics_values where metric_id in (100002118) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm')  =:month_ending ) C on A.entity = C.entity and A.challenge_type = C.challenge_type left join ( select to_char(reporting_end_period,'yyyy-mm') month_ending ,entity, metric_value , dims challenge_type from sc_kpi.metrics_values where metric_id in (100002119) and entity=:entity and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) D on A.entity = D.entity and A.challenge_type = D.challenge_type WHERE   not (A.metric_value is null and B.metric_value is null and C.metric_value is null and D.metric_value is null) order by 2 desc limit 7 ;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Fertility  Engagement",
        "visualization_name": "CLINICAL PROGRAM (TOP 5)",
        "visulization_type": "Table",
        "placeholder_name": "clinical_program",
        "style": "",
        "category": "table",
        "data_query": "select distinct split_part(dims,'||',2) activity,metric_value from (select distinct dims,metric_value,row_number() over(partition by entity order by metric_value desc)row_num from sc_kpi.metrics_values where metric_id=100005026 and entity= :entity and split_part(dims,'||',1) = 'Fertility Program' and  to_char(reporting_end_period,'yyyy-mm') =:month_ending order by 1) x where row_num <= 5 order by 2 desc",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": " "
    },
    {
        "slide_title": "Programs (Current Quarter)",
        "visualization_name": "CATEGORY FEATURE UTILIZATION",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_category_feature_utilization_chart",
        "style": "",
        "category": "chart",
        "data_query": "SELECT uv.dims, uv.'Unique Visitors', pv.'Page Views', round(pv.'Page Views'/apv.visits,1) as 'Average page view per visit' FROM ( SELECT dims, metric_value AS 'Unique Visitors' FROM sc_kpi.metrics_values WHERE metric_id=100006014 AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) uv JOIN ( SELECT dims, metric_value as 'Page Views' FROM sc_kpi.metrics_values WHERE metric_id=100006012 AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) pv ON uv.dims = pv.dims JOIN ( SELECT dims, metric_value as 'Visits' FROM sc_kpi.metrics_values WHERE metric_id=100006013 AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) apv ON uv.dims = apv.dims order by 1;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Programs (Current Quarter)",
        "visualization_name": "TOP 10 PROGRAMS",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_10_programs",
        "style": "",
        "category": "table",
        "data_query": "SELECT uv.dims, pv.'Page Views', uv.'Unique Visitors', cast((pv.'Page Views'/apv.visits) as decimal(6,1)) as 'Average page view per visit' FROM ( SELECT dims, metric_value AS 'Unique Visitors' FROM sc_kpi.metrics_values WHERE metric_id=100006008 AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) uv JOIN ( SELECT dims, metric_value as 'Page Views' FROM sc_kpi.metrics_values WHERE metric_id=100006006 AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) pv ON uv.dims = pv.dims JOIN ( SELECT dims, metric_value as 'Visits' FROM sc_kpi.metrics_values WHERE metric_id=100006007 AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) apv ON uv.dims = apv.dims order by 3 desc limit 10;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Programs (Current Quarter)",
        "visualization_name": "TOP 10 PROGRAM CONTENT",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_10_program_content",
        "style": "",
        "category": "table",
        "data_query": "SELECT split_part(uv.dims,'(',1) as 'Top 10 Program Content', pv.'Content Type', uv.'Content Length', pv.'Content Start', apv.'Content Complete', uv.'Unique Visitors' FROM ( SELECT dims, split_part(split_part(dims,'(',2),')',1) as 'Content Length', metric_value AS 'Unique Visitors' FROM sc_kpi.metrics_values WHERE metric_id=100006011 AND entity= :entity AND to_char(reporting_end_period,'yyyy-mm') =:month_ending   ) uv JOIN ( SELECT split_part(dims,'||',3) as dims, split_part(dims,'||',2) as 'Content Type', metric_value AS 'Content Start' FROM sc_kpi.metrics_values WHERE metric_id=100006009 AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm') =:month_ending  ) pv ON uv.dims = pv.dims JOIN ( SELECT split_part(dims,'||',3) as dims, metric_value AS 'Content Complete' FROM sc_kpi.metrics_values WHERE metric_id=100006010 AND entity= :entity AND  to_char(reporting_end_period,'yyyy-mm')  =:month_ending ) apv ON uv.dims = apv.dims ORDER BY 6 DESC LIMIT 10;",
        "section_name": "COACHING and DIGITAL THERAPEUTICS",
        "transformation_rule": ""
    },
    {
        "slide_title": "Content Consumption by Subject (Last 12 Months)",
        "visualization_name": "sc unique content visitors",
        "section_name": "",
        "visulization_type": "KPI",
        "placeholder_name": "sc_unique_content_visitors",
        "data_query": "SELECT isnull(metric_value,0)::int from sc_kpi.metrics_values where metric_id=100002211 and to_char(reporting_end_period,'yyyy-mm') =:month_ending  and entity = :entity;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Content Consumption by Subject (Last 12 Months)",
        "visualization_name": "sc total content visits",
        "section_name": "",
        "visulization_type": "KPI",
        "placeholder_name": "sc_total_content_visits",
        "data_query": "SELECT isnull(metric_value,0)::int from sc_kpi.metrics_values where metric_id=100002212 and to_char(reporting_end_period,'yyyy-mm') =:month_ending  and entity = :entity;",
        "category": "text",
        "style": "blue,calibri,28",
        "transformation_rule": ""
    },
    {
        "slide_title": "Content Consumption by Subject (Last 12 Months)",
        "visualization_name": "sc top 3 engaged subjects",
        "section_name": "",
        "visulization_type": "Table",
        "placeholder_name": "sc_top_3_engaged_subjects",
        "data_query": "SELECT CASE WHEN med.dims = 'Dental Appointment' then 'Dental Appt.' when med.dims = 'Medical Appointment Adherence' then 'Medical Appt. Adherence' else med.dims end as theme_name,cast(isnull(med.metric_value,0) as DECIMAL(5,1)) as median_visits,isnull(v.metric_value,0) as unique_visitors FROM ( SELECT dims,metric_value FROM sc_kpi.metrics_values where metric_id=100002217 and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and entity = :entity  ) med JOIN  (SELECT dims, metric_value from sc_kpi.metrics_values where metric_id=100002216  and   to_char(reporting_end_period,'yyyy-mm') =:month_ending  and entity =:entity) v on v.dims = med.dims order by round(isnull(med.metric_value,0)) desc,isnull(v.metric_value,0) desc limit 3;",
        "category": "table",
        "style": "",
        "transformation_rule": ""
    },
    {
        "slide_title": "Content Consumption by Subject (Last 12 Months)",
        "visualization_name": "sc member visits by subject and content type",
        "section_name": "",
        "visulization_type": "Bar Chart",
        "placeholder_name": "sc_member_visits_by_subject_and_content_type",
        "data_query": " SELECT CASE WHEN a.dims = 'Dental Appointment' then 'Dental Appt.' when a.dims = 'Medical Appointment Adherence' then 'Medical Appt. Adherence' else a.dims end as theme_name,isnull(b.metric_value,0)::int as article_visits,isnull(c.metric_value,0)::int as slideshow_visits,isnull(d.metric_value,0)::int as video_visits, isnull(a.metric_value,0)::int as unique_visitors,round(isnull(e.metric_value,0),1) as median_visits FROM (SELECT dims,metric_value from sc_kpi.metrics_values where metric_id=100002216 and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and entity =:entity)  a LEFT JOIN (SELECT dims, metric_value from sc_kpi.metrics_values where metric_id=100002213 and  to_char(reporting_end_period,'yyyy-mm') =:month_ending and entity =:entity) b  on a.dims = b.dims  LEFT JOIN (SELECT dims, metric_value from sc_kpi.metrics_values where metric_id=100002214 and  to_char(reporting_end_period,'yyyy-mm') =:month_ending and entity =:entity) c on a.dims = c.dims  LEFT JOIN(SELECT dims, metric_value from sc_kpi.metrics_values where metric_id=100002215 and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and entity =:entity) d on a.dims = d.dims  LEFT JOIN (SELECT dims, metric_value from sc_kpi.metrics_values where metric_id=100002217 and  to_char(reporting_end_period,'yyyy-mm') =:month_ending  and entity =:entity) e on a.dims = e.dims order by a.dims asc;",
        "category": "chart",
        "style": "",
        "transformation_rule": ""
    }
]